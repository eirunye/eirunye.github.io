<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Eirunye Activity</title>
  
  <subtitle>NOTE</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://eirunye.github.io/"/>
  <updated>2018-12-09T14:48:20.220Z</updated>
  <id>http://eirunye.github.io/</id>
  
  <author>
    <name>Eirunye</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Java8 Stream</title>
    <link href="http://eirunye.github.io/2018/12/09/Java8-Stream/"/>
    <id>http://eirunye.github.io/2018/12/09/Java8-Stream/</id>
    <published>2018-12-09T14:37:02.000Z</published>
    <updated>2018-12-09T14:48:20.220Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>在Java 8中API添加了一个新的抽象称为流Stream，可以让你以一种声明的方式处理数据。在Java中只要你应用的版本是java 8以上的话都能使用该API，但是在Android中如果API低于24时，是无法使用该java API，今天我们来介绍在Android中如何使用<a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" target="_blank" rel="noopener"><strong>Stream</strong></a>，还有常用的操作符。<br><img src="http://upload-images.jianshu.io/upload_images/3012005-4a75794c3fa4871e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Stream"></p><h1 id="什么是Stream"><a href="#什么是Stream" class="headerlink" title="什么是Stream"></a>什么是Stream</h1><p>在操作之前我们来认识一下什么是Stream? 有什么特性呢？ 进入<a href="https://docs.oracle.com/javase/8/docs/api/" target="_blank" rel="noopener"><strong>Sream API</strong></a></p><ul><li>支持顺序和并行聚合操作的一系列元素，有丰富的操作符。</li><li>除了Stream（对象引用流）之外，还有IntStream，LongStream和DoubleStream的原始特化，所有这些特性都被称为“流”，并且符合此处描述的特征和限制</li><li><strong>Stream Pipeline</strong> 可以<strong>顺序执行</strong>或<strong>并行执行</strong>。此执行模式是流的属性。通过初始选择的顺序或并行执行来创建流。(例如Collection.stream()创建一个顺序流Collection.parallelStream() 创建一个并行流。)这种执行模式的选择可以通过BaseStream.sequential()或BaseStream.parallel()方法修改，并且可以使用BaseStream.isParallel()方法查询。</li><li>和Collections有相似之处，但是Stream不提供直接访问或操纵其元素的手段，而是涉及声明性地描述它们的源以及将在该源上聚合执行的计算操作。</li><li>支持lambda，更加方便简洁。<h1 id="Android-使用Stream"><a href="#Android-使用Stream" class="headerlink" title="Android 使用Stream"></a>Android 使用Stream</h1>上文已经提及了在默认的Android API中只要在API 24以上才能使用如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiresApi</span>(api = Build.VERSION_CODES.N) <span class="comment">//必须标志在Android N才能使用，也就是API&gt;=24才能使用</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testStream</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">  Stream.of(strings).filter(s -&gt; !strings.isEmpty()).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>但是为了使用Stream的话，我们可以引用Stream依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//在Project build.gradle中添加</span><br><span class="line">allprojects &#123;</span><br><span class="line">repositories &#123;</span><br><span class="line">//...</span><br><span class="line">maven &#123; url &apos;https://jitpack.io&apos; &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">//在Module app build.gradle 中添加</span><br><span class="line">implementation &apos;com.annimon:stream:1.2.1&apos;</span><br></pre></td></tr></table></figure></p><ul><li>注：这里的Stream和java 8的Stream 包名是不一样的，这是一个非官方兼容方案为一个依赖库 ，不过语法是一样的，java 8的包名是<code>java.util.stream.Stream</code>，而依赖库的包是<code>com.annimon.stream.Stream</code>，这里需要大家在使用的时候注意。</li><li>我们不能将我们Android API设置为24，那么这样是不可取的，使用选择一个依赖库也是完全可以解决需求的。<h1 id="操作符使用"><a href="#操作符使用" class="headerlink" title="操作符使用"></a>操作符使用</h1>我们先来一个简单的例子<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line"><span class="comment">//输出list的元素</span></span><br><span class="line">Stream.of(strings).forEach(System.out::println);</span><br></pre></td></tr></table></figure></li></ul><p>当然了，熟悉lambda表达式的同学肯定觉得这有什么好的呢？List也直接可以输出而且很方便呢？如下:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">strings.forEach(System.out::println);</span><br></pre></td></tr></table></figure></p><p>上面两个例子并没有让我们觉得Stream很牛逼是吧，不急，我们继续进行看看，Stream是不是很强大。</p><h3 id="of"><a href="#of" class="headerlink" title="of"></a>of</h3><p>返回其元素为指定值的顺序有序流。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; stream = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">System.out.println(stream.count()); <span class="comment">//stream.count()：返回此流中元素的数量。</span></span><br><span class="line">输出：</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><!-- ## 转换操作符--><h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p>返回一个流，该流包含将给定函数应用于此流的元素的结果<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line"><span class="comment">//将字符串转换为int输出</span></span><br><span class="line">Stream.of(strings).map(Integer::parseInt).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><h3 id="mapToInt"><a href="#mapToInt" class="headerlink" title="mapToInt"></a>mapToInt</h3><p>返回一个IntStream，它包含将给定函数应用于此流的元素的结果。<br>相同的还有mapToLong、mapToDouble<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(strings).mapToInt(Integer::parseInt).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h3><p>返回一个流，该流包含将此流的每个元素替换为通过将提供的映射函数应用于每个元素而生成的映射流的内容的结果。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">List&lt;String&gt; strings1 = Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>);</span><br><span class="line">Stream.of(strings,strings1).flatMap(Stream::of).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br></pre></td></tr></table></figure></p><h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>返回由与此给定谓词匹配的此流的元素组成的流。过滤器，如下下面例子过滤空字符串<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">""</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(strings).filter(s -&gt; !s.isEmpty()).map(Integer::parseInt).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><h3 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h3><p>去除List重复的元素，返回由此流的不同元素（根据Object.equals（Object））组成的流。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">""</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(strings).filter(s -&gt; !s.isEmpty()).distinct().map(Integer::parseInt).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><h3 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h3><p>返回由此流的元素组成的流，截断为长度不超过maxSize。如下maxSize=3时。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(strings).limit(<span class="number">3</span>).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure></p><h3 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h3><p>在丢弃流的前n个元素后，返回由此流的其余元素组成的流。如下n=3，则丢弃前面3个元素。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(strings).skip(<span class="number">3</span>).limit(<span class="number">3</span>).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><h3 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h3><p>返回由此流的元素组成的流，按照自然顺序排序。默认为升序<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">"2"</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(strings).sorted().forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure></p><!-- ## 匹配操作符--><h3 id="allMatch"><a href="#allMatch" class="headerlink" title="allMatch"></a>allMatch</h3><p>返回此流的所有元素是否与提供的断言匹配。boolean值<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">"2"</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">System.out.println(Stream.of(strings).allMatch(s -&gt; strings.contains(<span class="string">"a"</span>)));</span><br><span class="line">输出：</span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"></span><br><span class="line">System.out.println(Stream.of(strings).allMatch(s-&gt;strings.contains(<span class="string">"1"</span>)));</span><br><span class="line">输出：</span><br><span class="line"><span class="keyword">true</span></span><br></pre></td></tr></table></figure></p><h3 id="anyMatch"><a href="#anyMatch" class="headerlink" title="anyMatch"></a>anyMatch</h3><p>返回此流的任何元素是否与提供的断言匹配。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">"2"</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">System.out.println(Stream.of(strings).anyMatch(s -&gt; s.contains(<span class="string">"1"</span>)));</span><br><span class="line">输出：</span><br><span class="line"><span class="keyword">true</span></span><br></pre></td></tr></table></figure></p><h3 id="noneMatch"><a href="#noneMatch" class="headerlink" title="noneMatch"></a>noneMatch</h3><p>Stream 中没有一个元素符合传入的 断言<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">""</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">System.out.println(Stream.of(strings).noneMatch(s -&gt; s.contains(<span class="string">"8"</span>)));</span><br><span class="line">输出：</span><br><span class="line"><span class="keyword">true</span></span><br></pre></td></tr></table></figure></p><h3 id="collect"><a href="#collect" class="headerlink" title="collect"></a>collect</h3><p>输出为一个新的集合数据。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">""</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">List&lt;String&gt; strings1 = Stream.of(strings).filter(s -&gt; !s.isEmpty()).collect(Collectors.toList());</span><br><span class="line">strings1.forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"></span><br><span class="line">List&lt;String&gt; string = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">"6"</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream.of(string).filter(s -&gt; !s.isEmpty()).collect(Collectors.toSet()).forEach(System.out::println);<span class="comment">//Collectors.toSet() 不能出现重复元素，并进行排序输出。hashSet类似，但是Collectors.toSet()会进行排序</span></span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure></p><h3 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h3><p>创建一个延迟连接的流，其元素是第一个流的所有元素，后跟第二个流的所有元素。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; strings = Arrays.asList(<span class="string">"1"</span>, <span class="string">"5"</span>, <span class="string">""</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream strings1 = Stream.of(strings).filter(s -&gt; !s.isEmpty());</span><br><span class="line">List&lt;String&gt; string = Arrays.asList(<span class="string">"8"</span>, <span class="string">"5"</span>, <span class="string">"6"</span>, <span class="string">"6"</span>, <span class="string">"4"</span>);</span><br><span class="line">Stream strings2 = Stream.of(string).filter(s -&gt; !s.isEmpty());</span><br><span class="line">Stream.concat(strings1, strings2).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure></p><h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h3><p>使用关联累加函数对此流的元素执行减少，并返回描述减少值的Optional（如果有）。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> sum = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>).reduce(Integer::sum).get();</span><br><span class="line">System.out.println(sumValue1);</span><br><span class="line"><span class="keyword">int</span> sum1 = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>).reduce(<span class="number">2</span>, Integer::sum);<span class="comment">//表示identity=2，即该sum的初始值，所以Stream中的总和等于2+(1+2+3+4)=12</span></span><br><span class="line">System.out.println(sumValue);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure></p><h3 id="sum、max、min"><a href="#sum、max、min" class="headerlink" title="sum、max、min"></a>sum、max、min</h3><p>输出Stream流的和、最大值、最小值，返回的是<code>Optional</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>).reduce(Integer::sum).get());</span><br><span class="line">List&lt;Integer&gt; num = Arrays.asList(<span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">5</span>);</span><br><span class="line">System.out.println(Stream.of(num).reduce(Integer::max).get());</span><br><span class="line">System.out.println(Stream.of(num).reduce(Integer::min).get());</span><br><span class="line">输出：</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure></p><h3 id="empy"><a href="#empy" class="headerlink" title="empy"></a>empy</h3><p>返回一个空的顺序Stream。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; stream = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">Stream&lt;Integer&gt; stream1 = stream.empty();</span><br><span class="line">System.out.println(stream1.count());</span><br><span class="line">输出：</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure></p><h3 id="findFirst"><a href="#findFirst" class="headerlink" title="findFirst"></a>findFirst</h3><p>返回描述此流的第一个元素的Optional，如果流为空，则返回空Optional。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; stream = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">System.out.println(stream.findFirst().get());</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure></p><h3 id="peek"><a href="#peek" class="headerlink" title="peek"></a>peek</h3><p>返回由此流的元素组成的流，另外在每个元素上执行提供的操作，因为元素是从结果流中消耗的。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; stream = Stream.of(<span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"C"</span>, <span class="string">"f"</span>);</span><br><span class="line">List&lt;String&gt; list = stream.peek(e -&gt; System.out.println(<span class="string">"value: "</span> + e)).map(String::toUpperCase).collect(Collectors.toList());</span><br><span class="line">list.forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line">value: a</span><br><span class="line">value: c</span><br><span class="line">value: C</span><br><span class="line">value: f</span><br><span class="line">A</span><br><span class="line">C</span><br><span class="line">C</span><br><span class="line">F</span><br></pre></td></tr></table></figure></p><h3 id="toArray"><a href="#toArray" class="headerlink" title="toArray"></a>toArray</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Object[] array = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>).toArray();</span><br><span class="line">Integer[] n = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">11</span>).skip(<span class="number">3</span>).toArray(Integer[]::<span class="keyword">new</span>);</span><br><span class="line">Stream.of(n).forEach(System.out::println);</span><br><span class="line">输出：</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">11</span></span><br></pre></td></tr></table></figure><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p><a href="https://github.com/eirunye/MyEirunyeStream/blob/master/app/src/test/java/com/example/yrung/myeirunyestream/MyStreamTest.java" target="_blank" rel="noopener"><strong>案例下载</strong></a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p><a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" target="_blank" rel="noopener"><strong>Stream</strong></a> 常用的操作符，我们在这里的案例都差别多测试了，是不是感觉<a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html" target="_blank" rel="noopener"><strong>Stream</strong></a>给我们的感觉是一种很棒的开发案例，我们可以在开发中使用它，这样方便我们对集合的操作。</p><p>可能有些同学看到第一个的时候就觉得在哪里见过？是的，没错，是不是和<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener"><strong>RxJava</strong></a>的操作符的作用差不多都是非常类似的。当然了，<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">RxJava</a>的操作是非常丰富的，希望大家可以多多去了解。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;在Java 8中API添加了一个新的抽象称为流Stream，可以让你以一种声明的方式处理数据。在Java中只要你应用的版本是java 8以上
      
    
    </summary>
    
      <category term="Stream" scheme="http://eirunye.github.io/categories/Stream/"/>
    
      <category term="Stream操作符" scheme="http://eirunye.github.io/categories/Stream/Stream%E6%93%8D%E4%BD%9C%E7%AC%A6/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Stream" scheme="http://eirunye.github.io/tags/Stream/"/>
    
  </entry>
  
  <entry>
    <title>Java注解</title>
    <link href="http://eirunye.github.io/2018/12/07/Java%E6%B3%A8%E8%A7%A3/"/>
    <id>http://eirunye.github.io/2018/12/07/Java注解/</id>
    <published>2018-12-07T15:30:23.000Z</published>
    <updated>2018-12-07T15:54:49.841Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>由于无论在Java后台或者Android开发中我们经常遇到注解这个功能机制，例如常用的框架Java后台开发中，Spring、MyBatis等，Android的Dagger2，butterknife等，都是注解框架。今天我们就了解java是如何进行设置注解的？我们可以可以定义一个注解，方便我们使用等等。</p><h1 id="注解元"><a href="#注解元" class="headerlink" title="注解元"></a>注解元</h1><p>在进行了解注解时我们先来了解一下，一般注解主要包含以下几个重要的注解元，java注解的机制离不开这几个注解元。</p><table><thead><tr><th>注解元</th><th>介绍&lt;功能&gt;</th></tr></thead><tbody><tr><td>1.@Target</td><td>注解用于什么地方，下面会介绍</td></tr><tr><td>2.@Retention</td><td>什么时候使用该注解</td></tr><tr><td>3.@Documented</td><td>注解是否将包含在JavaDoc中</td></tr><tr><td>4.@Inherited</td><td>是否允许子类继承该注解，表示父类如果添加此注解，子类也可以使用</td></tr><tr><td>5.@Repeatable</td><td>java8添加的，可重复的，表该注解可以多次使用</td></tr></tbody></table><h1 id="注解的定义"><a href="#注解的定义" class="headerlink" title="注解的定义"></a>注解的定义</h1><p>注解的定义很简单，就是通过<code>@interface</code>来进行修饰注解，就是平时我们定义接口的时候前面添加一个<code>@</code>符号。当然了，注解的定义需要添加一些常用的注解元，才能有效的构造我们所需的注解。如下定义注解：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TestAnnotation &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="注解元解释"><a href="#注解元解释" class="headerlink" title="注解元解释"></a>注解元解释</h1><h2 id="Target"><a href="#Target" class="headerlink" title="@Target"></a>@Target</h2><p>通过<code>@Target</code>进行添加到注解中，说明了Annotation所修饰的对象范围：Annotation可被用于 packages、types（类、接口、枚举、Annotation类型）、类型成员（方法、构造方法、成员变量、枚举值）、方法参数和本地变量（如循环变量、catch参数）。在Annotation类型的声明中使用了<code>@target</code>可更加明晰其修饰的目标，用于什么地方，修饰什么东西，如下常用的几种方式。</p><ul><li><code>CONSTRUCTOR</code>: 用于描述构造器</li><li><code>FIELD</code>:用于描述域</li><li><code>LOCAL_VARIABLE</code>:用于描述局部变量</li><li><code>METHOD</code>:用于描述方法</li><li><code>PACKAGE</code>:用于描述包</li><li><code>PARAMETER</code>:用于描述参数</li><li><code>TYPE</code>:用于描述类、接口(包括注解类型) 或enum声明<br>如下代码<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.FIELD,ElementType.METHOD&#125;) <span class="comment">//多个的时候使用&#123;&#125;括起来，然后用逗号分隔开</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TargetTest &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="Retention"><a href="#Retention" class="headerlink" title="@Retention"></a>@Retention</h2><p>该注解是表示我们在运行或者编译时的一个保留状态，指示要保留带注释类型的注释的时间长度。</p><ul><li><code>SOURCE</code>:在源文件中有效（即源文件保留），在编译时将其抛弃掉。</li><li><code>CLASS</code>:在class文件中有效（即class保留），不会添加载到JVM中</li><li><code>RUNTIME</code>:在运行时有效（即运行时保留），这个和我们常用的加载是一致的，运行时会加载到JVM中，一般通过反射可获取到，一般这个是我们常用的。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)<span class="comment">//在使用该注解其，只能选择其中一种属性，不能定义多个</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RetentionTest &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="Documented"><a href="#Documented" class="headerlink" title="@Documented"></a>@Documented</h2><p><code>@Documented</code>用于描述其它类型的annotation应该被作为被标注的程序成员的公共API。<br>如下代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span> <span class="comment">//添加文档注解</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnotationTest &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Inherited："><a href="#Inherited：" class="headerlink" title="@Inherited："></a>@Inherited：</h2><p><code>@Inherited</code>元注解是一个标记注解， <code>@Inherited</code>阐述了某个被标注的类型是被继承的。如果一个使用了<code>@Inherited</code>修饰的annotation类型被用于一个class，则这个annotation将被用于该class的子类。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Inherited</span>  <span class="comment">//添加继承注解</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnotationTest &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="Repeatable"><a href="#Repeatable" class="headerlink" title="@Repeatable"></a>@Repeatable</h2><p>这个是在java8添加的注解特性，<code>@Repeatable</code>的值表示可重复注释类型的包含注释类型。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Repeatables &#123;</span><br><span class="line">    RepeatablesTest[] value();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Repeatable</span>(Repeatables.class)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RepeatablesTest &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> "哈哈哈"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><p>我们简单的介绍了注解的常用的5个注解元，解下来我们通过例子来实现注解。<br>代码如下，根据上面的提示我们进行测试。<br>在看例子之前我们先来了解一下常用的几个方法。</p><ul><li><code>Class.getAnnotations()</code> 获取所有的注解，包括自己声明的以及继承的</li><li><code>Class.getAnnotation(Class&lt; A &gt; annotationClass)</code> 获取指定的注解，该注解可以是自己声明的，也可以是继承的</li><li><code>Class.getDeclaredAnnotations()</code>获取自己声明的注解</li><li><code>Class.getDeclaredField(String name);</code> //获取该类的声明字段</li><li><code>Class.getDeclaredMethods();</code>//返回的是一个Method[]数组<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnotationTest &#123;</span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> "小明"</span>; <span class="comment">//表示默认为小明。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AnnotationTest</span>() <span class="comment">//在该类添加注解</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAnnotationMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> hasAnnotation = TestAnnotationMain.class.isAnnotationPresent(AnnotationTest.class);</span><br><span class="line">        <span class="keyword">if</span> (hasAnnotation) &#123;</span><br><span class="line">            AnnotationTest annotation = TestAnnotationMain.class.getAnnotation(AnnotationTest.class);</span><br><span class="line">            System.out.println(annotation.name());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>打印输出结果：</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-1f456a2d492413d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="输出1.png"></p><p>如果我们想更改name的值可以这么弄<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AnnotationTest</span>(name = <span class="string">"小刚"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAnnotationMain</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> hasAnnotation = TestAnnotationMain.class.isAnnotationPresent(AnnotationTest.class);</span><br><span class="line">        <span class="keyword">if</span> (hasAnnotation) &#123;</span><br><span class="line">            AnnotationTest annotation = TestAnnotationMain.class.getAnnotation(AnnotationTest.class);</span><br><span class="line">            System.out.println(annotation.name());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-037c41da49c434e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="输出2.png"><br>如果我们想给一个类的属性进行赋值可以这么做<br>1.创建一个注解如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnotationTest1 &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>; <span class="comment">//value来定义</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>2.引用该主解<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="meta">@AnnotationTest</span>1(value = <span class="string">"小云"</span>) <span class="comment">//引用注解进行赋值</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3.测试<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAnnotation1Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Field name = Test.class.getDeclaredField(<span class="string">"name"</span>);<span class="comment">//该该类的字段</span></span><br><span class="line">            name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            AnnotationTest1 annotationTest1 = name.getAnnotation(AnnotationTest1.class);<span class="comment">//获取该字段的注解</span></span><br><span class="line">            <span class="keyword">if</span> (annotationTest1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(annotationTest1.value()); <span class="comment">//输出值</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>获取方法上的注解类 如AnnotationTest2</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AnnotationTest2 &#123;</span><br><span class="line">     <span class="comment">//todo无任何方法或者属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AnnotationTest</span>1(value = <span class="string">"小云"</span>)</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AnnotationTest</span>2 <span class="comment">//目的获取该AnnotationTest2</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"方法执行"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>获取<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAnnotation1Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Field name = Test.class.getDeclaredField(<span class="string">"name"</span>); <span class="comment">//获取该类的声明字段</span></span><br><span class="line">            name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            AnnotationTest1 annotationTest1 = name.getAnnotation(AnnotationTest1.class);<span class="comment">//获取该字段的注解</span></span><br><span class="line">            <span class="keyword">if</span> (annotationTest1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(annotationTest1.value()); <span class="comment">//输出值</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Method fun = Test.class.getDeclaredMethod(<span class="string">"fun"</span>);</span><br><span class="line">            <span class="keyword">if</span> (fun != <span class="keyword">null</span>) &#123;</span><br><span class="line">                Annotation[] annotations = fun.getAnnotations();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; annotations.length; i++) &#123;</span><br><span class="line">                    System.out.println(annotations[i].annotationType().getSimpleName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException | NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>举例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Target(ElementType.METHOD)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface MyAnnotation &#123;</span><br><span class="line">&#125;</span><br><span class="line">////////////////////////////////////////////////////////////////////////////</span><br><span class="line">public class MyTest &#123; //进行获取注解方法的全部数据</span><br><span class="line">    @MyAnnotation</span><br><span class="line">    public void mytestLoad() &#123;</span><br><span class="line">        System.out.println(&quot;测试加载&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    @MyAnnotation</span><br><span class="line">    public void mytestRequest() &#123;</span><br><span class="line">        System.out.println(&quot;测试请求&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    @MyAnnotation</span><br><span class="line">    public void mytestProgress() &#123;</span><br><span class="line">        System.out.println(&quot;测试进度&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    @MyAnnotation</span><br><span class="line">    public void mytestError() &#123;</span><br><span class="line">        System.out.println(1 );</span><br><span class="line">    &#125;</span><br><span class="line">   ///////该方法不执行</span><br><span class="line">   public void mytestNoAnno()&#123;</span><br><span class="line">        System.out.println(&quot;没有注解的方法&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">////////////////////////////////////////////////////////////////////////////</span><br><span class="line">public class TestMain &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        MyTest myTest = new MyTest();</span><br><span class="line">        Method[] methods = myTest.getClass().getDeclaredMethods();</span><br><span class="line">        for (int i = 0; i &lt; methods.length; i++) &#123;</span><br><span class="line">            Method method = methods[i];</span><br><span class="line">            if (method.isAnnotationPresent(MyAnnotation.class)) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    method.setAccessible(true);</span><br><span class="line">                    method.invoke(myTest, null);//调用该类的注解方法</span><br><span class="line">                &#125; catch (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; catch (InvocationTargetException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;==================输出完成！====================&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5882231d506e3639.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="输出3.png"></p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p><a href="https://github.com/eirunye/Annotation_demo/tree/master" target="_blank" rel="noopener"><strong>Annotation案例代码下载</strong></a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>我们在开发中长见的注解如下：</p><table><thead><tr><th>常用注解</th><th>解释</th></tr></thead><tbody><tr><td>@Override</td><td>方法重写</td></tr><tr><td>@SuppressWarnings</td><td>提示警告</td></tr><tr><td>@SafeVarargs</td><td>参数安全</td></tr><tr><td>@Deprecated</td><td>作用是对不应该再使用的方法添加注解</td></tr><tr><td>@FunctionalInterface</td><td>函数式编程，用于Lambda 表达式</td></tr></tbody></table><p>注解给我们带来了许多方便，但是我们也得知道其优缺点。</p><ul><li><p>优点<br>注解方便我们进行单元测试，有利于进行开发。<br>代码整洁，通过注解的方式变可知修饰的变量，或者方法。<br>节省配置，减少配置文件大小。</p></li><li><p>缺点<br>通过反射进行设置，可能会产生性能上的问题。<br>若要对配置进行修改需要重新编译，扩展性差。</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;由于无论在Java后台或者Android开发中我们经常遇到注解这个功能机制，例如常用的框架Java后台开发中，Spring、MyBatis等
      
    
    </summary>
    
      <category term="Java注解" scheme="http://eirunye.github.io/categories/Java%E6%B3%A8%E8%A7%A3/"/>
    
    
      <category term="Java注解" scheme="http://eirunye.github.io/tags/Java%E6%B3%A8%E8%A7%A3/"/>
    
      <category term="Android" scheme="http://eirunye.github.io/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>EventBus源码解析</title>
    <link href="http://eirunye.github.io/2018/10/25/EventBus%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>http://eirunye.github.io/2018/10/25/EventBus源码解析/</id>
    <published>2018-10-25T08:29:33.000Z</published>
    <updated>2018-12-07T15:45:52.589Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>前面我学习了如何使用EventBus，还有了解了EventBus的特性，那么接下来我们一起来学习EventBus的源码，查看EventBus的源码，看看EventBus给我们带来什么惊喜以及编程思想。</p><p><img src="http://upload-images.jianshu.io/upload_images/3012005-7d20197cd887b0f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="EventBus-Android的发布 - 订阅"></p><p>这个图我从一开始就一直放置在上面了。我们在来回顾一下，EventBus的官网是怎么定义它的呢？<br>EventBus是Android和Java的<strong>发布/订阅（观察者模式）</strong>事件总线。<br>我们大概了解了EventBus的构建思想。接下来我们进入源码学习吧。</p><h1 id="进入源码分析"><a href="#进入源码分析" class="headerlink" title="进入源码分析"></a>进入源码分析</h1><p>我们从EventBus的注册开始入手。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault().register(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> EventBus <span class="title">getDefault</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (defaultInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (EventBus.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (defaultInstance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">//创建了EventBus实例，进入下面的方法</span></span><br><span class="line">                    defaultInstance = <span class="keyword">new</span> EventBus();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> defaultInstance;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>上面的方法是一个双重校验的单例。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">EventBus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(DEFAULT_BUILDER); <span class="comment">//private static final EventBusBuilder DEFAULT_BUILDER = new EventBusBuilder();</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p><code>DEFAULT_BUILDER</code>是<code>EventBusBuilder.class</code>实例来创建的，这个类非常重要：使用自定义参数创建EventBus实例，还允许自定义默认EventBus实例，如前面的例子使用索引、配置<a href="https://www.jianshu.com/p/7ed3b4ca0d8b" target="_blank" rel="noopener">EventBus的配置&amp;事件的优先级&amp;使用索引(四)</a>等就是通过这个类来实现的，大家可以回顾一下。进入初始化一下必要的参数的构造方法<code>EventBus(EventBusBuilder builder)</code>,如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">EventBus(EventBusBuilder builder) &#123;</span><br><span class="line">   logger = builder.getLogger(); /初始化Logger</span><br><span class="line">   subscriptionsByEventType = <span class="keyword">new</span> HashMap&lt;&gt;(); <span class="comment">//存储订阅事件的</span></span><br><span class="line">   typesBySubscriber = <span class="keyword">new</span> HashMap&lt;&gt;(); <span class="comment">//存储相关订阅者class列表，key是注册者的对象，value是订阅者的class列表</span></span><br><span class="line">   stickyEvents = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();  <span class="comment">//粘性事件</span></span><br><span class="line">   <span class="comment">//下面这4个实例就是我们设置方法``threadMode = ThreadMode.xxx``</span></span><br><span class="line">   <span class="comment">//*1</span></span><br><span class="line">   mainThreadSupport = builder.getMainThreadSupport();</span><br><span class="line">   mainThreadPoster = mainThreadSupport != <span class="keyword">null</span> ? mainThreadSupport.createPoster(<span class="keyword">this</span>) : <span class="keyword">null</span>;</span><br><span class="line">   backgroundPoster = <span class="keyword">new</span> BackgroundPoster(<span class="keyword">this</span>);</span><br><span class="line">   asyncPoster = <span class="keyword">new</span> AsyncPoster(<span class="keyword">this</span>);</span><br><span class="line">  <span class="comment">//获取注册者信息索引(添加由EventBus的注释预处理器生成的索引)</span></span><br><span class="line">   indexCount = builder.subscriberInfoIndexes != <span class="keyword">null</span> ? builder.subscriberInfoIndexes.size() : <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//初始订阅方法查找器。这个类主要具有查找订阅的方法，继续往下看</span></span><br><span class="line">   subscriberMethodFinder = <span class="keyword">new</span> SubscriberMethodFinder(builder.subscriberInfoIndexes,</span><br><span class="line">   builder.strictMethodVerification, builder.ignoreGeneratedIndex);</span><br><span class="line">   logSubscriberExceptions = builder.logSubscriberExceptions; <span class="comment">//是否有日记订阅，默认true</span></span><br><span class="line">   logNoSubscriberMessages = builder.logNoSubscriberMessages;<span class="comment">//是否有日记信息，默认 true</span></span><br><span class="line">   sendSubscriberExceptionEvent = builder.sendSubscriberExceptionEvent;<span class="comment">//是否发送订阅异常事件，默认true</span></span><br><span class="line">   sendNoSubscriberEvent = builder.sendNoSubscriberEvent;  <span class="comment">//是否发送没有订阅事件，默认true</span></span><br><span class="line">   throwSubscriberException = builder.throwSubscriberException; <span class="comment">//是否抛出异常处理</span></span><br><span class="line">  <span class="comment">//默认情况下，EventBus会考虑事件类层次结构（将通知超类的注册者）。 关闭此功能将改善事件的发布。对于直接扩展Object的简单事件类，我们测量事件发布的速度提高了20％。</span></span><br><span class="line">   eventInheritance = builder.eventInheritance;</span><br><span class="line">   executorService = builder.executorService;    <span class="comment">//创建线程池</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>我们将此段代码逐步分析.<br>这步主要是进行初始化话一下必要的参数，如代码注解所示。<br>下面这段代码就是我们常用的<code>@Subscribe(threadMode = ThreadMode.xxx);</code>初始化。一般常用的就是以下4种。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mainThreadSupport = builder.getMainThreadSupport();</span><br><span class="line">mainThreadPoster = mainThreadSupport != <span class="keyword">null</span> ? mainThreadSupport.createPoster(<span class="keyword">this</span>) : <span class="keyword">null</span>;</span><br><span class="line">backgroundPoster = <span class="keyword">new</span> BackgroundPoster(<span class="keyword">this</span>);</span><br><span class="line">asyncPoster = <span class="keyword">new</span> AsyncPoster(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p><p>我们来看看<code>builder.getMainThreadSupport()</code>方法返回的是<code>MainThreadSupport</code>接口，表示为支持Android主线程。<br>上面的4个线程中都持有  <code>PendingPostQueue</code>等待发送的队列实例。<br>由<code>mainThreadSupport.createPoster(this)</code>创建一个<code>HandlerPoster</code>而该类继承了<code>Handle</code>，并且初始化了一个等待发布队列。代码如下。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MainThreadSupport</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isMainThread</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Poster <span class="title">createPoster</span><span class="params">(EventBus eventBus)</span></span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">AndroidHandlerMainThreadSupport</span> <span class="keyword">implements</span> <span class="title">MainThreadSupport</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Looper looper;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">AndroidHandlerMainThreadSupport</span><span class="params">(Looper looper)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.looper = looper;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMainThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> looper == Looper.myLooper();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Poster <span class="title">createPoster</span><span class="params">(EventBus eventBus)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> HandlerPoster(eventBus, looper, <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">subscriberMethodFinder = new SubscriberMethodFinder(builder.subscriberInfoIndexes,</span><br><span class="line">                builder.strictMethodVerification, builder.ignoreGeneratedIndex);</span><br></pre></td></tr></table></figure><p>上面代码在这里主要初始化订阅的方法查找器。下面会讲解到它是如何进行订阅方法的。<br>我们这这里知道了EventBus初始化，然后相关的实例的创建，接下来我我们进入到<code>register(this)</code>方法的调用如下方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(Object subscriber)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取当前注册者对象的Class。</span></span><br><span class="line">        Class&lt;?&gt; subscriberClass = subscriber.getClass();</span><br><span class="line">        <span class="comment">//通过该注册者的`Class`来获取当前注册者里面由`@Subscriber`注解绑定的方法。</span></span><br><span class="line">        List&lt;SubscriberMethod&gt; subscriberMethods = subscriberMethodFinder.findSubscriberMethods(subscriberClass);</span><br><span class="line">        <span class="comment">//必须在线程同步中进行。</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (SubscriberMethod subscriberMethod : subscriberMethods) &#123;</span><br><span class="line">                subscribe(subscriber, subscriberMethod);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>上面的代码表示的是给注册者接收事件。 传递当前所注册的对象，如<code>Activity、Fragment</code>。</p><ul><li>注意： 注册者如果不再接收信息，必须调用<code>unregister(Object)</code>方法，表示解除注册则该订阅者将不再接收到数据了，如果不进行解除将可能出现内存泄漏。一般在<code>onDestroy</code>方法解除注册后面会讲解到。 在注册者中拥有必须由<code>@Subscribe</code>注解的方法。<code>@Subscribe</code>还允许配置<code>ThreadMode</code>和优先级、是否是粘性行为。</li></ul><p>接着，我们进入<code>List&lt;SubscriberMethod&gt; subscriberMethods = subscriberMethodFinder.findSubscriberMethods(subscriberClass);</code>方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//private static final Map&lt;Class&lt;?&gt;, List&lt;SubscriberMethod&gt;&gt; METHOD_CACHE = new ConcurrentHashMap&lt;&gt;(); //线程安全</span></span><br><span class="line"></span><br><span class="line"><span class="function">List&lt;SubscriberMethod&gt; <span class="title">findSubscriberMethods</span><span class="params">(Class&lt;?&gt; subscriberClass)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//从Map集合中获取订阅方法列表</span></span><br><span class="line">   List&lt;SubscriberMethod&gt; subscriberMethods = METHOD_CACHE.get(subscriberClass);</span><br><span class="line">  <span class="comment">//判断当前获取方法是否为空</span></span><br><span class="line">  <span class="keyword">if</span> (subscriberMethods != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> subscriberMethods;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//通过EventBusBuilder.ignoreGeneratedIndex</span></span><br><span class="line">  <span class="comment">//是否忽略配置索引，默认是忽略索引</span></span><br><span class="line">  <span class="keyword">if</span> (ignoreGeneratedIndex) &#123;</span><br><span class="line">    <span class="comment">//1.通过反射获取方法列表</span></span><br><span class="line">     subscriberMethods = findUsingReflection(subscriberClass);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//2.通过索引方式获取订阅方法列表</span></span><br><span class="line">     subscriberMethods = findUsingInfo(subscriberClass);</span><br><span class="line">   &#125;</span><br><span class="line">  <span class="comment">//是否订阅方法为空，如果为空则表示该订阅者里面的方法都不符合EventBus订阅方法的规则</span></span><br><span class="line">  <span class="keyword">if</span> (subscriberMethods.isEmpty()) &#123;</span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> EventBusException(<span class="string">"Subscriber "</span> + subscriberClass</span><br><span class="line">                    + <span class="string">" and its super classes have no public methods with the @Subscribe annotation"</span>);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//存储到集合中</span></span><br><span class="line">     METHOD_CACHE.put(subscriberClass, subscriberMethods);</span><br><span class="line">            <span class="keyword">return</span> subscriberMethods;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>我们逐步分析该段代码。<br>该段代码通过注册者的类来获取当前dingy的方法列表，如果不为空则直接返回订阅方法。<br>通过反射来查找订阅方法，如果该方法为空则抛出异常：该订阅者的方法和其超类没有<code>@Subscriber</code>注解的共有方法（即表示不符合EventBus订阅方法的规则）。如果不为空则存储到<code>ConcurrentHashMap</code>集合中。<br>这里的是由<code>ConcurrentHashMap</code>集合存储是以当前订阅者的<code>class</code>为<code>key</code>，而将其由<code>@Subscriber</code>绑定的方法添加到<code>List</code>中,，就是集合的<code>value</code>。必须保持线程安全的，所以这里使用了<code>ConcurrentHashMap</code>。</p><ul><li><strong>1.是否忽略索引设置，该方法表示忽略设置索引,进入该方法<code>findUsingReflection(Class&lt;?&gt; subscriberClass)</code>，通过反射进行获取<code>List&lt;SubscriberMethod&gt;</code></strong></li><li>注：设置索引在<a href="https://www.jianshu.com/p/7ed3b4ca0d8b" target="_blank" rel="noopener">EventBus的配置&amp;事件的优先级&amp;使用索引(四)</a>这里说的，大家可以去看看。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> List&lt;SubscriberMethod&gt; <span class="title">findUsingReflection</span><span class="params">(Class&lt;?&gt; subscriberClass)</span> </span>&#123;</span><br><span class="line">        FindState findState = prepareFindState();<span class="comment">//准备查找状态</span></span><br><span class="line">        findState.initForSubscriber(subscriberClass);<span class="comment">// 初始化订阅者信息</span></span><br><span class="line">        <span class="keyword">while</span> (findState.clazz != <span class="keyword">null</span>) &#123;<span class="comment">//循环获取订阅者的class是否为空</span></span><br><span class="line">            <span class="comment">//通过反射获取订阅方法，</span></span><br><span class="line">            <span class="comment">// 3.该方法下面分析</span></span><br><span class="line">            findUsingReflectionInSingleClass(findState);</span><br><span class="line">            findState.moveToSuperclass(); <span class="comment">//删除超类class</span></span><br><span class="line">        &#125;</span><br><span class="line">           <span class="comment">////获取订阅方法list</span></span><br><span class="line">        <span class="keyword">return</span> getMethodsAndRelease(findState);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><p>上面的代码主要是通过反射来获取相关的订阅方法，里面由静态内部类<code>FindState</code>进行管理相关信息，由于上面的方法和下面索引的方法都将调用同一个方法，所以放在下面来将讲解，请看下面信息。</p><ul><li><strong>2.是否忽略索引设置，该方法表示的设置了索引，进入<code>findUsingInfo(Class&lt;?&gt; subscriberClass)</code>方法，如下。</strong><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> List&lt;SubscriberMethod&gt; <span class="title">findUsingInfo</span><span class="params">(Class&lt;?&gt; subscriberClass)</span> </span>&#123;</span><br><span class="line">        FindState findState = prepareFindState(); <span class="comment">//准备查找状态</span></span><br><span class="line">        findState.initForSubscriber(subscriberClass);<span class="comment">// 初始化订阅者信息</span></span><br><span class="line">        <span class="keyword">while</span> (findState.clazz != <span class="keyword">null</span>) &#123; <span class="comment">//循环获取订阅者的class是否为空</span></span><br><span class="line">            findState.subscriberInfo = getSubscriberInfo(findState);<span class="comment">//获取获取订阅者信息，这里如果使用添加索引的话，这里将能获取到索引的相关信息。</span></span><br><span class="line">            <span class="keyword">if</span> (findState.subscriberInfo != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//获取订阅方法</span></span><br><span class="line">                SubscriberMethod[] array = findState.subscriberInfo.getSubscriberMethods();</span><br><span class="line">                <span class="keyword">for</span> (SubscriberMethod subscriberMethod : array) &#123;</span><br><span class="line">                 <span class="comment">//进行等级检查，并存储到Map集合中，该方法checkAdd是FindState.class中的方法 ，key是@Subscriber中参数的class，value是该subscriberMethod.method，也就是@Subscribe中的方法如：public void onMessageEvent(MessageEvent event)</span></span><br><span class="line">                 <span class="keyword">if</span> (findState.checkAdd(subscriberMethod.method, subscriberMethod.eventType)) &#123;</span><br><span class="line">                        <span class="comment">//将该订阅方法添加到列表中</span></span><br><span class="line">                        findState.subscriberMethods.add(subscriberMethod);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//3.通过使用反射的方式来获取，和上面忽略索引调用到同一个方法，这里将解析</span></span><br><span class="line">                findUsingReflectionInSingleClass(findState);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//清除父类的方法</span></span><br><span class="line">            findState.moveToSuperclass();</span><br><span class="line">        &#125;</span><br><span class="line">           <span class="comment">//获取订阅方法list</span></span><br><span class="line">        <span class="keyword">return</span> getMethodsAndRelease(findState);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><p>分析本段代码。<br>首先进入查找的准备状态，通过默认状态池返回状态信息，主要存储的是<code>FindState</code>实例。主要存储的有订阅者的class、订阅者信息<code>SubscriberInfo</code>。订阅者<code>@Subscribe</code>方法列表<code>List&lt;SubscriberMethod&gt;</code>等.<br>如果当前订阅者<code>class</code>不为空，则将获取到订阅者信息。这里分两种情况。<br>如果使用添加索引的话，<code>getSubscriberInfo(findState)</code>该方法将获取到订阅信息，如果没有使用索引的话则将调用<code>findUsingReflectionInSingleClass(findState);</code>该方法来获取信息</p><ul><li><strong>使用添加索引，并返回订阅方法，该方法如下</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//获取订阅方法</span><br><span class="line">SubscriberMethod[] array = findState.subscriberInfo.getSubscriberMethods();</span><br></pre></td></tr></table></figure></li></ul><p>由于<code>AbstractSubscriberInfo</code>类实现了<code>SubscriberInfo</code>接口，而<code>SimpleSubscriberInfo</code>继承了<code>AbstractSubscriberInfo</code>并实现了<code>getSubscriberMethods</code>方法，代码如下：<br>本段代码在<code>SimpleSubscriberInfo.class</code>中。返回订阅方法数组<code>SubscriberMethod[]</code>。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> SubscriberMethod[] getSubscriberMethods() &#123;</span><br><span class="line">        <span class="keyword">int</span> length = methodInfos.length;</span><br><span class="line">        SubscriberMethod[] methods = <span class="keyword">new</span> SubscriberMethod[length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            SubscriberMethodInfo info = methodInfos[i];</span><br><span class="line">            methods[i] = createSubscriberMethod(info.methodName, info.eventType, info.threadMode,</span><br><span class="line">                    info.priority, info.sticky);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> methods;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><ul><li><strong>3.如果没有添加索引则进入该方法<code>findUsingReflectionInSingleClass(findState);</code></strong><br>通过反射来获取订阅者方法。这个方法有点长，慢慢看。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">findUsingReflectionInSingleClass</span><span class="params">(FindState findState)</span> </span>&#123;</span><br><span class="line">        Method[] methods;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// This is faster than getMethods, especially when subscribers are fat classes like Activities</span></span><br><span class="line">            <span class="comment">//该方法代替getMethods()方法，获取该订阅者class全部方法。</span></span><br><span class="line">            methods = findState.clazz.getDeclaredMethods();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable th) &#123;</span><br><span class="line">            <span class="comment">// Workaround for java.lang.NoClassDefFoundError, see https://github.com/greenrobot/EventBus/issues/149</span></span><br><span class="line">            methods = findState.clazz.getMethods(); <span class="comment">//获取该订阅者class全部方法</span></span><br><span class="line">            findState.skipSuperClasses = <span class="keyword">true</span>;  <span class="comment">//设置跳过超类</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            <span class="keyword">int</span> modifiers = method.getModifiers();<span class="comment">//获取修饰符</span></span><br><span class="line">            <span class="keyword">if</span> ((modifiers &amp; Modifier.PUBLIC) != <span class="number">0</span> &amp;&amp; (modifiers &amp; MODIFIERS_IGNORE) == <span class="number">0</span>) &#123; <span class="comment">//通过与运算判断当前的修饰符，是否符合EventBus方法定义</span></span><br><span class="line">                Class&lt;?&gt;[] parameterTypes = method.getParameterTypes(); <span class="comment">//获取参数类型</span></span><br><span class="line">                <span class="keyword">if</span> (parameterTypes.length == <span class="number">1</span>) &#123; <span class="comment">//因为EventBus方法中必须有参数，所以当参数为1时，符合要求</span></span><br><span class="line">                    <span class="comment">//通过注解的形式@Subscribe获取Subscribe，默认的Subscribe为(priority==0,sticky=false,threadMode=POSTING),就是说ThreadMode为POSTING，粘性为false，优先级为0,如果方法中设置了相应的值，则将是你设置的值。如threadMode=MAIN。</span></span><br><span class="line">                    Subscribe subscribeAnnotation = method.getAnnotation(Subscribe.class);</span><br><span class="line">                    <span class="keyword">if</span> (subscribeAnnotation != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        Class&lt;?&gt; eventType = parameterTypes[<span class="number">0</span>]; <span class="comment">//获取当前参数的class</span></span><br><span class="line">                        <span class="comment">//进行等级检查，并存储到Map集合中，该方法checkAdd是FindState.class中的方法 ，key是@Subscriber中参数的class，value是该subscriberMethod.method，也就是@Subscribe中的方法如：public void onMessageEvent(MessageEvent event)</span></span><br><span class="line">                        <span class="keyword">if</span> (findState.checkAdd(method, eventType)) &#123;</span><br><span class="line">                            <span class="comment">// 获取ThreadMode ，如MAIN</span></span><br><span class="line">                            ThreadMode threadMode = subscribeAnnotation.threadMode();</span><br><span class="line">                            <span class="comment">//将订阅方法添加到列表中</span></span><br><span class="line">                            findState.subscriberMethods.add(<span class="keyword">new</span> SubscriberMethod(method, eventType, threadMode,</span><br><span class="line">                                    subscribeAnnotation.priority(), subscribeAnnotation.sticky()));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) &#123; <span class="comment">//不符合EventBus订阅方法的规则要求。抛出异常，提示该方法必须是@Subscribe注解，并且需要一个参数</span></span><br><span class="line">                    String methodName = method.getDeclaringClass().getName() + <span class="string">"."</span> + method.getName();</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> EventBusException(<span class="string">"@Subscribe method "</span> + methodName +</span><br><span class="line">                            <span class="string">"must have exactly 1 parameter but has "</span> + parameterTypes.length);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) &#123;<span class="comment">//是一种非法的@Subscribe方法：必须是公共的，非静态的，非抽象的</span></span><br><span class="line">                String methodName = method.getDeclaringClass().getName() + <span class="string">"."</span> + method.getName();</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> EventBusException(methodName +</span><br><span class="line">                        <span class="string">" is a illegal @Subscribe method: must be public, non-static, and non-abstract"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><p>该段代码主要是获取该注册者的全部方法，并进行筛选出来符合EventBus的订阅方法的规则，通过注解的形式来获取订阅方法，最后添加到查找状态的列表中。<br>首先获取的是修饰符，参数类型，再通过注解的形式来获取订阅方法。如下注解<code>Subscribe</code>，如果不符合EventBus相关订阅方法的规则将抛出异常提示，是否在方法上书写了错误的方法。<br>接下来我们进入看看<code>@Subscribe</code>订阅方法是通过注解的形式来设置的。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Subscribe &#123;</span><br><span class="line">     <span class="comment">//ThreadMode ，默认POSTING</span></span><br><span class="line">    <span class="function">ThreadMode <span class="title">threadMode</span><span class="params">()</span> <span class="keyword">default</span> ThreadMode.POSTING</span>;</span><br><span class="line">    <span class="comment">//粘性事件，默认false</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">sticky</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line">    <span class="comment">//优先级，默认0</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">priority</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>接下来进入<code>getMethodsAndRelease(FindState findState)</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> List&lt;SubscriberMethod&gt; <span class="title">getMethodsAndRelease</span><span class="params">(FindState findState)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取到订阅方法列表</span></span><br><span class="line">        List&lt;SubscriberMethod&gt; subscriberMethods = <span class="keyword">new</span> ArrayList&lt;&gt;(findState.subscriberMethods);</span><br><span class="line">        findState.recycle(); <span class="comment">//清空回收相关信息</span></span><br><span class="line">        <span class="keyword">synchronized</span> (FIND_STATE_POOL) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; POOL_SIZE; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (FIND_STATE_POOL[i] == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    FIND_STATE_POOL[i] = findState; <span class="comment">//将查找状态器findState，添加到状态池FIND_STATE_POOL中，为下次直接从查找状态池中获取</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> subscriberMethods; <span class="comment">// 返回订阅方法列表</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>上面该方法通过<code>FindState</code>静态内部类获取了订阅的列表，然后被存储到了<code>ConcurrentHashMap</code>集合中。并且存储到状态池中，为方便下次读取。并且回收资源。<br>获取到<code>List&lt;SubscriberMethod&gt;</code>订阅列表后，再次回到了注册方法中register(Object subscriber)进入到方法<code>subscribe(subscriber, subscriberMethod);</code>该方法通过循环进行遍历</p><ul><li>注 此处必须是在线程同步中进行，所以添加synchronized。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里的参数subscriber表示的是订阅者，如Activity等，subscriberMethod表示订阅方法，该方法就是在subscriber里面</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(Object subscriber, SubscriberMethod subscriberMethod)</span> </span>&#123;</span><br><span class="line">        Class&lt;?&gt; eventType = subscriberMethod.eventType; <span class="comment">//获取事件类型，也就是参数的class</span></span><br><span class="line">        Subscription newSubscription = <span class="keyword">new</span> Subscription(subscriber, subscriberMethod);</span><br><span class="line">        <span class="comment">//通过事件类型参数class获取CopyOnWriteArrayList&lt;Subscription&gt;列表，该类大家可以研究一下，</span></span><br><span class="line">        <span class="comment">//是写时复制容器，即当我们往`CopyOnWriteArrayList`容器添加元素时，先从原有的数组中拷贝一份出来，然后在新的容器做写操作(添加元素)，写完之后，再将原来的数组引用指向到新数组的形式存储数据的，它是线程安全的。</span></span><br><span class="line">        CopyOnWriteArrayList&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType);</span><br><span class="line">        <span class="keyword">if</span> (subscriptions == <span class="keyword">null</span>) &#123;</span><br><span class="line">            subscriptions = <span class="keyword">new</span> CopyOnWriteArrayList&lt;&gt;();</span><br><span class="line">            subscriptionsByEventType.put(eventType, subscriptions); <span class="comment">//添加到Map集合中</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (subscriptions.contains(newSubscription)) &#123; <span class="comment">//是否已经存在了</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> EventBusException(<span class="string">"Subscriber "</span> + subscriber.getClass() + <span class="string">" already registered to event "</span></span><br><span class="line">                        + eventType);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> size = subscriptions.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= size; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == size || subscriberMethod.priority &gt; subscriptions.get(i).subscriberMethod.priority) &#123; <span class="comment">//判断优先级</span></span><br><span class="line">                subscriptions.add(i, newSubscription);<span class="comment">//优先级高的添加添加到CopyOnWriteArrayList容器最前面，只有一个的时候就是添加在第一位了。</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//获取订阅事件的class列表，即订阅方法的参数class列表</span></span><br><span class="line">        List&lt;Class&lt;?&gt;&gt; subscribedEvents = typesBySubscriber.get(subscriber);</span><br><span class="line">        <span class="keyword">if</span> (subscribedEvents == <span class="keyword">null</span>) &#123;</span><br><span class="line">            subscribedEvents = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="comment">//存储到Map集合，key是订阅者(即上面传递的Activity对象)，value是订阅事件列表</span></span><br><span class="line">            typesBySubscriber.put(subscriber, subscribedEvents);</span><br><span class="line">        &#125;</span><br><span class="line">        subscribedEvents.add(eventType); <span class="comment">//将该事件类型class添加到订阅事件列表中</span></span><br><span class="line">        判断当前方法是否是粘性的</span><br><span class="line">        <span class="keyword">if</span> (subscriberMethod.sticky) &#123;</span><br><span class="line">            <span class="keyword">if</span> (eventInheritance) &#123;</span><br><span class="line">                <span class="comment">//必须考虑eventType的所有子类的现有粘性事件</span></span><br><span class="line">                <span class="comment">// Existing sticky events of all subclasses of eventType have to be considered.</span></span><br><span class="line">                <span class="comment">// Note: Iterating over all events may be inefficient with lots of sticky events,</span></span><br><span class="line">                <span class="comment">// thus data structure should be changed to allow a more efficient lookup</span></span><br><span class="line">                <span class="comment">// (e.g. an additional map storing sub classes of super classes: Class -&gt; List&lt;Class&gt;).</span></span><br><span class="line">                Set&lt;Map.Entry&lt;Class&lt;?&gt;, Object&gt;&gt; entries = stickyEvents.entrySet();</span><br><span class="line">                <span class="keyword">for</span> (Map.Entry&lt;Class&lt;?&gt;, Object&gt; entry : entries) &#123;</span><br><span class="line">                    Class&lt;?&gt; candidateEventType = entry.getKey();</span><br><span class="line">                      isAssignableFrom(Class&lt;?&gt; cls)方法表示的类型是否可以通过标识转换或通过扩展引用转换为此类对象表示的类型，则返回<span class="keyword">true</span></span><br><span class="line">                    <span class="keyword">if</span> (eventType.isAssignableFrom(candidateEventType)) &#123;</span><br><span class="line">                        Object stickyEvent = entry.getValue();</span><br><span class="line">                        <span class="comment">//将粘性事件添加到订阅者列表中</span></span><br><span class="line">                        checkPostStickyEventToSubscription(newSubscription, stickyEvent);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//将粘性事件添加到订阅者列表中</span></span><br><span class="line">                Object stickyEvent = stickyEvents.get(eventType);</span><br><span class="line">                checkPostStickyEventToSubscription(newSubscription, stickyEvent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><p>上面的方法中主要是通过获取”事件类型”即订阅方法中的参数<code>class</code>。然后将其添加到Map集合中，这里用到了<code>CopyOnWriteArrayList</code>(原理：是写时复制容器，即当我们往CopyOnWriteArrayList容器添加元素时，先从原有的数组中拷贝一份出来，然后在新的容器做写操作(添加元素)，写完之后，再将原来的数组引用指向到新数组的形式存储数据的，它是线程安全的。)<br>然后进行判断是否设置优先级，遍历并添加到<code>subscriptions</code>列表中。<br>通过当前的注册者，获取注册者class列表，并添加到<code>typesBySubscriber</code>集合中，<code>key</code>是注册者的<code>class</code>，如：<code>Activity</code>，而<code>value</code>就是订阅方法中的参数<code>class</code>的列表。这个地方说明了，一个注册者，可以拥有多个订阅事件(方法)，将其绑定起来，存储到Map集合中。最后将该参数class添加到<code>subscribedEvents.add(eventType);</code>列表中。<br>下面方法是检查粘性事件订阅发送事件方法，如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">checkPostStickyEventToSubscription</span><span class="params">(Subscription newSubscription, Object stickyEvent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (stickyEvent != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// If the subscriber is trying to abort the event, it will fail (event is not tracked in posting state)</span></span><br><span class="line">            <span class="comment">// --&gt; Strange corner case, which we don't take care of here.</span></span><br><span class="line">            <span class="comment">//这段代码我们到post发送事件的调用的时候讲解。</span></span><br><span class="line">            postToSubscription(newSubscription, stickyEvent, isMainThread());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><ul><li><p>注：这里主要是检查是否发送粘性发送事件，方法 <code>postToSubscription</code>我们到发送事件POST方法调用时讲解。</p></li><li><p><strong>事件发送</strong><br>接下来我进入<code>post</code>方法，事件发送。此时，我们回忆一下简介中的图：<br><code>post()==&gt;EventBus==&gt;将分发到各个订阅事件中</code>。也就是订阅方法。我们来看看是如何进行操作的。代码如下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault().post(<span class="keyword">new</span> MessageEvent(message));</span><br></pre></td></tr></table></figure></li></ul><p>通过以上代码我大概的知道，<code>post()</code>方法里面的参数是一个实体的对象，而该实体就是我们在订阅方法中的参数实体。你发现了什么了吗？<br>前边我们已经分析了，该注册者的订阅方法主要的存储过程，接下来我们一起进入探究吧。方法跟踪进入<code>post()</code>方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Posts the given event to the event bus. */</span></span><br><span class="line">    <span class="comment">//给订阅事件，发送事件总线</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">post</span><span class="params">(Object event)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取当前线程，即通过ThreadLocal本地线程来管理对应的事件线程，并且初始化发送线程状态PostingThreadState</span></span><br><span class="line">        PostingThreadState postingState = currentPostingThreadState.get();</span><br><span class="line">        List&lt;Object&gt; eventQueue = postingState.eventQueue;</span><br><span class="line">        eventQueue.add(event); <span class="comment">//添加到事件队列中</span></span><br><span class="line">        <span class="comment">//判断当前发送线程状态是否是正在发送的事件</span></span><br><span class="line">        <span class="keyword">if</span> (!postingState.isPosting) &#123;</span><br><span class="line">            postingState.isMainThread = isMainThread();</span><br><span class="line">            postingState.isPosting = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (postingState.canceled) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> EventBusException(<span class="string">"Internal error. Abort state was not reset"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (!eventQueue.isEmpty()) &#123;</span><br><span class="line">                    <span class="comment">//发送事件，发送完一个删除一个，直到发送全部停止循环</span></span><br><span class="line">                    postSingleEvent(eventQueue.remove(<span class="number">0</span>), postingState);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="comment">//设置标志改变</span></span><br><span class="line">                postingState.isPosting = <span class="keyword">false</span>;</span><br><span class="line">                postingState.isMainThread = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p><code>currentPostingThreadState.get()</code>方法中我们知道<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private final ThreadLocal&lt;PostingThreadState&gt; currentPostingThreadState = new ThreadLocal&lt;PostingThreadState&gt;() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        protected PostingThreadState initialValue() &#123;</span><br><span class="line">            return new PostingThreadState();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p><p>通过<code>ThreadLocal</code>这里就叫”本地线程”吧，来管理当前的发送线程状态，每个发送线程将得到对应一个<code>PostingThreadState</code>，而该<code>PostingThreadState</code>管理<code>eventQueue</code>信息，该信息主要存储的是发送事件。<br>通过<code>eventQueue.add(event)</code>存储该发送事件以后完成以后，就判断当前的发送事件状态是否是正在发送中，如果还没发送则当该<code>eventQueue</code>不为为空的时候，进入循环发送该事件，发送完一个就删除一个，直到发送完成为止。<br>进入方法<code>postSingleEvent(Object event, PostingThreadState postingState)</code>中。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">postSingleEvent</span><span class="params">(Object event, PostingThreadState postingState)</span> <span class="keyword">throws</span> Error </span>&#123;</span><br><span class="line">        Class&lt;?&gt; eventClass = event.getClass();</span><br><span class="line">        <span class="keyword">boolean</span> subscriptionFound = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (eventInheritance) &#123;</span><br><span class="line">            <span class="comment">//查找所有事件类型</span></span><br><span class="line">            List&lt;Class&lt;?&gt;&gt; eventTypes = lookupAllEventTypes(eventClass);</span><br><span class="line">            <span class="keyword">int</span> countTypes = eventTypes.size();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; countTypes; h++) &#123;</span><br><span class="line">                Class&lt;?&gt; clazz = eventTypes.get(h);</span><br><span class="line">                <span class="comment">//发送事件</span></span><br><span class="line">                subscriptionFound |= postSingleEventForEventType(event, postingState, clazz);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            subscriptionFound = postSingleEventForEventType(event, postingState, eventClass);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!subscriptionFound) &#123;</span><br><span class="line">            <span class="keyword">if</span> (logNoSubscriberMessages) &#123;</span><br><span class="line">                logger.log(Level.FINE, <span class="string">"No subscribers registered for event "</span> + eventClass);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (sendNoSubscriberEvent &amp;&amp; eventClass != NoSubscriberEvent.class &amp;&amp;</span><br><span class="line">                    eventClass != SubscriberExceptionEvent.class) &#123;</span><br><span class="line">                post(<span class="keyword">new</span> NoSubscriberEvent(<span class="keyword">this</span>, event));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>上面的方法首先获取该事件类型的<code>class</code>然后传递到<code>lookupAllEventTypes(eventClass)</code>方法中，通过该方法获取当前发送事件的<code>class</code>，包括父类、实现的接口等等列表。所以一般情况下会返回当前发送的事件，和<code>Object.class</code>(注：当然了，如果该事件实现接口的话，也会包括实现的接口的。)列表即<code>List&lt;Class&lt;?&gt;&gt;</code>，然后进行遍历进行或运算。<br>我们先进入<code>lookupAllEventTypes(eventClass)</code>方法，看看返回的事件类型，并且知道他存储到Map集合中，即key是当前事件class，value是该事件的所有类型，包括父类，接口等。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Looks up all Class objects including super classes and interfaces. Should also work for interfaces. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Class&lt;?&gt;&gt; lookupAllEventTypes(Class&lt;?&gt; eventClass) &#123;</span><br><span class="line">        <span class="comment">//private static final Map&lt;Class&lt;?&gt;, List&lt;Class&lt;?&gt;&gt;&gt; eventTypesCache = new HashMap&lt;&gt;(); key是当前事件类型的class，valu则是事件的所有类型，包括父类，接口等。本事例会得到的是MessageEvent.class、和Object.class</span></span><br><span class="line">        <span class="keyword">synchronized</span> (eventTypesCache) &#123;</span><br><span class="line">            List&lt;Class&lt;?&gt;&gt; eventTypes = eventTypesCache.get(eventClass);</span><br><span class="line">            <span class="keyword">if</span> (eventTypes == <span class="keyword">null</span>) &#123;</span><br><span class="line">                eventTypes = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">                Class&lt;?&gt; clazz = eventClass;</span><br><span class="line">                <span class="keyword">while</span> (clazz != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    eventTypes.add(clazz); <span class="comment">//添加到列表中</span></span><br><span class="line">                    <span class="comment">//添加接口</span></span><br><span class="line">                    addInterfaces(eventTypes, clazz.getInterfaces());</span><br><span class="line">                    clazz = clazz.getSuperclass(); <span class="comment">//获取父类class</span></span><br><span class="line">                &#125;</span><br><span class="line">                eventTypesCache.put(eventClass, eventTypes); <span class="comment">//存储d</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> eventTypes;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>看看方法<code>postSingleEventForEventType(event, postingState, clazz)</code>，发送事件<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">postSingleEventForEventType</span><span class="params">(Object event, PostingThreadState postingState, Class&lt;?&gt; eventClass)</span> </span>&#123;</span><br><span class="line">        CopyOnWriteArrayList&lt;Subscription&gt; subscriptions;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">             <span class="comment">//通过当前的事件class，获取订阅事件列表</span></span><br><span class="line">            subscriptions = subscriptionsByEventType.get(eventClass);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (subscriptions != <span class="keyword">null</span> &amp;&amp; !subscriptions.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Subscription subscription : subscriptions) &#123;</span><br><span class="line">                <span class="comment">//对PostingThreadState进行赋值</span></span><br><span class="line">                postingState.event = event;</span><br><span class="line">                postingState.subscription = subscription;</span><br><span class="line">                <span class="keyword">boolean</span> aborted = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//发送事件</span></span><br><span class="line">                    postToSubscription(subscription, event, postingState.isMainThread);</span><br><span class="line">                    aborted = postingState.canceled;</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="comment">//设置参数为空</span></span><br><span class="line">                    postingState.event = <span class="keyword">null</span>;</span><br><span class="line">                    postingState.subscription = <span class="keyword">null</span>;</span><br><span class="line">                    postingState.canceled = <span class="keyword">false</span>; <span class="comment">//设置标志</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (aborted) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>大家是否还记得在注册的时候出现的<code>CopyOnWriteArrayList&lt;Subscription&gt;</code>在这里就用到了，通过发送事件的<code>class</code>获取<code>CopyOnWriteArrayList</code>容器里面的订阅事件信息，包括注册者对象，订阅方法等。然后遍历并进行发送事件。在此方法发布<code>postToSubscription()</code>事件<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * subscription：发布订阅的事件处理器</span></span><br><span class="line"><span class="comment">  * event：当前发布的事件</span></span><br><span class="line"><span class="comment">  * isMainThread：是否是在主线程中</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">postToSubscription</span><span class="params">(Subscription subscription, Object event, <span class="keyword">boolean</span> isMainThread)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (subscription.subscriberMethod.threadMode) &#123;</span><br><span class="line">            <span class="keyword">case</span> POSTING:</span><br><span class="line">                invokeSubscriber(subscription, event);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MAIN:</span><br><span class="line">                <span class="keyword">if</span> (isMainThread) &#123;</span><br><span class="line">                    invokeSubscriber(subscription, event);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    mainThreadPoster.enqueue(subscription, event);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MAIN_ORDERED:</span><br><span class="line">                <span class="keyword">if</span> (mainThreadPoster != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    mainThreadPoster.enqueue(subscription, event);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// temporary: technically not correct as poster not decoupled from subscriber</span></span><br><span class="line">                    invokeSubscriber(subscription, event);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> BACKGROUND:</span><br><span class="line">                <span class="keyword">if</span> (isMainThread) &#123;</span><br><span class="line">                    backgroundPoster.enqueue(subscription, event);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    invokeSubscriber(subscription, event);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> ASYNC:</span><br><span class="line">                asyncPoster.enqueue(subscription, event);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Unknown thread mode: "</span> + subscription.subscriberMethod.threadMode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>好了，这就是之前我们在注册中有一个地方遗留下的，就是判断是否是粘性状态是调用的方法，大家往回看，就看到了在方法<code>checkPostStickyEventToSubscription</code>中有调用到该方法。<br>这里会根据，在方法中所选的<code>threadMode</code>进行调用，</p><ul><li>1.<code>MAIN</code>,如果当前是否是UI线程，则会进入到<code>invokeSubscriber(subscription, event);</code>方法中。否则将调用<code>mainThreadPoster.enqueue(subscription, event);</code>这个方法将交给<code>HandlerPoster.class</code>里面的<code>enqueue(Subscription subscription, Object event)</code>方法，<code>HandlerPoster.class</code>现实了该接口，移交给<code>handle</code>完成，大家可以进入<code>HandlerPoster.class</code>看看，这里就不说了。</li><li>2.<code>POSTING</code>直接调用<code>invokeSubscriber(subscription, event);</code></li><li>3.<code>MAIN_ORDERED</code>如果当前<code>mainThreadPoster</code>不为空则调用<code>mainThreadPoster.enqueue(subscription, event);</code>和<code>MAIN</code>进入<code>HandlerPoster.class</code>，反之调用<code>invokeSubscriber(subscription, event);</code></li><li>4.<code>BACKGROUND</code>如果当前是主线程，则调用<code>backgroundPoster.enqueue(subscription, event);</code>,反之调用<code>invokeSubscriber(subscription, event);</code></li><li>5.<code>ASYNC</code>,异步方法调用，执行<code>asyncPoster.enqueue(subscription, event);</code>，方法进行跟踪，该类有实现了<code>Runnable</code>接口，然后调用<code>eventBus.invokeSubscriber(pendingPost);</code>，最终将调用了<code>invoke</code>方法。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">invokeSubscriber</span><span class="params">(Subscription subscription, Object event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subscription.subscriberMethod.method.invoke(subscription.subscriber, event);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            handleSubscriberException(subscription, event, e.getCause());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Unexpected exception"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ul><p><code>invoke()</code>这是一个本地的方法，将调用C/C++的到方法进行发布。最后将进入到订阅方法中。并传递该事件到到订阅的方法中。<br>好了，这里我们将post发布事件的方法简单的分析了一下。整个EventBus的分析差不多完成了，但是，我们还有一点不能忘记就是解除绑定。接下来我们来看看解除绑定的方法。</p><ul><li>注：该方法一般生命周期的<code>onDestroy()</code>方法中进行解除绑定。<br>代码如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault().unregister(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></li></ul><p>直接进入<code>unregister(this)</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Unregisters the given subscriber from all event classes. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">unregister</span><span class="params">(Object subscriber)</span> </span>&#123;</span><br><span class="line">        List&lt;Class&lt;?&gt;&gt; subscribedTypes = typesBySubscriber.get(subscriber);</span><br><span class="line">        <span class="keyword">if</span> (subscribedTypes != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Class&lt;?&gt; eventType : subscribedTypes) &#123;</span><br><span class="line">                unsubscribeByEventType(subscriber, eventType);</span><br><span class="line">            &#125;</span><br><span class="line">            typesBySubscriber.remove(subscriber);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.log(Level.WARNING, <span class="string">"Subscriber to unregister was not registered before: "</span> + subscriber.getClass());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    /** Only updates subscriptionsByEventType, not typesBySubscriber! Caller must update typesBySubscriber. */</span><br><span class="line">    /**</span><br><span class="line">     * subscriber：指代当前解除注册的对象如Activity，</span><br><span class="line">     * eventType：发送的事件类型，post函数的实体对象class</span><br><span class="line">     */</span><br><span class="line">private void unsubscribeByEventType(Object subscriber, Class&lt;?&gt; eventType) &#123;</span><br><span class="line">  List&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType);</span><br><span class="line">  if (subscriptions != null) &#123;</span><br><span class="line">      int size = subscriptions.size();</span><br><span class="line">        for (int i = 0; i &lt; size; i++) &#123;</span><br><span class="line">            Subscription subscription = subscriptions.get(i);</span><br><span class="line">            if (subscription.subscriber == subscriber) &#123;</span><br><span class="line">                subscription.active = false;</span><br><span class="line">                subscriptions.remove(i); //删除</span><br><span class="line">                 i--;  //目的是减少遍历次数</span><br><span class="line">                size--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解除绑定，这里很简单。这里就不一一进行解释了，^_^。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1.本篇文章主要对EventBus源码进行简单的分析。主要是进行了观察者模式的一些高级运用。如果大家对观察者模式理解不怎么清楚可以进入这里看看简单的案例<a href="https://www.jianshu.com/p/4be5de46ec63" target="_blank" rel="noopener"><strong>观察者模式</strong></a>，内容非常简单。</p><p>2.相关的EvenBut的使用，请看之前的内容。如<a href="https://www.jianshu.com/p/65b677a0b5c8" target="_blank" rel="noopener"><strong>EventBus认识(一)</strong></a>、<a href="https://www.jianshu.com/p/a448a161674a" target="_blank" rel="noopener"><strong>EventBus的ThreadMode使用以及分析(二)</strong></a>等等。</p><p>3.学习本篇文章中可以认识到一些常用的类如<code>CopyOnWriteArrayList</code>、<code>ThreadLocal</code>等，到时可以深入研究一下，有助我们提高。</p><p>4.一些编程思想，设计模式值得我们去学习的，如单例模式EventBus双重校验、建造者模式，EventBus构造器的时候用到，用了初始化各个参数等等。面向接口编程而不针对实现编程。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;前面我学习了如何使用EventBus，还有了解了EventBus的特性，那么接下来我们一起来学习EventBus的源码，查看EventBus
      
    
    </summary>
    
      <category term="Android" scheme="http://eirunye.github.io/categories/Android/"/>
    
      <category term="源码解析" scheme="http://eirunye.github.io/categories/Android/%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    
    
      <category term="EventBus" scheme="http://eirunye.github.io/tags/EventBus/"/>
    
  </entry>
  
  <entry>
    <title>装饰者模式</title>
    <link href="http://eirunye.github.io/2018/10/20/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>http://eirunye.github.io/2018/10/20/装饰者模式/</id>
    <published>2018-10-20T13:45:06.000Z</published>
    <updated>2018-10-25T09:00:40.919Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="设计模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="装饰者模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="设计模式" scheme="http://eirunye.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="装饰者模式" scheme="http://eirunye.github.io/tags/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Spring-Boot-单元测试(十)</title>
    <link href="http://eirunye.github.io/2018/10/17/Spring-Boot-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-%E5%8D%81/"/>
    <id>http://eirunye.github.io/2018/10/17/Spring-Boot-单元测试-十/</id>
    <published>2018-10-16T16:25:52.000Z</published>
    <updated>2018-12-07T15:59:32.724Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Spring-Boot-JPA分页和MyBatis分页实例(八)</title>
    <link href="http://eirunye.github.io/2018/10/17/Spring-Boot-JPA%E5%88%86%E9%A1%B5%E5%92%8CMyBatis%E5%88%86%E9%A1%B5%E5%AE%9E%E4%BE%8B-%E5%85%AB/"/>
    <id>http://eirunye.github.io/2018/10/17/Spring-Boot-JPA分页和MyBatis分页实例-八/</id>
    <published>2018-10-16T16:25:05.000Z</published>
    <updated>2018-12-07T15:59:32.703Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="后台" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"/>
    
      <category term="MyBatis" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/MyBatis/"/>
    
      <category term="JPA" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/MyBatis/JPA/"/>
    
      <category term="分页" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/MyBatis/JPA/%E5%88%86%E9%A1%B5/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/tags/Spring-Boot/"/>
    
      <category term="MyBatis" scheme="http://eirunye.github.io/tags/MyBatis/"/>
    
      <category term="JPA" scheme="http://eirunye.github.io/tags/JPA/"/>
    
  </entry>
  
  <entry>
    <title>抽象工厂模式</title>
    <link href="http://eirunye.github.io/2018/10/17/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <id>http://eirunye.github.io/2018/10/17/抽象工厂模式/</id>
    <published>2018-10-16T16:23:11.000Z</published>
    <updated>2018-10-20T14:57:57.828Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="设计模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="抽象工厂模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="设计模式" scheme="http://eirunye.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="抽象工厂模式" scheme="http://eirunye.github.io/tags/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 定时器(九)</title>
    <link href="http://eirunye.github.io/2018/10/03/Spring-Boot-%E5%AE%9A%E6%97%B6%E5%99%A8-%E4%B9%9D/"/>
    <id>http://eirunye.github.io/2018/10/03/Spring-Boot-定时器-九/</id>
    <published>2018-10-03T02:35:05.000Z</published>
    <updated>2018-10-03T06:46:20.083Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>在项目中我们有时需要做定时任务，那么我们在Spring Boot项目中如何添加定时任务呢？非常简单，让我们一起学习吧。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-06639c85d05db900.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/330" alt="Spring Boot.png"></p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="主要是添加注解的方式进行"><a href="#主要是添加注解的方式进行" class="headerlink" title="主要是添加注解的方式进行"></a>主要是添加注解的方式进行</h2><p>1、在启动类<code>Application.class</code>中添加注解</p><blockquote><p>@MapperScan(“com.example.myjpa.dao”)//mybatis的注解<br> @EnableScheduling//定时器注解</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@SpringBootApplication</span><br><span class="line">@EnableScheduling</span><br><span class="line">public class MyApplication &#123;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(MyjpaApplication.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、创建<code>ScheduledTasks.class</code>做定时任务，添加注解</p><blockquote><p>@Configuration //1.主要用于标记配置类，兼备Component的效果。<br> @EnableScheduling // 2.开启定时任务</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Configuration //1.主要用于标记配置类，兼备Component的效果。</span><br><span class="line">@EnableScheduling // 2.开启定时任务</span><br><span class="line">public class ScheduledTasks &#123;</span><br><span class="line">    private static final SimpleDateFormat dateFormat = new SimpleDateFormat(&quot;HH:mm:ss&quot;);</span><br><span class="line">     //表示定时器时间定义方式</span><br><span class="line">     //@Scheduled(cron = &quot;0/5 * * * * ?&quot;)</span><br><span class="line">     //@Scheduled(fixedRate = 1000 * 60)</span><br><span class="line">    @Scheduled(cron = &quot;0 0/2 * * * ?&quot;)</span><br><span class="line">    public void configureTasks() &#123;</span><br><span class="line">        System.out.println(&quot;The time is now &quot; + dateFormat.format(new Date()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、创建config定时器配置<code>CompleteScheduleConfig.class</code>,添加注解</p><blockquote><p>@Configuration<br>@EnableScheduling</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@EnableScheduling</span><br><span class="line">public class CompleteScheduleConfig implements SchedulingConfigurer &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    StudentRepository studentRepository;</span><br><span class="line">    private static String DEFAULT_CRON = &quot;0 0/2 * * * ?&quot;;//表示间隔2分钟</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void configureTasks(ScheduledTaskRegistrar scheduledTaskRegistrar) &#123;</span><br><span class="line">//        scheduledTaskRegistrar.scheduleFixedDelayTask(new FixedDelayTask(() -&gt; &#123;</span><br><span class="line">//</span><br><span class="line">//        &#125;, 10000, 1000 * 60));</span><br><span class="line"></span><br><span class="line">        scheduledTaskRegistrar.addTriggerTask(() -&gt; &#123;</span><br><span class="line">            Student student = new Student();</span><br><span class="line">            student.setName(&quot;ok&quot;);</span><br><span class="line">            student.setAge(12);</span><br><span class="line">            student.setSex(&quot;nan&quot;);</span><br><span class="line">            studentRepository.save(student);</span><br><span class="line">            System.out.println(&quot;===插入成功!===&quot;);</span><br><span class="line">        &#125;, triggerContext -&gt; &#123;</span><br><span class="line">            return new CronTrigger(DEFAULT_CRON).nextExecutionTime(triggerContext);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>注</strong>：这个案例主要是通过定时利用JPA操作数据的方式进行代码编写案例(案例是进行每隔2分钟就插入一条数据)，在开发项目中假如数据刷新我们可以用定时任务完成、股票类数据刷新等等。所以定时任务在后台任务中也是一个重点。</li></ul><h1 id="cron表达式"><a href="#cron表达式" class="headerlink" title="cron表达式"></a>cron表达式</h1><p>大家可以进入这里测试<a href="http://cron.qqe2.com/" target="_blank" rel="noopener">cron在线表达式生成工具</a><br>本篇案例中<code>&quot;0 0/2 * * * ?&quot;</code>是表示每个2分钟运行一次。</p><h2 id="认识cron表达式"><a href="#认识cron表达式" class="headerlink" title="认识cron表达式"></a>认识cron表达式</h2><table><thead><tr><th>名词</th><th>范围</th><th>表达式</th></tr></thead><tbody><tr><td>秒</td><td>0-59</td><td><code>- * /</code></td></tr><tr><td>分</td><td>0-59</td><td><code>- * /</code></td></tr><tr><td>时</td><td>0-23</td><td><code>- * /</code></td></tr><tr><td>日期</td><td>1-31</td><td><code>- * ? / L W C</code></td></tr><tr><td>星期</td><td>1-7或者 SUN-SAT</td><td><code>- * ? / L C #</code></td></tr><tr><td>年（非必填）</td><td>1970-2099</td><td><code>- * /</code></td></tr></tbody></table><h2 id="字符解析"><a href="#字符解析" class="headerlink" title="字符解析"></a>字符解析</h2><table><thead><tr><th>表达式字符</th><th>注释</th></tr></thead><tbody><tr><td><code>?</code></td><td>表示所有值、不确定的值</td></tr><tr><td><code>,</code></td><td>表示附加数个可能的值</td></tr><tr><td><code>-</code></td><td>表示指定值的范围</td></tr><tr><td><code>/</code></td><td>表示指定从哪个值开始，然后按照哪个值进行递增，如<code>i/j</code>表示从<code>i</code>开始，每次按照<code>j</code>值进行递增</td></tr><tr><td><code>L</code>，late简写</td><td>表示在日时是这个最后一天，在周期时是表示这个月最后一个星期几</td></tr><tr><td><code>W</code> weekday简写</td><td>表示离给定日期最近的工作日(周一到周五)</td></tr><tr><td><code>#</code></td><td>表示这个月第几个周几，如：6#3表示这个月第3个周五（6表示周五，3表示的是第3个）</td></tr></tbody></table><h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><table><thead><tr><th>表达式</th><th>注解</th></tr></thead><tbody><tr><td><code>&quot;0/1000 * * * * ?&quot;</code></td><td>每1000秒执行一次</td></tr><tr><td><code>*/1000 * * * * ?</code></td><td>每隔1000秒执行一次</td></tr><tr><td><code>&quot;0 0 10 * * ?&quot;</code></td><td>每天10点整执行一次</td></tr><tr><td><code>0 0 5-15 * * ?</code></td><td>每天5-15点整点执行一次</td></tr><tr><td><code>0 0/30 9-18 * * ?</code></td><td>早上9点到下午18点工作时间内每半小时执行一次</td></tr><tr><td><code>0 0 12 ? * WED</code></td><td>每个星期三中午12点执行</td></tr><tr><td><code>0 0 18 ? * TUES,THUR,SAT</code></td><td>每周二、四、六下午6点执行一次</td></tr><tr><td><code>&quot;20,30,40 * * * * ?&quot;</code></td><td>每20秒，30秒，40秒时执行一次</td></tr><tr><td><code>&quot;0 15 10 L * ?&quot;</code></td><td>表示每个月最后一天的10点15分0秒执行一次</td></tr><tr><td><code>&quot;0 15 10 LW * ?&quot;</code></td><td>表示每个月最后一个工作日的10点15分0秒执行一次</td></tr></tbody></table><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><ul><li><a href="https://gitee.com/eirunye/SpringbootTimer" target="_blank" rel="noopener"><strong>本篇案例代码下载-码云</strong></a></li><li><a href="https://github.com/eirunye/SpringbootTimer" target="_blank" rel="noopener"><strong>本篇案例代码下载-GitHub</strong></a></li><li><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-码云</strong></a></li><li><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-GitHub</strong></a></li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本篇案例主要讲解的是在Spring Boot运用定时器，这是在我的项目中用到了，所有总结为一个模块进行案例分析，代码很简单。这里就不带大家进行单元测试了。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><ul><li><p><a href="https://eirunye.github.io"><strong>我的博客https://eirunye.github.io</strong></a>进行浏览相关技术文章，大家一起相互探讨技术。</p></li><li><p>如果大家想了解更多的Spring Boot相关博文请进入我的<a href="https://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"><strong>Spring Boot系列博客栈</strong></a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;在项目中我们有时需要做定时任务，那么我们在Spring Boot项目中如何添加定时任务呢？非常简单，让我们一起学习吧。&lt;/p&gt;
&lt;p&gt;&lt;im
      
    
    </summary>
    
      <category term="后台" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"/>
    
      <category term="定时器" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/%E5%AE%9A%E6%97%B6%E5%99%A8/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/tags/Spring-Boot/"/>
    
      <category term="定时器" scheme="http://eirunye.github.io/tags/%E5%AE%9A%E6%97%B6%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot MyBatis集成以及操作数据库(七)</title>
    <link href="http://eirunye.github.io/2018/10/02/Spring-Boot-MyBatis%E9%9B%86%E6%88%90%E4%BB%A5%E5%8F%8A%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93-%E4%B8%83/"/>
    <id>http://eirunye.github.io/2018/10/02/Spring-Boot-MyBatis集成以及操作数据库-七/</id>
    <published>2018-10-02T14:41:36.000Z</published>
    <updated>2018-10-11T15:06:54.063Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>我们都知道以前搭建项目的时候都是SSM(Spring+SpringMVC+MyBatis)的方式来进行的。那么我们Spring Boot项目是否也能集成MyBatis呢？进而操作数据库数据呢？答案是肯定的。<br>本篇博文主要讲解的是Spring Boot开发项目中如何集成MyBatis，MyBatis是如何用来操作数据库？带着这样的疑问我们一起来学习吧。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-06639c85d05db900.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/330" alt="Spring Boot.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-2884606ab5612d51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="mybatis-logo.png"></p><h1 id="认识MyBatis"><a href="#认识MyBatis" class="headerlink" title="认识MyBatis"></a>认识MyBatis</h1><p>MyBatis是什么？在这之前我们可能什么都不知道，我们只知道它能快速帮我们构造操作数据库数据工具。<br>那我们是怎么才能了解呢？非常简单，浏览相关技术文章快速便捷。大家在这里一定要养成好的习惯，在开发中遇到不懂的技术难题的时候，进行搜索，这个谁都会，但是如果有时间一定要进入其官网查看人家的官网，毕竟官网都是有浅入神，原理理解起来简单，但是要求其英语要好点，不然有点吃力。所以还是建议大家多读英语，多看官方文档。<br><a href="http://www.mybatis.org/mybatis-3/" target="_blank" rel="noopener">MyBatis官方文档</a>在这里。</p><p><strong>1.什么是 MyBatis ?</strong></p><blockquote><p>(原)MyBatis is a first class persistence framework with support for custom SQL, stored procedures and advanced mappings.<br>    MyBatis eliminates almost all of theJDBC code and manual setting of parameters and retrieval of results.<br>    MyBatis can use simple XML or Annotations for configuration and map primitives, Mapinterfaces and Java POJOs (Plain Old Java Objects) to database records.</p></blockquote><blockquote><p>(译)MyBatis 是一款优秀的持久层框架，它支持定制化 SQL、存储过程以及高级映射。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p></blockquote><p>好了，我们大概了解了一下MyBatis，那我们就从最简单的开始吧。</p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p>我们需要在我们的Spring Boot项目集成MyBatis，所以现在我们就开始进行集成MyBatis到我们项目中吧。</p><h2 id="在Maven创建的项目进行配置"><a href="#在Maven创建的项目进行配置" class="headerlink" title="在Maven创建的项目进行配置"></a>在<code>Maven</code>创建的项目进行配置</h2><p>1.打开<code>pom.xml</code>添加依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p><h2 id="在Gradle创建的项目进行配置"><a href="#在Gradle创建的项目进行配置" class="headerlink" title="在Gradle创建的项目进行配置"></a>在<code>Gradle</code>创建的项目进行配置</h2><p>添加依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h2 id="或者jar包引入"><a href="#或者jar包引入" class="headerlink" title="或者jar包引入"></a>或者jar包引入</h2><p>在这里<a href="https://github.com/mybatis/mybatis-3/releases" target="_blank" rel="noopener">下载jar包</a>，然后添加在Lib目录下然后添加配置</p><h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>由于我们经常需要到封装Json数据访问输出，所以这里我创建了一个comment-module依赖包，每次每个公共类或者是一些Utils包，封装在其里面，这样每个项目都可以进行引用了。不在module如创建情况这里：<a href="">创建module方式</a></p><h1 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h1><p><strong>1.创建文件</strong></p><pre><code class="JAVA"></code></pre><p><strong>2.创建mapper</strong></p><p><strong>3.添加注解</strong></p><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p><strong>1.单元测试</strong></p><ul><li><strong>注：</strong>这里不进行Posman请求测试了，大家到时自行测试，等我们讲解该篇完成后会进行单元测试重点分析。</li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1.本篇文章我们学习了Spring Boot项目如何集成MyBatis，并且进行了了数据库的基本操作。</p><p>2.相关的配置文件还有操作的xml文件，创建步骤，大家要记住。</p><p>3.接下来我们将深入分析MyBatis在项目中常用的功能如：分页查询等操作。</p><p>4.后期的文章将会深入解析MyBatis高级使用、利用IDEA重定向自动生成xml配置文件等等。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><ul><li><p><a href="https://eirunye.github.io"><strong>我的博客https://eirunye.github.io</strong></a>进行浏览相关技术文章，大家一起相互探讨技术。</p></li><li><p>如果大家想了解更多的Spring Boot相关博文请进入我的<a href="https://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"><strong>Spring Boot系列博客栈</strong></a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;我们都知道以前搭建项目的时候都是SSM(Spring+SpringMVC+MyBatis)的方式来进行的。那么我们Spring Boot项目
      
    
    </summary>
    
      <category term="后台" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"/>
    
      <category term="MyBatis" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/MyBatis/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/tags/Spring-Boot/"/>
    
      <category term="MyBatis" scheme="http://eirunye.github.io/tags/MyBatis/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot JPA操作数据(六)</title>
    <link href="http://eirunye.github.io/2018/09/29/Spring-Boot-JPA%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE-%E5%85%AD/"/>
    <id>http://eirunye.github.io/2018/09/29/Spring-Boot-JPA操作数据-六/</id>
    <published>2018-09-29T12:54:35.000Z</published>
    <updated>2018-10-02T14:43:17.851Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>在Spring Boot项目开发中，我们操作数据库的时候一般会用到<code>JPA</code>或者是<code>MyBatis</code>框架，今天所要将的是<code>JPA</code>操作数据库案例。后续会说到<code>MyBatis</code>操作数据。大家在开发的时候，看看自己对哪个比较熟练或者是公司项目的需要来选择，上篇我们已经说了Spring Boot如何连接数据库,我们紧跟着上篇<a href="https://eirunye.github.io/2018/09/19/Spring-Boot-%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93-%E4%BA%94/#more">Spring Boot 连接数据库(五)</a>的内容来进行操作。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-06639c85d05db900.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/330" alt="Spring Boot.png"></p><h1 id="认识JPA"><a href="#认识JPA" class="headerlink" title="认识JPA"></a>认识JPA</h1><p>首先我们在遇到一个新的知识的时候，官方技术文档将是我们最好的帮手，或者是网上查询相关技术支持博文。进入<a href="http://projects.spring.io/spring-data-jpa/" target="_blank" rel="noopener">JPA官方文档</a>学习吧。</p><p>什么是JPA?</p><blockquote><p>Spring Data JPA, part of the larger <a href="http://projects.spring.io/spring-data" target="_blank" rel="noopener">Spring Data family</a> , makes it easy to easily implement JPA based repositories. This module deals with enhanced support for JPA based data access layers. It makes it easier to build Spring-powered applications that use data access technologies.<br>Spring Data JPA aims to significantly improve the implementation of data access layers by reducing the effort to the amount that’s actually needed.</p></blockquote><p>翻译如下：</p><blockquote><p>Spring Data JPA是更大的<a href="http://projects.spring.io/spring-data" target="_blank" rel="noopener">Spring Data系列</a>的一部分，可以轻松实现基于JPA的存储库。 此模块处理对基于JPA的数据访问层的增强支持。 它使构建使用数据访问技术的Spring驱动应用程序变得更加容易。<br>Spring Data JPA旨在通过减少实际需要的工作量来显着改善数据访问层的实现</p></blockquote><p>JPA有什么特性？</p><ul><li>基于Spring和JPA构建存储库的复杂支持</li><li>支持<code>Querydsl</code>术语，从而支持类型安全的JPA查询</li><li>透明审核域名类</li><li>分页支持，动态查询执行，集成自定义数据访问代码的能力</li><li>在引用时可通过<code>@Query</code>带注释的自定义查询</li><li>支持基于XML的实体映射</li><li>基于JavaConfig的存储库配置，介绍<code>@EnableJpaRepositories</code></li></ul><p>配置JPA要求</p><ul><li>JAVA 8或者更高</li><li><a href="http://www.gradle.org/downloads" target="_blank" rel="noopener">Gradle 4+</a> or <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">Maven 3.2+</a></li></ul><p>在Spring Boot中通过JPA来进行操作数据库是非常简便的，并且我们也可以自定义SQL语句，而在满足我们项目的条件下不需要进行书写过多的SQL语句，这能很大程度解决我们的开发效率。</p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><ul><li><strong>注</strong>：本案例选择的开发工具<a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">IntelliJ IDEA</a></li></ul><p>Spring Boot项目是如何进行配置<code>JPA</code>呢？这里我用的是<code>Mevan</code>和<code>Gradle</code>两种方式进行项目的配置来创建Spring Boot项目，但是在本案例开发提供代码是通过<code>Mavan</code>进行的，后期会补充<code>Gradle</code>的案例代码。</p><h2 id="Maven配置"><a href="#Maven配置" class="headerlink" title="Maven配置"></a>Maven配置</h2><p><strong>1.添加JPA maven依赖库</strong></p><p>在<code>pom.xml</code>添加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;!--mysql依赖--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;8.0.11&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;!--JPA依赖--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure><ul><li><strong>注</strong>：这里因为要操作数据，所以需要添加数据库依赖，如<code>MySQL</code></li></ul><p><strong>2.在<code>application.yml</code>配置文件中进行配置(推荐)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">    driver-class-name: com.mysql.cj.jdbc.Driver  # MySql jdbc Driver</span><br><span class="line">    # 连接数据库</span><br><span class="line">    # eirunye_springboot_notes表示的是你创建的数据库;</span><br><span class="line">    # useSSL:是否使用SSL证书验证;</span><br><span class="line">    # characterEncoding:编码格式;</span><br><span class="line">    # useJDBCCompliantTimezoneShift:是否使用符合JDBC的时区转换;</span><br><span class="line">    # useLegacyDatetimeCode:是否使用旧版日期时间码;</span><br><span class="line">    # serverTimezone:选择服务器时间方式;</span><br><span class="line">    url: jdbc:mysql://127.0.0.1:3306/eirunye_springboot_notes?useSSL=false&amp;requireSSL=false&amp;characterEncoding=UTF-8&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC</span><br><span class="line">    username: root   #本地设置数据库账号</span><br><span class="line">    password: 123456 #密码</span><br><span class="line">  jpa:</span><br><span class="line">    hibernate:</span><br><span class="line">      ddl-auto: update</span><br><span class="line">    show-sql: true</span><br><span class="line">server:</span><br><span class="line">  port: 8090 #访问端口</span><br></pre></td></tr></table></figure></p><ul><li><strong>注</strong> <code>spring.jpa.hibernate.ddl-auto</code>配置的属性解释：<ul><li>create：每次启动该程序，没有表的会新建表，表内有数据都会清空，结束时，并未清空表</li><li>create-drop：每次启动、结束程序的时都会清空表，而且启动时会重新创建表，</li><li>update：每次启动程序时，没有表的会创建表，表不会清空，检查表字段是否相同，不同则更新，</li><li>validate：每次启动程序时，校验数据与表(字段、类型等)是否相同，不同会报错</li><li>none：在所有其他情况下，默认为none，这里选择update</li></ul></li></ul><p>在<code>application.properties</code>配置文件中进行配置</p><ul><li><strong>注</strong>：<code>.yml</code>和<code>.properties</code>选择其一</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server.port=8090</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver  # MySql jdbc Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/eirunye_springboot_notes?useSSL=false&amp;requireSSL=false&amp;characterEncoding=UTF-8&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC</span><br><span class="line">spring.datasource.data-username=root</span><br><span class="line">spring.datasource.data-password=123456</span><br><span class="line">spring.jpa.hibernate.ddl-auto=update</span><br><span class="line">spring.jpa.show-sql=true</span><br></pre></td></tr></table></figure><h2 id="Gradle配置"><a href="#Gradle配置" class="headerlink" title="Gradle配置"></a>Gradle配置</h2><p><strong>1.在<code>build.gradle</code>添加依赖</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    //注：Android 的Gradle依赖已经改为implementation</span><br><span class="line">    compile(&quot;org.springframework.boot:spring-boot-starter-data-jpa&quot;)   //添加jpa依赖</span><br><span class="line">    compile (&quot;mysql:mysql-connector-java:5.1.24&quot;) //添加MySQL依赖</span><br><span class="line">    compile(&quot;com.h2database:h2&quot;)</span><br><span class="line">    testCompile(&quot;junit:junit&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>2.在<code>.yml</code>或者<code>.properties</code>配置文件中进行配置和上面的<code>Maven</code>一样。</p><h1 id="JPA操作数据"><a href="#JPA操作数据" class="headerlink" title="JPA操作数据"></a>JPA操作数据</h1><ul><li><strong>注</strong>：在这里简单的举例说明JPA的使用，在系列文章会更加深入讲关于JPA的使用，在这里的代码创建到是按照<a href="https://eirunye.github.io/2018/08/22/Spring-Boot-%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA-%E5%9B%9B/#more">Spring Boot 项目如何搭建(四)</a>项目包层级定义来创建的，所以大家不清楚就再去看看，或者下载本例代码查看就明白了。</li></ul><p><strong>1.在<code>.bean</code>包下创建实体<code>User.class</code></strong></p><ul><li><strong>注</strong>：这里添加注解的位置如果选择在属性上面添加的话就全部都选择在属性上面添加，本例的<code>User.class</code>,如果选择在get方法上面添加，那么全部都在get方法上面添加注解，不然有时可能获取不到数据，或者其他错误。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.AUTO)</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"username"</span>,columnDefinition = <span class="string">"VARCHAR(50) NOT NULL COMMENT '用户名不为空!'"</span>,unique = <span class="keyword">true</span>)</span><br><span class="line">    <span class="meta">@NotBlank</span>(message = <span class="string">"username can't be null"</span>)</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"password"</span>,columnDefinition = <span class="string">"VARCHAR(50) NOT NULL COMMENT '密码不为空!'"</span>)</span><br><span class="line">    <span class="meta">@NotBlank</span>(message = <span class="string">"password can't be null"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Temporal</span>(TemporalType.DATE)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"create_time"</span>, columnDefinition = <span class="string">"datetime DEFAULT NULL COMMENT '创建时间'"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date createTime; <span class="comment">//创建时间</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Temporal</span>(TemporalType.DATE)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"update_time"</span>, columnDefinition = <span class="string">"datetime DEFAULT NULL COMMENT '更新时间'"</span>)</span><br><span class="line">    <span class="keyword">private</span> Date updateTime;<span class="comment">//更新时间</span></span><br><span class="line"><span class="comment">// get/set方法   注：Lombok插件可以直接构建get、set方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>实体注解解释(这里讲解的是常用的)</strong></li></ul><table><thead><tr><th>注解源</th><th>解释说明</th></tr></thead><tbody><tr><td>@Entity</td><td>JPA实体映射到数据库</td></tr><tr><td>@Table</td><td>表示表，<code>@Table(name = &quot;user&quot;)</code>表示该实体生成的表是<code>user</code><br><code>@Table</code>还有几个属性，如<code>catalog</code>：对应数据库的<code>catalog</code>，<code>schema</code>：对应数据库的<code>schema</code>，<code>UniqueConstraint</code>定义在<code>@Table</code>或<code>@SecondaryTable</code>元数据里，用来指定建表时需要建唯一约束的列等</td></tr><tr><td>@Id</td><td>表示主键Id</td></tr><tr><td>@GeneratedValue</td><td><code>@GeneratedValue(strategy = GenerationType.AUTO)</code>表示Id自增</td></tr><tr><td>@Column</td><td><code>name = &quot;username&quot;</code>表示表的字段名为<code>username</code>，<code>columnDefinition</code>表示字段创建的SQL语句说明，第一次创建时生效，<code>unique=true</code>表示该字段的值在表中是唯一的(如：用户名不能相同)</td></tr><tr><td>@NotBlank</td><td><code>@NotBlank(message = &quot;password can&#39;t be null&quot;)</code>解释说明</td></tr><tr><td>@Temporal</td><td><code>@Temporal(TemporalType.DATE)</code>表示时间的定义格式为：<code>yyyy-MM-dd 即：2018-09-01</code>，<code>TemporalType.TIME</code>表示为：<code>hh:mm:ss 即 10:12:11</code>，<code>TemporalType.TIMESTRAMP</code>表示为:<code>yyyy-mm-dd hh:mm:ss 即：2018-09-01 10:12:11</code></td></tr></tbody></table><ul><li><strong>说明</strong>：以上的实体注解解释完成了。当然了，在这里我们使用的JPA的注解只是很少的一部分，接下来的文章会详细说明相关注解的作用和使用。</li></ul><p>运行项目生成的表如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create table user</span><br><span class="line">(</span><br><span class="line">  id    int   not null primary key,</span><br><span class="line">  create_time datetime    null  comment &apos;创建时间&apos;,</span><br><span class="line">  password    varchar(50) not null   comment &apos;密码不为空!&apos;,</span><br><span class="line">  update_time datetime    null    comment &apos;更新时间&apos;,</span><br><span class="line">  username    varchar(50) not null    comment &apos;用户名不为空!&apos;,</span><br><span class="line">  constraint UK_sb8bbouer5wak8vyiiy4pf2bx</span><br><span class="line">  unique (username)</span><br><span class="line">)</span><br><span class="line">  engine = MyISAM charset = utf8;</span><br></pre></td></tr></table></figure></p><p><strong>2.在<code>.controller</code>包下创建<code>UserController.class</code></strong><br>这里代码的就是测试增删改查，这里的注解之前的文章都解释过了，这里就不解释了，遇到最新的就解释。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过id查找user信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 参数id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回Json user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"/info/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;User&gt; <span class="title">getUserDataById</span><span class="params">(@PathVariable Integer id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == id) <span class="keyword">throw</span> <span class="keyword">new</span> EirunyeException(ResultEnum.UNKNOWN_ERROR);<span class="comment">//这里定义自己的提示错误信息,最好每个都有定义这样比较明确错误!!!</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userService.getUserDataById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/info/save"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;User&gt; <span class="title">saveUserData</span><span class="params">(@Valid User user)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == user) <span class="keyword">throw</span> <span class="keyword">new</span> EirunyeException(ResultEnum.UNKNOWN_ERROR);<span class="comment">//这里定义自己的提示错误信息,最好每个都有定义这样比较明确错误!!!</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userService.saveUserData(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新user信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回提示 更新失败或者成功</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception 异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/info/update"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;String&gt; <span class="title">updateUserInfo</span><span class="params">(@Valid User user)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == user) <span class="keyword">throw</span> <span class="keyword">new</span> EirunyeException(ResultEnum.UNKNOWN_ERROR);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userService.updateUserInfo(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过ID参数user信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 参数id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回提示 参数成功或者失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(value = <span class="string">"info/delete/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;String&gt; <span class="title">deleteUserInfo</span><span class="params">(@PathVariable Integer id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == id) <span class="keyword">throw</span> <span class="keyword">new</span> EirunyeException(ResultEnum.UNKNOWN_ERROR);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userService.deleteUserInfo(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3.在<code>.service</code>包下创建<code>UserService.class</code></strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Json user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception 异常抛出</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;User&gt; <span class="title">saveUserData</span><span class="params">(User user)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        User user1 = userRepository.save(user);</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.getResult(ResultEnum.SUCCESS, user1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id来获取user信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 参数id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Json user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;User&gt; <span class="title">getUserDataById</span><span class="params">(Integer id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        User user = userRepository.findAllById(id);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == user) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EirunyeException(ResultEnum.USERNOTEXIST);<span class="comment">//用户不存在</span></span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> ResultUtil.getResult(ResultEnum.SUCCESS, user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新user信息 更新数据说明：</span></span><br><span class="line"><span class="comment">     * 1.如果通过save(S s)方法的话必须带主键Id，这样通过主键id就能更新数据了，</span></span><br><span class="line"><span class="comment">     * 如果不带参数id则，数据将会自增一条数据（变成插入数据了）</span></span><br><span class="line"><span class="comment">     * 2.自定义SQL语句更新数据（后面会讲到）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user 参数user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> json String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;String&gt; <span class="title">updateUserInfo</span><span class="params">(User user)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == user.getId()) <span class="keyword">return</span> ResultUtil.error(-<span class="number">1</span>, <span class="string">"Id不能为空!"</span>);</span><br><span class="line">        <span class="comment">//更新数据</span></span><br><span class="line">        User userUpdate = userRepository.save(user);</span><br><span class="line">        <span class="keyword">if</span> (userUpdate == <span class="keyword">null</span>) <span class="keyword">return</span> ResultUtil.error(-<span class="number">1</span>, <span class="string">"数据更新失败,请联系后台!"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 一般更新数据步骤：</span></span><br><span class="line">        <span class="comment">// 1.通过ID获取当前用户信息</span></span><br><span class="line">        <span class="comment">// 2.将所需更新的信息进行设置，如用户名、密码等，而创建时间不需要更新</span></span><br><span class="line">        <span class="comment">// 3.如果没有其他特殊字段直接save方法更新(注：这里我就简单直接save了，大家的项目应该是下面这样方式写)</span></span><br><span class="line">        <span class="comment">//User userInfo = userRepository.findAllById(user.getId());</span></span><br><span class="line">        <span class="comment">//userInfo.setId(user.getId());</span></span><br><span class="line">        <span class="comment">//userInfo.setUsername(user.getUsername());</span></span><br><span class="line">        <span class="comment">//userInfo.setPassword(user.getPassword());</span></span><br><span class="line">        <span class="comment">//userInfo.setUpdateTime(new Date());</span></span><br><span class="line">        <span class="comment">//userInfo.setCreateTime(new Date()); //这个不需要设置</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ResultUtil.getResult(ResultEnum.SUCCESS, <span class="string">"更新数据成功!!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 参数id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> json String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result&lt;String&gt; <span class="title">deleteUserInfo</span><span class="params">(Integer id)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        userRepository.deleteById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//下面不需要也可以，直接返回return ResultUtil.getResult(ResultEnum.SUCCESS, "删除数据成功!!!");</span></span><br><span class="line">        User user = userRepository.findAllById(id);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == user) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EirunyeException(ResultEnum.SUCCESS);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> ResultUtil.error(-<span class="number">1</span>, <span class="string">"删除数据失败!!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4.在<code>.repository</code>创建<code>UserRepository</code>接口去扩展<code>JpaRepository&lt;T,ID&gt;</code></strong></p><ul><li><strong>注：</strong><code>JpaRepository&lt;T,ID&gt;</code>一般<code>T</code>是要操作的实体，如本例的<code>User.class</code>,<code>ID</code>是该实体<code>ID</code>类型，如本例定义<code>id</code>为<code>Integer</code>，如果你自己定义<code>Long</code>这里就表示<code>Long</code>。在<code>UserRepository</code>接口这里需要注意的是命名规则查找find，删除delete等等</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 根据id获取当前user数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">findAllById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过用户名和密码来获取用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username 参数用户名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password 参数密码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">findAllByUsernameAndPassword</span><span class="params">(String username, String password)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模糊查询 自定义查询语句</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Query</span>(value = <span class="string">"select * from user u where u.username like %:username%"</span>,nativeQuery=<span class="keyword">true</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAllByUsername</span><span class="params">(@Param(<span class="string">"username"</span>)</span> String username)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>注：</strong> JPA的自定义语句都是<code>@Query(value=&quot;SQL语句&quot;)</code>，下面的方法还是要按照<code>JpaRepository</code>命名规则进行，后面的文章将会说明该内容。</li></ul><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><h2 id="新建单元测试"><a href="#新建单元测试" class="headerlink" title="新建单元测试"></a>新建单元测试</h2><p>在<code>src\test\java\com\eirunye\spring_boot_jpa\</code>创建<code>UserTest.class</code>,这里只是简单的进行单元测试，之后文章会讲解到Spring Boot项目如何进行单元测试。<br>测试代码<a href="">UserTest.class</a>进行查看，这里只贴一些</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger logger = LoggerFactory.getLogger(ExceptionHandle.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserInfo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Result&lt;User&gt; userDataById = userService.getUserDataById(<span class="number">1</span>);</span><br><span class="line">        logger.info(userDataById.getData().toString());</span><br><span class="line">        System.out.println(userDataById.getData().toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span>   <span class="comment">//@Before是在这个测试类中点击每个@Test都会执行的注解，在`@Test`之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveUserInfo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">"Eirunye"</span>);</span><br><span class="line">        user.setPassword(<span class="string">"123456"</span>);</span><br><span class="line">        user.setCreateTime(<span class="keyword">new</span> Date());<span class="comment">//这里只做测试用，一般都是后台处理时间</span></span><br><span class="line">        user.setUpdateTime(<span class="keyword">new</span> Date());<span class="comment">//这里只做测试用，一般都是后台处理时间</span></span><br><span class="line">        System.out.println(user.toString());</span><br><span class="line">        Result&lt;User&gt; userResult = userService.saveUserData(user);</span><br><span class="line">        System.out.println(userResult);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>测试验证</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-1c3819e79d92f6c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="测试成功.png"></p><ul><li>测试id输入错误时，如：<code>userService.getUserDataById(0);</code></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-93c5fe9857f5105a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="id输入错误异常.png"></p><ul><li>查看数据库</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-52542b233017f778.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="查看数据库.png"></p><h2 id="IDEA请求数据测试"><a href="#IDEA请求数据测试" class="headerlink" title="IDEA请求数据测试"></a>IDEA请求数据测试</h2><p>这里只列举一个，大家进测试就好了。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-052340583d4a039b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="idea请求数据.png"></p><h2 id="Postman请求数据测试"><a href="#Postman请求数据测试" class="headerlink" title="Postman请求数据测试"></a>Postman请求数据测试</h2><p>这里只列举一个，大家进测试就好了。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-fa289ee37e9419af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="Postman请求数据.png"></p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><ul><li><a href="https://github.com/eirunye/SpringBoot_database_connection" target="_blank" rel="noopener"><strong>本篇案例代码下载-码云</strong></a></li><li><a href="https://github.com/eirunye/Spring_Boot_JPA" target="_blank" rel="noopener"><strong>本篇案例代码下载-GitHub</strong></a></li><li><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-码云</strong></a></li><li><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-GitHub</strong></a></li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1.本篇文章主要讲解的是JPA与Spring Boot整合操作数据，只是简单的说明JPA的增删改查功能，接下来的文章会深入研究JPA的更多内容，如：JPA的多表操作如何使用、JPA分页操作等等。</p><p>2.JPA在项目中使用能使我们快速构建项目，不需要书写过多的SQL语句(相信这是大家都非常喜欢的)</p><p>3.前文开始的时候说了JPA一些特性。</p><p>4.Android平台上的GreenDao的使用方式和JPA是非常相似的</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><p>如果大家想了解更多的Spring Boot相关博文请进入<br>我的<a href="https://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"><strong>Spring Boot系列博客栈</strong></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;在Spring Boot项目开发中，我们操作数据库的时候一般会用到&lt;code&gt;JPA&lt;/code&gt;或者是&lt;code&gt;MyBatis&lt;/cod
      
    
    </summary>
    
      <category term="后台" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"/>
    
      <category term="JPA" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/JPA/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/tags/Spring-Boot/"/>
    
      <category term="JPA" scheme="http://eirunye.github.io/tags/JPA/"/>
    
  </entry>
  
  <entry>
    <title>简单工厂模式</title>
    <link href="http://eirunye.github.io/2018/09/26/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <id>http://eirunye.github.io/2018/09/26/简单工厂模式/</id>
    <published>2018-09-26T03:15:11.000Z</published>
    <updated>2018-09-26T07:47:49.101Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>1.学习本篇文章，了解简单工厂设计模式的使用场景。<br>2.如何使用简单工厂模式。<br>3.简单工厂模式能解决什么问题？回到优缺点。</p><h1 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h1><p>现在有一家外卖小店需要从生产一份外卖开始进行考虑设计，当客户在网上点出不同味道的菜时，外卖小店就将按照不同的订单进行生产出菜品，然后进行打包、等待外卖小哥获取、赠送给客户等不同的几道工序，才算完成一单，但是后期由于生意很好，客户评价很高，有些地方的老板想加盟本店了，那么可能就会出现不同味道的菜单，还有一些本地的特色菜也会加上菜单，这时，客户就能点到更多的菜品了，为了达到某些商家快速而且合理的进行管理，你是怎么设计这个方案的呢？</p><h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p>一般情况下客户点餐的时候，都会查看平分高低，还有出货次数，如果人气好的，肯定要大量生产，而没有人点的，则可以考虑去除，所以我们通过以上的考虑，需要封装创建对象的代码，如将生产商品的对象封装起来，这样，我们出掉或者添加的时候，都只修改这部分的代码，那么是哪个生产商品呢？答案肯定是店家了，所以我们称这个生产商品的店家为“工厂”。<br>接下来我们进行分析以上代码该如何展现出来呢？我们将通过两种方式来进行编写。</p><h2 id="静态工厂模式"><a href="#静态工厂模式" class="headerlink" title="静态工厂模式"></a>静态工厂模式</h2><p>如何实现呢？我们先来看看本例的类图</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-407ecb6ca3265939.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="static_factory.png"></p><p>1.创建一个美食店，<code>MealStore.class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/19.</span></span><br><span class="line"><span class="comment"> * Describe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MealStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Meal <span class="title">submitOrderMeal</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Meal meal;</span><br><span class="line">        <span class="comment">//利用静态工厂方法生成产品</span></span><br><span class="line">        <span class="comment">//重点(静态工厂实现代码)</span></span><br><span class="line">        meal = SimpleMealsFactory.createMeal(type);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//以下方法是进行一些设计而已不是静态工厂方法的模块，是产品的一些操作而已，无关紧要的</span></span><br><span class="line">        <span class="comment">//店家准备中...</span></span><br><span class="line">        meal.mealPreparation();</span><br><span class="line">        <span class="comment">//打包</span></span><br><span class="line">        meal.bake();</span><br><span class="line">        <span class="comment">//获取</span></span><br><span class="line">        meal.getMeal();</span><br><span class="line">        <span class="comment">//配送</span></span><br><span class="line">        meal.send();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> meal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.创建一个静态工厂<code>SimpleMealsFactory.class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/18.</span></span><br><span class="line"><span class="comment"> * Describe 建立一个简单静态工厂，该工厂生产不同的菜品（美食）</span></span><br><span class="line"><span class="comment"> * Tip: 提示：这是不是我们经常使用的Util类的编写方式?</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleMealsFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将生产产品（美食放在这里）</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Meal <span class="title">createMeal</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Meal meal = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"crayfish"</span>.equals(type)) &#123;</span><br><span class="line">            meal = <span class="keyword">new</span> CrayfishMeal(); <span class="comment">//创建什么类型的产品(美食)让子类来操作</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"roastChicken"</span>.equals(type)) &#123;</span><br><span class="line">            meal = <span class="keyword">new</span> RoastChicken();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"A"</span>.equals(type)) &#123;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"B"</span>.equals(type)) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">return</span> meal; <span class="comment">//返回的是美食商品</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.创建产品美食抽象基类<code>Meal.class</code>,这样的话我们就可以交给子类来完成商品的生产。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/19.</span></span><br><span class="line"><span class="comment"> * Describe  定义一个抽象产品接口、这里也可以是抽象类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> List mealInfo = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mealPreparation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"您的商品准备中..."</span>+<span class="keyword">this</span>.name);</span><br><span class="line">        System.out.println(<span class="string">"adding material..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"adding  condiment..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"adding mealInfo..."</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = mealInfo.size(); i &lt; len; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">" ["</span> + mealInfo.get(i) + <span class="string">"]"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"进行打包,只需1分钟就能打包完成!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMeal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"外卖小哥获取美食,外卖小哥可能需要花费1~20分钟来获取美食!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"配送给客户,配送需要大概5~40分钟送达!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.这里模拟具体产品，必须去实现<code>Meal</code>接口或者去派生该抽象类，如下小龙虾美食:<code>CrayfishMeal.class</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/19.</span></span><br><span class="line"><span class="comment"> * Describe 模拟产品(具体的美食--小龙虾)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrayfishMeal</span> <span class="keyword">extends</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CrayfishMeal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        setName(<span class="string">"香辣小龙虾....."</span>);</span><br><span class="line">        setMaterial(<span class="string">"添加5份小龙虾..."</span>);</span><br><span class="line">        setCondiment(<span class="string">"添加适量的调味品..."</span>);</span><br><span class="line">        mealInfo.add(<span class="string">"生成可口的小龙虾..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/19.</span></span><br><span class="line"><span class="comment"> * Describe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建一个工厂类（即商品总店）</span></span><br><span class="line">        MealStore mealStore = <span class="keyword">new</span> MealStore();</span><br><span class="line">       <span class="comment">//这里我们要传递在静态工厂实例定义的字符串，否则将报空指针。</span></span><br><span class="line">        mealStore.submitOrderMeal(<span class="string">"roastChicken"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files\Java\jdk1.8.0_161\bin\java&quot;...</span><br><span class="line"></span><br><span class="line">您的商品准备中...烧鸡.....</span><br><span class="line">adding material...</span><br><span class="line">adding  condiment...</span><br><span class="line">adding mealInfo...</span><br><span class="line"> [生成可口的烧鸡...]</span><br><span class="line">进行打包,只需1分钟就能打包完成!</span><br><span class="line">外卖小哥获取美食,外卖小哥可能需要花费1~20分钟来获取美食!</span><br><span class="line">配送给客户,配送需要大概5~40分钟送达!</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure><ul><li>注：<br>首先我们将生产商品创建放在了静态工厂中，静态工厂处理对象创建的细节，MealStore 美食店只关心如何得到美食商品就可以了，并进行打包、获取、派送等操作，而这样操作起来方便了产品的创建了。</li></ul><h2 id="简单工厂方法"><a href="#简单工厂方法" class="headerlink" title="简单工厂方法"></a>简单工厂方法</h2><p>我们通过静态工厂方法的方式实现了该功能，但是，是否有更好的封装方式呢？接下来我们来分析一下吧。本例类图关系</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-e55e00c647bcdb6d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="funtion_factory.png"></p><p>1.现在我们将<code>MealStore.class</code>,修改为抽象类，并且将生产商品的方法也修改为抽象方法，我们这样做的目的，为什么呢？<br>我们这样做是让各个分店子类来实现商品的生产，扩展性更高，封装性更加完善，而该抽象类并不知道是哪个子类来完成商品的创建，达到了耦合。代码如下:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/18.</span></span><br><span class="line"><span class="comment"> * Describe 抽象工厂基类 美食总店</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MealStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 客户下单</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type 选择什么样的美食</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 美食 Meal</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Meal <span class="title">submitOrderMeal</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Meal meal;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//这里是我们将生产的美食</span></span><br><span class="line">        meal = createMeal(type);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//店家准备中...</span></span><br><span class="line">        meal.mealPreparation();</span><br><span class="line">        <span class="comment">//打包</span></span><br><span class="line">        meal.bake();</span><br><span class="line">        <span class="comment">//获取</span></span><br><span class="line">        meal.getMeal();</span><br><span class="line">        <span class="comment">//配送</span></span><br><span class="line">        meal.send();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> meal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//实现抽象的工厂方法，让每个分店来完成此生产操作，</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> Meal <span class="title">createMeal</span><span class="params">(String type)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.创建分店子类<code>JiangNanMealStore .class</code>派生自<code>MealStore.class</code>,进行生产商品</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/18.</span></span><br><span class="line"><span class="comment"> * Describe  JiangNanMealStore分店,这里是需要增加修改的地方，可能有新的菜品的时候就在这里增加或者删除***</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JiangNanMealStore</span> <span class="keyword">extends</span> <span class="title">MealStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Meal <span class="title">createMeal</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getMeal(type);</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//让子类来创建产品</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Meal <span class="title">getMeal</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"crayfish"</span>.equals(type)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> CrayfishMeal();<span class="comment">//小龙虾</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"roastDuck"</span>.equals(type)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> RoastDuckMeal();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.创建商品抽象基类<code>Meal.class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/18.</span></span><br><span class="line"><span class="comment"> * Describe 抽象产品父类 美食抽象类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> List mealInfo = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mealPreparation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"您的商品准备中..."</span>+<span class="keyword">this</span>.name);</span><br><span class="line">        System.out.println(<span class="string">"adding material..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"adding  condiment..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"adding mealInfo..."</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, len = mealInfo.size(); i &lt; len; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">" ["</span> + mealInfo.get(i) + <span class="string">"]"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"进行打包,只需1分钟就能打包完成!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMeal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"外卖小哥获取美食,外卖小哥可能需要花费1~20分钟来获取美食!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"配送给客户,配送需要大概5~40分钟送达!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.定义具体子类<code>CrayfishMeal.class</code>产品，扩展自<code>Meal .class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/18.</span></span><br><span class="line"><span class="comment"> * Describe 具体产品 小龙虾美食</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrayfishMeal</span> <span class="keyword">extends</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CrayfishMeal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        setName(<span class="string">"可口的小龙虾....."</span>);</span><br><span class="line">        setMaterial(<span class="string">"添加几份小龙虾+一些材料..."</span>);</span><br><span class="line">        setCondiment(<span class="string">"添加适量的调味品..."</span>);</span><br><span class="line">        mealInfo.add(<span class="string">"生成可口的小龙虾..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//这里重写了父类的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"小龙虾分成5份打包!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author Eirunye</span></span><br><span class="line"><span class="comment"> * Created by on 2018/9/18.</span></span><br><span class="line"><span class="comment"> * Describe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MealStore jiangNanMealStore = <span class="keyword">new</span> JiangNanMealStore();</span><br><span class="line">        jiangNanMealStore.submitOrderMeal(<span class="string">"crayfish"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"江南店完成一单"</span>);</span><br><span class="line">        System.out.println(<span class="string">"==============================\n"</span>);</span><br><span class="line"></span><br><span class="line">        MealStore guangDongMealStore = <span class="keyword">new</span> GuangDongMealStore();</span><br><span class="line">        guangDongMealStore.submitOrderMeal(<span class="string">"roastDuck"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"广东店完成一单"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files\Java\jdk1.8.0_161\bin\java&quot;...</span><br><span class="line">您的商品准备中...可口的小龙虾.....</span><br><span class="line">adding material...</span><br><span class="line">adding  condiment...</span><br><span class="line">adding mealInfo...</span><br><span class="line"> [生成可口的小龙虾...]</span><br><span class="line">小龙虾分成5粉打包!</span><br><span class="line">外卖小哥获取美食,外卖小哥可能需要花费1~20分钟来获取美食!</span><br><span class="line">配送给客户,配送需要大概5~40分钟送达!</span><br><span class="line">江南店完成一单</span><br><span class="line">==============================</span><br><span class="line"></span><br><span class="line">您的商品准备中...江南烤鸭.....</span><br><span class="line">adding material...</span><br><span class="line">adding  condiment...</span><br><span class="line">adding mealInfo...</span><br><span class="line"> [生成可口的烤鸭...]</span><br><span class="line">进行打包,只需1分钟就能打包完成!</span><br><span class="line">外卖小哥获取美食,外卖小哥可能需要花费1~20分钟来获取美食!</span><br><span class="line">配送给客户,配送需要大概5~40分钟送达!</span><br><span class="line">广东店完成一单</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p><a href="https://gitee.com/eirunye/Simple_Factory_Pattern" target="_blank" rel="noopener"><strong>本篇案例代码–码云</strong></a></p><p><a href="https://github.com/eirunye/Simple_Factory_Pattern" target="_blank" rel="noopener"><strong>本篇案例代码–GitHub</strong></a></p><p><a href="https://gitee.com/eirunye/Eirunye_DesignPatterns_Notes" target="_blank" rel="noopener"><strong>设计模式系列–码云</strong></a></p><p><a href="https://github.com/eirunye/Eirunye_DesignPatterns_Notes" target="_blank" rel="noopener"><strong>设计模式系列–GitHub</strong></a></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>我们通过简单的例子了解了简单工厂模式的开发案例。其实，简单工厂并不是我们常说的23中设计模式，他只是我们常用的一种编程习惯罢了，抽象工厂，才是我们常用的设计模式，接下来我们会讲解到抽象工厂模式。</p><p>静态工厂（简单工厂）和简单工厂方法有什么不同呢？</p><p>静态工厂将生产商品都定义在静态工厂的方法内，而简单工厂方法是交给子类来完成。但是静态工厂(简单工厂)不具备简单工厂方法所具有的扩展性强。<br>简单工厂方法的子类将会出现大量相同的代码，但是同时它也可以重写分类的方法，完成自己定义操作。</p><p>在Android中也常用到静态工厂或者是工厂方法等编程设计思路，如AnimationUtils类获取的各个子类的动画，BitmapFactory等</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><p>大家可以到<a href="https://eirunye.github.io/"><strong>我的博客https://eirunye.github.io</strong></a>进行浏览相关文章，大家一起相互探讨技术。</p><p><a href="https://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><strong>设计模式系列</strong></a>大家可以了解相关文章。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;1.学习本篇文章，了解简单工厂设计模式的使用场景。&lt;br&gt;2.如何使用简单工厂模式。&lt;br&gt;3.简单工厂模式能解决什么问题？回到优缺点。&lt;/
      
    
    </summary>
    
      <category term="设计模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="简单工厂方法" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/"/>
    
      <category term="静态工厂" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/%E9%9D%99%E6%80%81%E5%B7%A5%E5%8E%82/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="设计模式" scheme="http://eirunye.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="简单工厂方法" scheme="http://eirunye.github.io/tags/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/"/>
    
      <category term="静态工厂" scheme="http://eirunye.github.io/tags/%E9%9D%99%E6%80%81%E5%B7%A5%E5%8E%82/"/>
    
  </entry>
  
  <entry>
    <title>Hexo搭建GitHub博客—打造炫酷的NexT主题--高级(五)</title>
    <link href="http://eirunye.github.io/2018/09/23/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%BA%94/"/>
    <id>http://eirunye.github.io/2018/09/23/Hexo搭建GitHub博客—打造炫酷的NexT主题—高级—五/</id>
    <published>2018-09-23T08:10:26.000Z</published>
    <updated>2018-09-23T08:19:46.449Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>上篇<a href="https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/#more">Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</a>讲解到Hexo NexT的相关配置如：设置字体、背景动画、添加打赏等等。大家还没设置可以去查看根据自己的需要。<br>接下来继续对NexT主题博客进行配置，本篇主要是还是添加一些第三方配置。请跟着脚步开启新的旅行吧。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-370bd2ee37673ece.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/330" alt="Hexo.png"></p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><blockquote><p>1.友情链接</p></blockquote><p>在<code>next/_config.yml</code>下搜索<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Blog rolls</span><br><span class="line">links_icon: link  #图标</span><br><span class="line">links_title: 友情链接    #表示Title</span><br><span class="line">links_layout: block</span><br><span class="line">#links_layout: inline</span><br><span class="line">links:     #打开</span><br><span class="line">  Eirunye: http://eirunye.github.io/   #所需添加的友情链接 Title是表示友情链接的博客名称或者随意你取，后面是链接，冒号后面记得空格</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-64ac9c3661c0f6cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="友情链接.png"></p><blockquote><p>2.添加阅读统计</p></blockquote><p>我们给每篇文章进行添加阅读统计，我是如何配置的呢？如下图查看</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-8eba59ee0c6258e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="添加阅读次数.png"></p><p>1.进入<a href="https://leancloud.cn" target="_blank" rel="noopener">leancloud</a></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-c57fe2e97bf0039c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="leancloud.png"></p><p>2.创建应用</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-b6d52e9a429b4427.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="创建应用.png"></p><p>3.进入设置页面</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5c40699d54128869.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="设置1.png"></p><p>4.应用key</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-3d0a0be6971a42b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="应用key.png"></p><p>将App ID、App Key 配置到<code>next/_config.yml</code>中<code>leancloud_visitors</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">leancloud_visitors:</span><br><span class="line">  enable: true 设置为true 默认为false</span><br><span class="line">  app_id:  #你的App ID，注意冒号后面空格</span><br><span class="line">  app_key:  #你的App Key，注意冒号后面空格</span><br><span class="line">  Dependencies:  https://github.com/theme-next/hexo-leancloud-counter-security #设置依赖</span><br><span class="line">  security: true #如果您不关心lc计数器中的安全性并且只想直接使用它（没有hexo-leancloud-counter-security插件），请将`security`设置为`false`。</span><br><span class="line">  betterPerformance: true#更好的性能</span><br></pre></td></tr></table></figure><p>5.在<code>leancloud</code>存储的位置创建<code>Class</code>,必须命名为<code>Counter</code></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-ae81650e35568943.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="创建Counter.png"></p><p>6.查看后台统计数据</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-b93fa7c0b3e3958e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="leancloud后台统计阅读量.png"></p><ul><li>注：这里主要是创建时需要注意的命名<code>Counter</code>,还有在<code>next/config.yml</code>中的<code>leancloud_visitors</code>配置。</li></ul><blockquote><p>3.添加评论</p></blockquote><p>我们来进行一下文章添加评论系统吧。来设置一些常用的评论系统，我的博客选择的是<a href="https://leancloud.cn" target="_blank" rel="noopener">Valine</a></p><ul><li><strong>Valine</strong></li></ul><p>在<code>next/_config.yml</code>搜索<code>Valine</code>,进入<a href="https://leancloud.cn" target="_blank" rel="noopener">Valine</a> 官网，也是<a href="https://leancloud.cn" target="_blank" rel="noopener">leancloud</a>官网，进入<code>leancloud</code> 控制台,没有账号密码就进行设置。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-0e920d2ff7e62b7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Valine.png"></p><p>1.创建应用</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-b6d52e9a429b4427.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="创建应用.png"></p><p>2.进入设置页面</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5c40699d54128869.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="设置1.png"></p><p>3.应用key</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-3d0a0be6971a42b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="应用key.png"></p><p>4.在<code>next/_config.yml</code>进行一下配置，大家也可根据自己来设置该评论设置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">valine:</span><br><span class="line">  enable: true # 设置为true，默认为false</span><br><span class="line">  appid:  # 将应用key的App ID设置在这里</span><br><span class="line">  appkey: # 将应用key的App Key设置在这里</span><br><span class="line">  notify: true# 邮箱通知 , https://github.com/xCss/Valine/wiki，默认为false</span><br><span class="line">  verify: true# 验证码 默认为false</span><br><span class="line">  placeholder: Just go go ^_^ # 初始化评论显示，根据自己修改，这里默认，</span><br><span class="line">  avatar: wavatar # 头像风格，默认为mm，可进入网址：https://valine.js.org/visitor.html查看头像设置，这里有许多头像风格，进行设置</span><br><span class="line">  guest_info: nick,mail,link # 自定义评论标题</span><br><span class="line">  pageSize: 10 # 分页大小，10页就自动分页</span><br><span class="line">  visitor: true # 是否允许游客评论 ，进入官网查看设置：https://valine.js.org/visitor.html</span><br></pre></td></tr></table></figure></p><p>5.显示结果</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-8a6a99fa1d005d36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="显示结果.png"></p><p>这样就完成了<code>valine</code>评论的配置了，接下来就可以进行评论了，我们还可以在后台查看评论信息。</p><p>6.在后台查看评论数据</p><p>在<code>valine</code>后台，存储位置中的数据里面创建<code>Class</code>，名称必须为命名为<code>Comment</code></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-053fd5f8b3ce13cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="创建Comment.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7323a50fe30382a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="评论系统后台管理数据.png"></p><ul><li><p>注：选择<code>valine</code>评论系统是因为支持国内网络，不需要连接外网（翻墙）就可以进行显示评论系统，而且很好管理，页面简单。</p></li><li><p><strong>来必力评论</strong></p></li></ul><p>接下来我们来进行一下来必力评论系统在<code>NexT</code>上配置。</p><p>1.进入<a href="https://livere.com/" target="_blank" rel="noopener">来必力官网</a></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-d3595c586dfc7038.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="来必力官网.png"></p><p>2.进入安装页面</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-21f1ec5c66c8e365.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="安装.png"></p><p>3.进入评论系统中的代码管理</p><p>将data-uid复制到<code>next/_config.yml</code>中的<code>livere_uid</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">livere_uid:  #you data-uid如图所示</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-aaaa8938bdfbb417.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="设置livere_uid.png"></p><p>4.显示结果</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7bd1af2ccd435d68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="来必力显示.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-cd36a42011c2e990.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="来必力评论.png"></p><ul><li>注：来必力是韩国打造的评论系统，所以可能在国内有时不稳定，可能有时需要翻墙才能进行评论，所以大家在选择的时候，需要注意。</li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1.本章主要讲解的是NexT添加友情链接，这样如需添加，就进行添加。</p><p>2.添加评论系统，让我们的文章都可以让读者进行评论，指点江山、探讨知识点，可能出现问题，学习进步。</p><p>3.这里进行了两种评论系统的配置，接下来，有空将别的也添加说明一下，一起玩玩别的评论系统看看怎么样，不过这两个也是够了的，推荐<code>Valine</code>,这样我们可以管理阅读统计量。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><p><a href="https://eirunye.github.io/categories/Hexo/"><strong>Hexo配置系列文章</strong></a></p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/#more"><strong>Hexo搭建GitHub博客–初级(一)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E2%80%94%E4%BA%8C/#more"><strong>Hexo搭建GitHub博客–初级(二)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/23/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%BA%94/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(五)</strong></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;上篇&lt;a href=&quot;https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BA
      
    
    </summary>
    
      <category term="Hexo" scheme="http://eirunye.github.io/categories/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/categories/Hexo/NexT/"/>
    
    
      <category term="Hexo" scheme="http://eirunye.github.io/tags/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/tags/NexT/"/>
    
      <category term="GitHub" scheme="http://eirunye.github.io/tags/GitHub/"/>
    
      <category term="Node" scheme="http://eirunye.github.io/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 连接数据库(五)</title>
    <link href="http://eirunye.github.io/2018/09/19/Spring-Boot-%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93-%E4%BA%94/"/>
    <id>http://eirunye.github.io/2018/09/19/Spring-Boot-连接数据库-五/</id>
    <published>2018-09-19T05:54:20.000Z</published>
    <updated>2018-09-22T08:22:38.119Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>本篇我们将学习如何在项目中连接数据库。<br>在一个成熟的项目是离不开数据库的，数据库很好的为我们的项目管理数据，让我们的开发变得简单，我们只需关注数据操作，而无需关注更多的数据库是如何操作的。<br>那么Spring Boot开发的项目是如何连接数据库呢？大家还记得在<a href="https://eirunye.github.io/2018/08/20/Spring-Boot-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AE%BE%E7%BD%AE-%E4%B8%89/#more"><strong>Spring Boot 配置文件设置(三)</strong></a>配置的时候说到数据库的连接。是的没错上面的例子完完全全都可以进行数据的连接。本篇是以连接<a href="https://www.mysql.com/" target="_blank" rel="noopener">MySQL</a>为例，进行连接数据操作。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-06639c85d05db900.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="Spring Boot.png"></p><p>#安装</p><p>在开发之前，我们一定要选择合适的数据库，例如：<a href="https://dev.mysql.com/" target="_blank" rel="noopener">MySQL</a>、<a href="https://www.oracle.com/downloads/index.html#database" target="_blank" rel="noopener">Oracle</a>、<a href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads" target="_blank" rel="noopener">SQL Server</a>、<a href="http://www.sqlite.org/download.html" target="_blank" rel="noopener">SQLite</a>、<a href="https://www.mongodb.com/download-center#community" target="_blank" rel="noopener">MongoDB</a>等数据库，本篇将对MySQL进行操作，其他数据库类型，请查看文档，后期可能增加。</p><p>1.下载<a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">MySQL</a>进行安装</p><p>2.配置MySQL环境变量</p><p>3.打开CMD，进行验证MySQL是否安装成功</p><p>查看版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -v</span><br></pre></td></tr></table></figure><p>进入MySQL</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p;</span><br></pre></td></tr></table></figure><ul><li>注意: mysql刚刚安装完成时，账户为:root,密码没有，所以直接回车就行<br>  然后可以设置一下密码，或者不设置也无所谓，修改密码如下:<br>  用SET PASSWORD命令：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">mysql&gt; SET PASSWORD FOR &apos;root&apos;@&apos;localhost&apos; = PASSWORD(&apos;newpass&apos;);</span><br></pre></td></tr></table></figure><p>或者用mysqladmin，如果无法设置的时候，就用管理者进入设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -u root password &quot;newpass&quot;</span><br></pre></td></tr></table></figure><p>如果root已经设置过密码，采用如下方法:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -u root password oldpass &quot;newpass&quot;</span><br></pre></td></tr></table></figure><p>创建一个数据库:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE 数据库名;</span><br><span class="line">CREATE DATABASE eirunye_springboot_notes;</span><br></pre></td></tr></table></figure><p>查看创建的数据库：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW DATABASES;</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-20cf7bd301157c33.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="show database.png"></p><h1 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h1><p><strong>1.在项目根目录下打开<code>pom.xml</code>文件添加 <code>MySql Maven</code> 依赖</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">                &lt;!--jpa依赖--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;2.0.1.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">               &lt;!--MySQL配置依赖 版本看自己的需求--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;8.0.11&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">&lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure><p><strong>2.在<code>application.properties</code>或者在<code>application.yml</code>文件进行配置</strong>，本例以<code>application.yml</code>为例</p><ul><li>在<code>application.yml</code>添加一下代码。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">      driver-class-name: com.mysql.cj.jdbc.Driver  # MySql jdbc Driver</span><br><span class="line">      # 连接数据库</span><br><span class="line">      # eirunye_springboot_notes表示的是你创建的数据库;</span><br><span class="line">      # useSSL:是否使用SSL证书验证;</span><br><span class="line">      # characterEncoding:编码格式;</span><br><span class="line">      # useJDBCCompliantTimezoneShift:是否使用符合JDBC的时区转换;</span><br><span class="line">      # useLegacyDatetimeCode:是否使用旧版日期时间码;</span><br><span class="line">      # serverTimezone:选择服务器时间方式;</span><br><span class="line">      url: jdbc:mysql://127.0.0.1:3306/eirunye_springboot_notes?useSSL=false&amp;requireSSL=false&amp;characterEncoding=UTF-8&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC</span><br><span class="line">      username: root   #本地设置数据库账号</span><br><span class="line">      password: 123456 #密码</span><br></pre></td></tr></table></figure><ul><li>在<code>application.properties</code>添加一下代码。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line"># 连接数据库</span><br><span class="line"># demo表示的是你创建的数据库;</span><br><span class="line"># useSSL:是否使用SSL证书验证;</span><br><span class="line"># characterEncoding:编码格式;</span><br><span class="line"># useJDBCCompliantTimezoneShift:是否使用符合JDBC的时区转换;</span><br><span class="line"># useLegacyDatetimeCode:是否使用旧版日期时间码;</span><br><span class="line"># serverTimezone:选择服务器时间方式;</span><br><span class="line">spring.datasource.url=jdbc:mysql://127.0.0.1:3306/demo?useSSL=false&amp;requireSSL=false&amp;characterEncoding=UTF-8&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC</span><br><span class="line"># 数据库用户名</span><br><span class="line">spring.datasource.username=root</span><br><span class="line"># 数据库密码</span><br><span class="line">spring.datasource.password=123456</span><br><span class="line">spring.jpa.hibernate.ddl-auto=update</span><br><span class="line"># 是否启用SQL语句的日志记录</span><br><span class="line">spring.jpa.show-sql=true</span><br><span class="line">server.port=8081</span><br></pre></td></tr></table></figure><p><strong>3.测试</strong></p><p>运行项目若无报错则说明配置已经成功了，接下来就是进行项目编写了。</p><h1 id="使用Intellij-IDEA操作数据库"><a href="#使用Intellij-IDEA操作数据库" class="headerlink" title="使用Intellij IDEA操作数据库"></a>使用Intellij IDEA操作数据库</h1><p>如果使用的是<a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">Intellij IDEA</a>进行开发项目的话，我们也可以这么查看我们的连接，还有相关数据表等等。</p><h2 id="如何使用Intellij-IDEA连接数据库？"><a href="#如何使用Intellij-IDEA连接数据库？" class="headerlink" title="如何使用Intellij IDEA连接数据库？"></a>如何使用Intellij IDEA连接数据库？</h2><p>1.打开Intellij IDEA的database数据库导航</p><ul><li>打开方式一</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-78e6eb1c81a72ee1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="open databse 1.png"></p><ul><li>打开方式二</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-2a604d6f3ff7556e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="open databse 2.png"></p><p>2.进行连接</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-cd88f011937ca37e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="open databse 3.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-98218a33d3fb8b7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="open databse 4.png"></p><p>3.连接成功</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5356e90f44d55f4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="database success.png"></p><p>4.注意事项</p><p>如果无法连接，那说明账号密码出现问题，还有可能是修改了其他默认的地方。大家请注意。</p><p>5.创建表TABLE</p><ul><li>创建表</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-9a160dbe5d29c123.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="创建表.png"></p><ul><li>添加字段</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-d61934ea2984d57c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="添加字段.png"></p><ul><li>插入数据</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-45409e06e0fd45e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="插入数据.png"></p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><ul><li><p><a href="https://github.com/eirunye/SpringBoot_database_connection" target="_blank" rel="noopener"><strong>本篇案例代码下载-码云</strong></a></p></li><li><p><a href="https://github.com/eirunye/SpringBoot_database_connection" target="_blank" rel="noopener"><strong>本篇案例代码下载-GitHub</strong></a></p></li><li><p><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-码云</strong></a></p></li><li><p><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-GitHub</strong></a></p></li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1.一般情况下我在配置连接数据库的时候，推荐大家使用的是在设置文件里面配置在.yml或者是application.properties里面进行设置。</p><p>2.接下来的博文讲解如何操作数据库: <code>JPA、MyBatis</code></p><p>3.在使用Spring Boot开发项目中遇到了一些坑，在后期我会不断更新，与大家一起学习。</p><p>4.当然了IDEA还有许多操作数据库功能，大家就自己进行操作测试吧。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><p><a href="https://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/">Spring Boot 系列文章</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;本篇我们将学习如何在项目中连接数据库。&lt;br&gt;在一个成熟的项目是离不开数据库的，数据库很好的为我们的项目管理数据，让我们的开发变得简单，我们
      
    
    </summary>
    
      <category term="后台" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/tags/Spring-Boot/"/>
    
  </entry>
  
  <entry>
    <title>Hexo搭建GitHub博客—打造炫酷的NexT主题--高级(四)</title>
    <link href="http://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/"/>
    <id>http://eirunye.github.io/2018/09/15/Hexo搭建GitHub博客—打造炫酷的NexT主题—高级—四/</id>
    <published>2018-09-15T13:12:51.000Z</published>
    <updated>2018-09-23T08:11:54.010Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>上篇<a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more">Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</a>主要是对NexT整体布局的配置，达到完美喜欢的布局格式。<br>接下来继续对NexT主题博客进行配置，本篇主要是添加一些常用的第三方访问或者服务。请跟着脚步开启新的旅行吧。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-370bd2ee37673ece.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/330" alt="Hexo.png"></p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><blockquote><p><strong>1.Math Equations Render Support</strong> 数学方程式渲染支持</p></blockquote><p>这里可能有时需要在文章中使用到时数学公式了，在这里设置一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">math:</span><br><span class="line">  enable: true  #默认为false</span><br><span class="line">  per_page: true</span><br><span class="line">  engine: mathjax   #两种方式  mathjax / katex</span><br><span class="line">  mathjax:</span><br><span class="line">    cdn: //cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML  #默认 这里大家根据自己需求</span><br><span class="line">  katex:</span><br><span class="line">    cdn: //cdn.jsdelivr.net/npm/katex@0.7.1/dist/katex.min.css   #默认</span><br></pre></td></tr></table></figure><blockquote><p><strong>2.Han Support</strong> 支持汉字</p></blockquote><p>设置汉字支持，这里我没配置，选择默认了，如果大家想配置的话就按照以下步骤</p><p>1.打开<code>Git Bash Here</code>进入<code>themes/next</code>目录下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd theme/next</span><br></pre></td></tr></table></figure><p>2.获取该汉字支持<code>Git module</code>,执行命令以下命令获得</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/theme-next/theme-next-han source/lib/Han</span><br></pre></td></tr></table></figure><p>3.设置汉字支持</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">han: true</span><br></pre></td></tr></table></figure><p>4.更新update</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd themes/next/source/lib/Han</span><br><span class="line">$ git pull</span><br></pre></td></tr></table></figure><ul><li>注: 通过该链接可以查看以上步骤 <a href="https://github.com/theme-next/theme-next-han" target="_blank" rel="noopener">https://github.com/theme-next/theme-next-han</a></li></ul><blockquote><p><strong>3.添加图标链接到GitHub</strong></p></blockquote><p>一般在右上角或者左上角，如下我的博客配置。</p><ul><li>配置右上角<code>Fork_me_on_GitHub</code>,按以下步骤进行</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-e0bcdcd9f52a18f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="Fork_me_on_GitHub_left.png"></p><p>1.打开<a href="https://blog.github.com/2008-12-19-github-ribbons/" target="_blank" rel="noopener">Fork_me_on_GitHub</a>链接，里面有许多样式，选择自己喜欢的样式，将其复制下来。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-92ff12abe2bce550.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="get_Fork_me_on_GitHub"></p><p>2.打开自己博客项目中的<code>themes/next/layout/_layout.swig</code>文件，搜索<code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code> 将复制的内容粘贴到<code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code>下面，如下：</p><ul><li>注：要修改<code>红色</code>框里面的连接为自己在<code>GitHub</code>上的连接。</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-dfe58d27c86dce97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="Fork_GitHub.png"></p><ul><li>配置右上角的<code>Fork_me_on_GitHub</code></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-eb8357bd72c556f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="right_GitHub.png"></p><p>本例的方式和上面的方式一样的步骤，但是获取的连接不同了，本例的连接地址是<a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">GitHub Corners</a></p><blockquote><p><strong>4.将文章底部<code>#</code>标签修改带为带<code>图标</code>的形式</strong></p></blockquote><p>在博客项目中找到<code>/themes/next/layout/_macro/post.swig</code>，搜索 <code>rel=&quot;tag&quot;</code>，将 <code>#</code>号 换成<code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-772d622b78371ef5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="图标设置.png"></p><ul><li>原先<code>#</code>号的样式</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-9a047dfc26ea22d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="标签_1.png"></p><ul><li>修改为<code>图标</code>的样式</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-56af68a00a97f73e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="标签_2.png"></p><blockquote><p><strong>5.font字体设置</strong></p></blockquote><p>在<code>themes/next/_config.yml</code>搜索<code>font</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">font:</span><br><span class="line">  enable: true #默认false 如果要进行字体修改那么设置为true</span><br><span class="line"></span><br><span class="line">  global:</span><br><span class="line">    external: true</span><br><span class="line">    family: Lato   #设置字体  下同</span><br><span class="line">    size:   #字体大小  下同</span><br><span class="line"></span><br><span class="line">  headings:</span><br><span class="line">    external: true</span><br><span class="line">    family:</span><br><span class="line">    size:</span><br><span class="line">  posts:</span><br><span class="line">    external: true</span><br><span class="line">    family:</span><br><span class="line">  logo:</span><br><span class="line">    external: true</span><br><span class="line">    family:</span><br><span class="line">    size:</span><br><span class="line">  codes:</span><br><span class="line">    external: true</span><br><span class="line">    family:</span><br><span class="line">    size:</span><br></pre></td></tr></table></figure><blockquote><p><strong>6.设置背景动画样式</strong></p></blockquote><p>NexT里面有几种动画背景样式<code>canvas_nest</code>、<code>three_waves</code>、<code>canvas_lines</code>、<code>canvas_sphere</code>等</p><ul><li><strong>canvas_nest如下图所示</strong></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-c41d2d9a1aed94c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="背景动画.png"></p><p>按照以下步骤完成</p><p>1.打开<code>Git Bash Here</code>进入自己文件夹下/themes/next文件夹下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd /themes/next</span><br></pre></td></tr></table></figure><p>2.下载安装 <code>canvas_nest module</code> 执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/theme-next/theme-next-canvas-nest source/lib/canvas-nest</span><br></pre></td></tr></table></figure><p>在 <code>/themes/next/source/lib</code>查看会看到<code>canvas_nest</code>文件夹</p><p>3.在<code>/themes/next/_config.yml</code>设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">canvas_nest: true</span><br></pre></td></tr></table></figure><ul><li>注：<a href="https://github.com/theme-next/theme-next-canvas-nest" target="_blank" rel="noopener">canvas_nest</a>连接</li><li><p>注：这里也可以查看设置步骤：<a href="https://www.jianshu.com/p/b9556119ee8a" target="_blank" rel="noopener">canvas_nest设置</a></p></li><li><p><strong>three_waves如图所示</strong></p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-a1c367800b7d8524.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="three_waves.png"></p><p>打开<a href="https://github.com/theme-next/theme-next-three" target="_blank" rel="noopener">three_waves</a> 查看设置步骤，这里和<code>canvas_nest</code>步骤是一样的，这里就不写咯。<br>下载完成后，在<code>/themes/next/_config.yml</code>设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">three_waves: true</span><br><span class="line">#OR</span><br><span class="line">canvas_lines: true</span><br><span class="line">#OR</span><br><span class="line">canvas_sphere: true</span><br></pre></td></tr></table></figure><ul><li><strong>canvas_ribbon</strong>只适合 <code>scheme Pisces</code> 这里不测试了，大家可以进入<a href="https://github.com/theme-next/theme-next-canvas-ribbon" target="_blank" rel="noopener">canvas_ribbon</a>安装</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># busuanzi_value_site_uv  表示用户连续点击n篇文章，只记录1次访客数</span><br><span class="line"># busuanzi_value_site_pv  表示用户连续点击n篇文章，记录+n次访问量</span><br><span class="line"># 这里对应的是2上的id值</span><br></pre></td></tr></table></figure><blockquote><p><strong>8.给每篇文章添加类别和标签</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/3012005-9a81a6b5b4eb91de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="添加标签.png"></p><p>在创建的文章都在<code>source/_post</code>目录下找到，每篇文章添加<code>tags</code>、<code>categories</code></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-3af1b50cf510e5a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="标签_tags.png"></p><blockquote><p><strong>9.添加进度条</strong></p></blockquote><ul><li>注：添加进度条的话在手机浏览的时候一般情况都有自带的进度条了，例如微信浏览、浏览器浏览等等，这样就出现重复的进度条了，这里看个人是否添加。但是在电脑浏览器浏览却是不错的。<br>本例设置的如下<code>pace-theme-center-atom</code>显示</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-d8e82b6d82527d0b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="进度条_1.png"></p><p>按照以下步骤进行</p><ul><li>注：或者进入这里 <a href="https://github.com/theme-next/theme-next-pace" target="_blank" rel="noopener">Progress配置</a>查看如何配置</li></ul><p>1.打开<code>Git Bash Here</code>进入自己文件夹下<code>/themes/next</code>文件夹下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd /themes/next</span><br></pre></td></tr></table></figure></p><p>2.下载安装 <code>Progress module</code> 执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/theme-next/theme-next-pace source/lib/pace</span><br></pre></td></tr></table></figure></p><p>在 <code>/themes/next/source/lib</code>查看会看到<code>pace</code>文件夹<br>3.在<code>/themes/next/_config.yml</code>设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pace: true  #设置为true</span><br><span class="line"># Themes list:</span><br><span class="line">#pace-theme-big-counter</span><br><span class="line">#pace-theme-bounce</span><br><span class="line">#pace-theme-barber-shop</span><br><span class="line">#pace-theme-center-atom</span><br><span class="line">#pace-theme-center-circle</span><br><span class="line">#pace-theme-center-radar</span><br><span class="line">#pace-theme-center-simple</span><br><span class="line">#pace-theme-corner-indicator</span><br><span class="line">#pace-theme-fill-left</span><br><span class="line">#pace-theme-flash</span><br><span class="line">#pace-theme-loading-bar</span><br><span class="line">#pace-theme-mac-osx</span><br><span class="line">#pace-theme-minimal</span><br><span class="line"># For example</span><br><span class="line"># pace_theme: pace-theme-center-simple</span><br><span class="line">pace_theme: pace-theme-center-atom #这里任选其中一种</span><br></pre></td></tr></table></figure><ul><li>注大家在这里想用什么样式就自己测试。</li></ul><blockquote><p><strong>10.添加站内搜索</strong></p></blockquote><p>由于可能我需要快速查找相关文章，那么就需要添加站内搜索。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-a58b6a0d2e6ecc05.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="local_search.png"></p><p>按以下步骤进行</p><ul><li>注：或者进入<a href="https://github.com/theme-next/hexo-generator-searchdb" target="_blank" rel="noopener">NexT配置站内搜索文档</a>查看如何配置</li></ul><p>1.安装站内搜索插件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$  npm install hexo-generator-searchdb --save</span><br><span class="line">或者</span><br><span class="line">$ cnpm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure><p>2.在根目录下的<code>_config.yml</code>添加</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#表示站内搜索</span><br><span class="line">search:</span><br><span class="line">    path: search.xml</span><br><span class="line">    field: post</span><br><span class="line">    format: html</span><br><span class="line">    limit: 10000</span><br></pre></td></tr></table></figure><p>3.在<code>themes/next/_config.yml</code>文件中搜索<code>local_search</code>,进行设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">local_search:</span><br><span class="line">  enable: true  #设置为true</span><br><span class="line">  trigger: auto  # auto /  manual，auto 自动搜索、manual：按回车[enter ]键手动搜索</span><br><span class="line">  top_n_per_article: 1</span><br><span class="line">  unescape: true</span><br></pre></td></tr></table></figure><blockquote><p><strong>11.添加打赏功能</strong></p></blockquote><p>查看配置如下</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7930dad3ee7bc3e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="打赏.png"></p><p>NexT主要提供三种打赏方式分别是微信、支付宝、比特币<br>在<code>themes/next</code>搜索<code>Reward</code>,三个都打开吧</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Reward</span><br><span class="line">reward_comment: Donate comment here  # 描述</span><br><span class="line">wechatpay: /images/wechatpay.jpg</span><br><span class="line">alipay: /images/alipay.jpg</span><br><span class="line">bitcoin: /images/bitcoin.png</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本篇我们进行了<code>NexT</code>主题的相关配置，这让我们的博客已经非常漂亮了，接下来我们主要进行添加<code>NexT</code>的评论系统、添加百度、Google检索等高级配置，希望各位读者在配置时遇到问题是，随时评论，我们一起解决相关问题。</p><h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><p>大家也可以查看关于Hexo相关文章。</p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/#more"><strong>Hexo搭建GitHub博客–初级(一)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E2%80%94%E4%BA%8C/#more"><strong>Hexo搭建GitHub博客–初级(二)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</strong></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;上篇&lt;a href=&quot;https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BA
      
    
    </summary>
    
      <category term="Hexo" scheme="http://eirunye.github.io/categories/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/categories/Hexo/NexT/"/>
    
    
      <category term="Hexo" scheme="http://eirunye.github.io/tags/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/tags/NexT/"/>
    
      <category term="GitHub" scheme="http://eirunye.github.io/tags/GitHub/"/>
    
      <category term="Node" scheme="http://eirunye.github.io/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>Hexo搭建GitHub博客—打造炫酷的NexT主题--高级(三)</title>
    <link href="http://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/"/>
    <id>http://eirunye.github.io/2018/09/02/Hexo搭建GitHub博客—打造炫酷的Next主题—高级—三/</id>
    <published>2018-09-01T17:22:43.000Z</published>
    <updated>2018-09-17T09:03:56.561Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>上面两篇文章让我们人识了<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexo</a>是如何搭建GitHub博客、如何进行部署Hexo到GitHub上、如何进行一些常用的配置例如：<strong>Site</strong>、<strong>URL</strong>、<strong>Deployment</strong>、<strong>Date</strong>等配置、如何创建文章、创建文章时应该注意哪些事项等等。<br>在<a href="https://hexo.io/themes/" target="_blank" rel="noopener"><strong>Hexo主题官网</strong></a>中有许多主题，大家喜欢什么就进行部署和编辑就好了，大致的思路都是差不多的。<br>本篇让我们正在进入到高级篇学习，如何打造炫酷的<a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener"><strong>NexT主题</strong></a>，让我们的博客更加美化。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-370bd2ee37673ece.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="Hexo.png"></p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>首先我们先进入到NexT主题官网，看看我们如何安装。这里就直接进行了，大家有空自己可以去看看，本篇主要说的是NexT 6.0版本以上，6.0版本以前就不说了。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-57f853dd3402c444.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="NexT主题官网.png"></p><p>1.在项目根目录下，我的项目是<code>myblog</code>,打开Git Bash Here执行以下命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7126866142ce32d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="NexT下载安装.png"></p><p>下载安装完成</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-39c9ac9978d59b4d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="NexT下载安装完成.png"></p><p>2.将Hexo的主题切换为NexT主题<br>在项目根目录下打开<code>_config.yml</code>文件将<code>theme</code>设置为<code>next</code>即：</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-667a6d087077b256.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="设置NexT.png"></p><p>3.运行命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-bca158b2e76c0926.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="NexT初始布局.png"></p><p>看起来还是有点难看啊，接下来进行配置吧。</p><h1 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h1><p>接下来就是进入我们博客核心部分了，配置属于自己的主题，让我们一起进入学习吧。</p><ul><li>注：这里可能不能全部去设置，大家有属于自己的，可以去研究，欢迎一起分享，可能在后期有遇到好的配置会在接下来的文章编写。</li><li>注：一般配置都在<strong>theme/next/-config.yml</strong>文件下配置</li></ul><blockquote><p>1.修改整体布局</p></blockquote><p>在<code>theme/next/-config.yml</code>找到<code>menu</code>看看自己博客所需的分类</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-1d82259bcb6cb1c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="NexT_menu.png"></p><p>显示如下</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-a4ea01dabc22c82c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="NexT-menu.png"></p><p>在<code>menu_settings</code>如果设置<code>icon: false</code>则无图标，<code>badges: true</code>则标签都会显示数字</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">menu_settings:</span><br><span class="line">  icons: true</span><br><span class="line">  badges: true #默认是false</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5a23060e73e0e579.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="badges true.png"></p><ul><li>注：这里我们需要创建<code>about</code>页面，很简单，同理创建标签<code>tags</code>、归档<code>archives</code>页面一样的方式，<code>所需要创建的名称要与menu相对应</code>，举例说明如下。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page about   #看看menu上还有什么标签没创建就行创建</span><br><span class="line">$ hexo new page tags    #创建标签等</span><br></pre></td></tr></table></figure><p>创建完成之后我们在自己项目查找，如我的是<code>myblog/source/</code>目录下查看新创建好的相关标签页面，里面包含各自的<code>index.md</code>文件，大家可以自行编辑了。</p><blockquote><p>2.<strong>Schemes</strong>方案设置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Schemes</span><br><span class="line">#scheme: Muse  #这是 Nex默认版本，黑白主调，大量留白</span><br><span class="line">scheme: Mist  #Muse 的紧凑版本，整洁有序的单栏外观</span><br><span class="line">#scheme: Pisces #双栏 Scheme，小家碧玉似的清新</span><br><span class="line">#scheme: Gemini  #双子座，也是双栏形式，和Pisces类似</span><br></pre></td></tr></table></figure><p>我们来一一测试一下吧，自己喜欢什么风格自行选择。</p><ul><li>scheme: Mist</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-762952637a910da5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="scheme Mist.png"></p><ul><li>scheme: Pisces</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7d4d9b9f84d40ac7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="scheme Pisces.png"></p><ul><li>scheme: Gemini</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-f6d9c1600c9d6b2d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="scheme Gemini.png"></p><blockquote><p>3.<strong>social设置</strong></p></blockquote><p>使用方式: <code>Key: permalink || icon</code> <code>Key</code>表示标签显示，<code>permalink</code>表示URI连接，<code>icon</code>表示图标，自己添加所要显示的，</p><ul><li>注：<a href="https://fontawesome.com/icons?from=io" target="_blank" rel="noopener">图标库来源</a> [<a href="https://fontawesome.com/icons?from=io]" target="_blank" rel="noopener">https://fontawesome.com/icons?from=io]</a></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  GitHub: https://github.com/eirunye || github</span><br><span class="line">  E-Mail: mailto:yrungen@gmail.com || envelope</span><br><span class="line">  简书: https://www.jianshu.com/u/447fdef5fb8f || heartbeat</span><br><span class="line">  Segmentfault: https://segmentfault.com/blog/iconye_vue || link</span><br><span class="line">  知乎: https://www.zhihu.com/people/yi-ke-id/activities || ioxhost</span><br><span class="line">  #Google: https://plus.google.com/yourname || google</span><br><span class="line">  #Twitter: https://twitter.com/yourname || twitter</span><br><span class="line">  #FB Page: https://www.facebook.com/yourname || facebook</span><br><span class="line">  #VK Group: https://vk.com/yourname || vk</span><br><span class="line">  StackOverflow: https://stackoverflow.com/ || stack-overflow</span><br><span class="line">  #YouTube: https://youtube.com/yourname || youtube</span><br><span class="line">  #Instagram: https://instagram.com/yourname || instagram</span><br><span class="line">  #Skype: skype:yourname?call|chat || skype</span><br><span class="line"></span><br><span class="line">social_icons:  #设置图标是否显示这里</span><br><span class="line">  enable: true #表示开启</span><br><span class="line">  icons_only: true 只显示图片</span><br><span class="line">  transition: true</span><br><span class="line">  exturl: false</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-885af877f70ccf54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="social.png"></p><ul><li>注：在<code>scheme: Pisces</code>该效果不显示？</li></ul><blockquote><p>4.<strong>avatar</strong>头像设置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">avatar:</span><br><span class="line">  url: #/images/avatar.gif  #头像图片路径 图片放置在next/source/images</span><br><span class="line">  rounded: false  #是否显示圆形头像，true表示圆形，false默认</span><br><span class="line">  opacity: 0.7  #透明度0~1之间</span><br><span class="line">  rotated: false  #是否旋转 true表示旋转，false默认</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7aa5901266d99055.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="avatar-rounded-false.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-e68961a0ca02365d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="avatar-rounded-true.png"></p><blockquote><p>5.<strong>toc</strong>边栏中的目录设置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">toc:</span><br><span class="line">  enable: false #是否启动侧边栏</span><br><span class="line">  number: true  #自动将列表编号添加到toc。</span><br><span class="line">  wrap: false #true时是当标题宽度很长时，自动换到下一行</span><br></pre></td></tr></table></figure><blockquote><p>6.<strong>Creative Commons 4.0</strong>国际许可设置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Available: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero</span><br><span class="line">creative_commons: by-nc-sa</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-f9a1f34c3df16f68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="creative_commons.png"></p><blockquote><p>7.<strong>sidebar</strong>侧边栏配置这里选择默认吧。</p></blockquote><p>大家可以去看看里面的属性，有许多相对应的<code>scheme</code>而设置。</p><blockquote><p>8.<strong>save_scroll</strong>配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">save_scroll: false # 是否在Cookie中自动保存每个帖子/页面上的滚动位置。</span><br></pre></td></tr></table></figure><blockquote><p>9.<strong>excerpt_description</strong></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">excerpt_description: true #是否自动摘录主页中的描述作为前导文本。</span><br></pre></td></tr></table></figure><blockquote><p>10.<strong>auto_excerpt</strong>配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">auto_excerpt:</span><br><span class="line">  enable: true  #是否自动摘录。不推荐。</span><br><span class="line">  length: 150  #这里是说文章开头第一个字到第150个字就显示&quot;阅读全文&quot;</span><br></pre></td></tr></table></figure><p>或者是在每篇文章需要显示”阅读全文”,在Markdown里面设置,但是<code>enable: false</code>表示不启动。两种方式选择一个。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- more --&gt;</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-acbfaf0f5b3b37e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="auto_excerpt.png"></p><blockquote><p>11.<strong>codeblock</strong>代码块配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">codeblock:</span><br><span class="line">  copy_button:</span><br><span class="line">    enable: true  #是否添加复制按钮</span><br><span class="line">    show_result: true  #是否显示文本复制结果</span><br></pre></td></tr></table></figure><blockquote><p>12.<strong>wechat_subscriber</strong>微信配置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wechat_subscriber:</span><br><span class="line">  enabled: true #是否启动微信订阅</span><br><span class="line">  qcode: /path/to/your/wechatqcode ex. /uploads/wechat-qcode.jpg #设置图片</span><br><span class="line">  description: ex. subscribe to my blog by scanning my public wechat account #描述</span><br></pre></td></tr></table></figure><blockquote><p>13.<strong>Code Highlight theme</strong> 代码突出显示主题</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Available values: normal | night | night eighties | night blue | night bright</span><br><span class="line">highlight_theme: normal #设置喜欢的模式，默认：normal</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-4ab4b79eeae2782b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="Code_Highlight_theme.png"></p><blockquote><p>14.<strong>footer</strong> 底部设置</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">footer</span><br><span class="line">  icon:</span><br><span class="line">    name: user  #设置图标，想修改图标从https://fontawesome.com/v4.7.0/icons获取</span><br><span class="line">    animated: true  #是否要为图标设置动画，默认为false</span><br><span class="line">    color: &quot;#66CDAA&quot;  #图标颜色</span><br><span class="line">  copyright: ©2018 by Eirunye  #版权</span><br><span class="line">  powered:</span><br><span class="line">    enable: true  #是否显示 Hexo link</span><br><span class="line">    version: true  #是否显示Hexo链接后的Hexo版本信息（vX.X.X）</span><br><span class="line">  theme:</span><br><span class="line">    enable: true   #是否显示NexT Themelink</span><br><span class="line">    version: true  #是否显示NexT版本信息</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5756c4bea6d57afe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="hexo_footer.png"></p><blockquote><p>15.<strong>favicon</strong>标签页图标</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">favicon:</span><br><span class="line">  small: /images/favicon-16x16-next.png   #小图标 默认的NexT</span><br><span class="line">  medium: /images/favicon-32x32-next.png  #中图标 默认NexT</span><br><span class="line">  apple_touch_icon: /images/apple-touch-icon-next.png #苹果触摸图标</span><br><span class="line">  safari_pinned_tab: /images/logo.svg   #safari固定标签</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-9894e2608fc34c2d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="favicon.png"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本篇主要讲解的是NexT主题常用的一些配置，接下来我们继续讲解<a href="https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</strong></a>。</p><h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><p>大家也可以查看关于Hexo相关文章。</p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/#more"><strong>Hexo搭建GitHub博客–初级(一)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E2%80%94%E4%BA%8C/#more"><strong>Hexo搭建GitHub博客–初级(二)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</strong></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;上面两篇文章让我们人识了&lt;a href=&quot;https://hexo.io/zh-cn/docs/&quot; target=&quot;_blank&quot; rel=
      
    
    </summary>
    
      <category term="Hexo" scheme="http://eirunye.github.io/categories/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/categories/Hexo/NexT/"/>
    
    
      <category term="Hexo" scheme="http://eirunye.github.io/tags/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/tags/NexT/"/>
    
      <category term="GitHub" scheme="http://eirunye.github.io/tags/GitHub/"/>
    
  </entry>
  
  <entry>
    <title>Hexo搭建GitHub博客--初级(二)</title>
    <link href="http://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E2%80%94%E4%BA%8C/"/>
    <id>http://eirunye.github.io/2018/09/01/Hexo搭建GitHub博客—初级—二/</id>
    <published>2018-09-01T15:38:22.000Z</published>
    <updated>2018-09-14T02:45:03.677Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>上篇我们主要讲的是如何通过<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>建站，并如何部署到GitHub上<a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/#more">Hexo搭建GitHub博客–初级(一)</a>。<br>大家不了解的话再看一下。本篇我们紧接上一篇继续进一步搭建<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>博客。<br>本篇主要讲解的是如何进行配置我们<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexo</a>的博客，开启旅程吧。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-341ef9931265c1c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="Hexo.png"></p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p>我们来进行一些我们常用的配置，在跟<strong>myblog</strong>目录下<code>_config.yml</code>。可以查看<a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">Hexo官网配置模块</a></p><h2 id="网站"><a href="#网站" class="headerlink" title="网站"></a>网站</h2><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td><code>title</code></td><td>网站标题</td></tr><tr><td><code>subtitle</code></td><td>网站副标题</td></tr><tr><td><code>description</code></td><td>网站描述</td></tr><tr><td><code>author</code></td><td>您的名字</td></tr><tr><td><code>language</code></td><td>网站使用的语言</td></tr><tr><td><code>timezone</code></td><td>网站时区。Hexo 默认使用您电脑的时区。<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" target="_blank" rel="noopener">时区列表</a>。比如说：<code>America/New_York</code>, <code>Japan</code>, 和 <code>UTC</code> 。</td></tr></tbody></table><p>例如：我的<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: Eirunye Activity  #网站标题</span><br><span class="line">subtitle: Notes      #网站副标题</span><br><span class="line">description:  This is MyBlog  Notes      #详情</span><br><span class="line">keywords:</span><br><span class="line">author: Eirunye   #作者</span><br><span class="line">language: zh-CN # 语言</span><br><span class="line">timezone: UTC #时区</span><br></pre></td></tr></table></figure><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Directory</span><br><span class="line">source_dir: source</span><br><span class="line">public_dir: public</span><br><span class="line">tag_dir: tags #标签</span><br><span class="line">archive_dir: archives  #归档</span><br><span class="line">category_dir: categories #类别</span><br><span class="line">code_dir: downloads/code</span><br><span class="line">i18n_dir: :lang</span><br><span class="line">skip_render:</span><br></pre></td></tr></table></figure><h2 id="文章"><a href="#文章" class="headerlink" title="文章"></a>文章</h2><p>查看以下列表，在<code>_config.yml</code>文件下查看相关属性。并进行修改为自己所想要的方式吧，这个就不一一进行分解了。</p><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td><code>new_post_name</code></td><td>新文章的文件名称</td><td>:title.md</td></tr><tr><td><code>default_layout</code></td><td>预设布局</td><td>post</td></tr><tr><td><code>auto_spacing</code></td><td>在中文和英文之间加入空格</td><td>false</td></tr><tr><td><code>titlecase</code></td><td>把标题转换为 title case</td><td>false</td></tr><tr><td><code>external_link</code></td><td>在新标签中打开链接</td><td>true</td></tr><tr><td><code>filename_case</code></td><td>把文件名称转换为 (1) 小写或 (2) 大写</td><td>0</td></tr><tr><td><code>render_drafts</code></td><td>显示草稿</td><td>false</td></tr><tr><td><code>post_asset_folder</code></td><td>启动 <a href="https://hexo.io/zh-cn/docs/asset-folders" target="_blank" rel="noopener">Asset 文件夹</a></td><td>false</td></tr><tr><td><code>relative_link</code></td><td>把链接改为与根目录的相对位址</td><td>false</td></tr><tr><td><code>future</code></td><td>显示未来的文章</td><td>true</td></tr><tr><td><code>highlight</code></td><td>代码块的设置</td><td><code>自定义</code></td></tr></tbody></table><h2 id="分类-amp-标签"><a href="#分类-amp-标签" class="headerlink" title="分类&amp;标签"></a>分类&amp;标签</h2><p>这里默认就行，并不影响我们接下来的一些操作。</p><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td><code>default_category</code></td><td>默认分类</td><td>uncategorized</td></tr><tr><td><code>category_map</code></td><td>分类别名</td><td></td></tr><tr><td><code>tag_map</code></td><td>标签别名</td><td><code>自定义</code></td></tr></tbody></table><h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h2><p>在分页中一般情况默认就好，10篇文章一页，不错的。</p><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td><code>per_page</code></td><td>每页显示的文章量 (0 = 关闭分页功能)</td><td>10</td></tr><tr><td><code>pagination_dir</code></td><td>分页目录</td><td><code>page</code></td></tr></tbody></table><h1 id="写作"><a href="#写作" class="headerlink" title="写作"></a>写作</h1><h2 id="创建文章"><a href="#创建文章" class="headerlink" title="创建文章"></a>创建文章</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure><p>如：创建hello-world<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new hello-world</span><br></pre></td></tr></table></figure></p><p>layout:就是<code>hello-world</code>,如果不添加title，默认就是标题title:<code>hello-world</code>。<br>这里注意一下，如果创建带有中文的路径名称时，生成静态页面<code>hexo g</code>可能会报错。那么可以查看<a href="https://www.jianshu.com/p/9afb3257133b" target="_blank" rel="noopener">Hexo 部署的时候发生错误解决方案</a></p><h2 id="修改文章"><a href="#修改文章" class="headerlink" title="修改文章"></a>修改文章</h2><p>创建的文章在<code>source/_posts</code> 文件夹下。我试着对<code>hello-world.md</code>进行修改。<br>修改如下: 添加标签<code>tags</code>、类别<code>categories</code>等等。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello World</span><br><span class="line">date: 2018-09-01</span><br><span class="line">tags:</span><br><span class="line">- Hexo</span><br><span class="line">categories:</span><br><span class="line">- Hexo</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h2 id="编写文章"><a href="#编写文章" class="headerlink" title="编写文章"></a>编写文章</h2><p>在这里写文章，和平时一样完全支持<a href="http://daringfireball.net/projects/markdown/" target="_blank" rel="noopener">Markdown</a>语法，加油吧。</p><h1 id="主题"><a href="#主题" class="headerlink" title="主题"></a><a href="https://hexo.io/themes/" target="_blank" rel="noopener">主题</a></h1><p>这是我们重点需要修改的东西，为了能达到自己喜欢的布局结构，你需要在这里进行各种配置哦，对博客的美化，还有修改成为自己独特风格的博客。<br><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>提供给我们许多模板主题，请查看<a href="https://hexo.io/themes/" target="_blank" rel="noopener">Hexo主题官网</a>下载自己喜欢的主题，接下来我会重点的讲解我所配置的主题。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>学习本篇文章我们知道了如何进行配置博客一些常用的功能，如何进行分类，如何创建文章。<br>接下来让我们进入到下一个阶段，主要是如何打造属于自己的博客风格，请进入下一站吧。<br><a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</strong></a>。</p><h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><p>大家可以查看关于<a href="https://eirunye.github.io/categories/Hexo/">Hexo</a>相关的文章。</p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/#more"><strong>Hexo搭建GitHub博客–初级(一)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E2%80%94%E4%BA%8C/#more"><strong>Hexo搭建GitHub博客–初级(二)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</strong></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;上篇我们主要讲的是如何通过&lt;a href=&quot;https://hexo.io/zh-cn/&quot; target=&quot;_blank&quot; rel=&quot;noo
      
    
    </summary>
    
      <category term="Hexo" scheme="http://eirunye.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://eirunye.github.io/tags/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/tags/NexT/"/>
    
      <category term="GitHub" scheme="http://eirunye.github.io/tags/GitHub/"/>
    
      <category term="Node" scheme="http://eirunye.github.io/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>Hexo搭建GitHub博客--初级(一)</title>
    <link href="http://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/"/>
    <id>http://eirunye.github.io/2018/09/01/Hexo搭建GitHub博客—初级一/</id>
    <published>2018-09-01T15:17:30.000Z</published>
    <updated>2018-09-14T02:45:03.662Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>由于平时自己喜欢记录开发笔记，写一些博客，但是总想自己搭建属于自己的博客，在网上查阅了一下，发现<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>在GitHub或者是码云上搭建博客非常给力。<br>接下来让我们一起进入<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>搭建博客学习吧。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-341ef9931265c1c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300" alt="Hexo.png"></p><h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a></h1><h2 id="什么是Hexo？"><a href="#什么是Hexo？" class="headerlink" title="什么是Hexo？"></a>什么是<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>？</h2><p><a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>是一个快速、简洁且高效的博客框架。<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>使用<a href="http://daringfireball.net/projects/markdown/" target="_blank" rel="noopener">Markdown</a>（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p><p>当我们在遇到一个新东西的时候，进入其官网能帮助我们解决很多问题。关于什么是Hexo？还有一些关于Hexo的问题，大家进入<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">Hexo官网</a>进行查看，这里我就不多说咯。</p><h1 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h1><p>我们在使用<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>之前需要准备一些东西，也就是需要安装一些我们必需的。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="安装所需"><a href="#安装所需" class="headerlink" title="安装所需"></a>安装所需</h3><p>安装<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>相当简单。然而在安装前，您必须检查电脑中是否已安装下列应用程序：</p><ul><li><a href="http://nodejs.org/" target="_blank" rel="noopener">Node.js</a></li><li><a href="http://git-scm.com/" target="_blank" rel="noopener">Git</a></li><li>cnpm 如果<code>npm</code>运行出错就安装<code>cnpm</code>国内镜像</li></ul><p>如果没有安装那么就需要安装咯，大家可以看看<a href="https://www.jianshu.com/writer#/notebooks/10827440/notes/31436824" target="_blank" rel="noopener">Vue-cli项目创建</a>如何检查<a href="http://nodejs.org/" target="_blank" rel="noopener">Node.js</a>、<a href="http://git-scm.com/" target="_blank" rel="noopener">Git</a>和<code>cnpm</code>是否安装成功。</p><h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a></h3><p>所有必备的应用程序安装完成后，即可使用<code>npm</code>或者<code>cnpm</code>来安装<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>。<br>打开Git Bash Here输入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br><span class="line">或者</span><br><span class="line">$ cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>检查是否安装<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>完成,查询是否成功，显示<code>hexo-cli</code>版本就说明成功了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo -V</span><br></pre></td></tr></table></figure></p><h1 id="建站"><a href="#建站" class="headerlink" title="建站"></a>建站</h1><p>安装一切所需的程序后，我们可以开始建站了，就是创建我们的博客,大家也可以进入<a href="https://hexo.io/zh-cn/docs/setup" target="_blank" rel="noopener">Hexo建站官网</a>查看。<br>新建一个文件夹，来管理我们的博客项目，请执行下列命令，<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>将会在指定文件夹中新建所需要的文件。</p><h2 id="运行命令"><a href="#运行命令" class="headerlink" title="运行命令"></a>运行命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init &lt;folder&gt;</span><br><span class="line">$ cd &lt;folder&gt;</span><br><span class="line">$ cnpm install</span><br></pre></td></tr></table></figure><ul><li>注：folder是表示建站的博客项目名</li></ul><p>打开Git Bash Here，输入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init myblog</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-b9f23bb1631d76e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="建站.png"></p><p>再运行以下命令：<code>myblog</code>是我创建博客站。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd myblog</span><br><span class="line">$ cnpm install</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-7b2253a00ae12e11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="建站完成.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-2f2bb0a75cb6cb46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="myblog目录.png"></p><h2 id="访问URL"><a href="#访问URL" class="headerlink" title="访问URL"></a>访问URL</h2><p>我们可以运行看看<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>创建的博客站是什么样的，运行以下命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br><span class="line">或者</span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-c4566376a59b96c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="运行.png"></p><p>访问URL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:4000/</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-52f623758fa37f13.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="访问.png"></p><p>好了，到这里你已经学会了通过<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>创建博客了，接下来我们将会分析如何将我们的博客上传到我们的GitHub服务器上呢？<br>还有我们如何修改我们的博客让我们的博客漂亮而且修改不同的主题来美化我们的博客呢?<br>紧跟着脚步。</p><h1 id="上传到GitHub"><a href="#上传到GitHub" class="headerlink" title="上传到GitHub"></a>上传到<a href="https://github.com/" target="_blank" rel="noopener">GitHub</a></h1><h2 id="GitHub创建repositories"><a href="#GitHub创建repositories" class="headerlink" title="GitHub创建repositories"></a><a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>创建repositories</h2><p> 进入<a href="https://github.com/" target="_blank" rel="noopener">GitHub官网</a>,或者在浏览器输入<code>https://github.com/</code>,如果还没有账号就创建一个账号就好了，这里不教大家怎么注册账号了。登录自己的账号，直接点击<code>new repositories</code>或者进入<code>You repositories</code>再<code>new repositories</code></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-9643d73b2a601e2a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="repository_1.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-884ba47d0d035bc7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="repository_2.png"></p><p>进入到创建<code>repositories</code>页面来,这里很重要，一定要注意哦！必须将新建的<code>repository</code>的名字为: <strong><code>You account name</code></strong>.github.io。其他默认就好了</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-fa33b440fd84624c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="repository_3.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-5863e3f089bc239a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="repository_4.png"></p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>GitHub的Repository创建好后。我们在回到本地的<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>的<code>Myblog</code>项目中，我们用代码编辑器工具打开，我这里用的是<a href="https://www.jetbrains.com/webstorm/" target="_blank" rel="noopener">Webstorm</a>,找到在项目的根目录下<strong>_config.yml</strong>找到 <strong>deploy</strong>标签</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-1e380b97ef75ea93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="_config.yml.png"></p><p>在该文件下面添加</p><ul><li>注：<code>repository: https://github.com/eirunye/eirunye.github.io.git</code> 是自己刚刚创建You account name.github.io 的repository，在<code>Clone with HTTPS</code>里面，复制粘贴就好咯。冒号后面记得空格哦。<code>branch</code> 后面是<code>master</code>就好了。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: https://github.com/eirunye/eirunye.github.io.git #复制过来</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/3012005-16f89dd25c96aeee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="_config.yml_0.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-3a90ca707717cc04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="_config.yml_repository.png"></p><p>在<code>_config.yml</code>找到<code>url</code>进行修改为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url: http://eirunye.github.io # eirunye是我的账号，修改为自己的账号</span><br></pre></td></tr></table></figure></p><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><p>到这里就差不到了，接下来我们需要执行一些命令，将我们的博客部署到GitHub上了，惊喜将会到来了。<br>打开Git Bash Here进入<code>myblog</code>根目录下，首先我们需要安装一下<a href="https://github.com/hexojs/hexo-deployer-git" target="_blank" rel="noopener">hexo-deployer-git</a>不然可能出现错误，无法部署成功，执行命令行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>然后在执行以下命令</p><ul><li><strong>注：每次提交时必须执行这三个命令</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure></li></ul><p>或者简写方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br><span class="line">$ hexo g</span><br><span class="line">$ hexo d</span><br></pre></td></tr></table></figure></p><p>部署成功如下显示</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-3da4ba848a8df404.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="部署成功.png"></p><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>我们进行访问<code>https://eirunye.github.io/</code><br>和 <code>http://localhost:4000/</code>一样的页面说明是已经成功。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-cb4c8c8a925effc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/500" alt="部署成功1.png"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>我们已经从如何使用<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>到部署上<a href="https://github.com/" target="_blank" rel="noopener">GitHub</a>上，没什么困难。需要我们对一些命令行的操作，还有一些需要我们必须注意的，一定要小心，不然就出错了。<br>当然了，我们还未对<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a>进行一些我们对于博客的美化，还有修改成为自己独特风格的博客。希望我们继续加油吧。接下来的我们将在下一章讲到哦，请查看<a href="https://www.jianshu.com/writer#/notebooks/10827440/notes/33161742/preview" target="_blank" rel="noopener"><strong>Hexo搭建GitHub博客–初级(二)</strong></a>。</p><h2 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h2><p>大家也可以查看关于<a href="https://eirunye.github.io/categories/Hexo/">Hexo</a>相关文章。</p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E4%B8%80/#more"><strong>Hexo搭建GitHub博客–初级(一)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/01/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E5%88%9D%E7%BA%A7%E2%80%94%E4%BA%8C/#more"><strong>Hexo搭建GitHub博客–初级(二)</strong></a></p><p><a href="https://eirunye.github.io/2018/09/02/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84Next%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E4%B8%89/#more"><strong>Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(三)</strong></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;由于平时自己喜欢记录开发笔记，写一些博客，但是总想自己搭建属于自己的博客，在网上查阅了一下，发现&lt;a href=&quot;https://hexo.
      
    
    </summary>
    
      <category term="Hexo" scheme="http://eirunye.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://eirunye.github.io/tags/Hexo/"/>
    
      <category term="NexT" scheme="http://eirunye.github.io/tags/NexT/"/>
    
      <category term="GitHub" scheme="http://eirunye.github.io/tags/GitHub/"/>
    
      <category term="Node" scheme="http://eirunye.github.io/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>策略模式</title>
    <link href="http://eirunye.github.io/2018/09/01/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    <id>http://eirunye.github.io/2018/09/01/策略模式/</id>
    <published>2018-08-31T17:24:32.000Z</published>
    <updated>2018-09-26T07:47:48.919Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>1.学习本篇博文，我们知道在什么场景下使用策略模式。<br>2.策略模式的优缺点。<br>3.策略模式的思想。</p><h1 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h1><p> 某公司需要每个周五每名员工都要提交周报，在该公司可以提交周报的行为或者“算法”有：邮箱提交、SVN、Git后两种一般是开发部门使用的(刚开始还没有Git提交方式)。<br> 那么在该场景中我们是如何设计业务逻辑呢？</p><p> 你可能这么想，我用继承的方式多好，在一个超类中都定义有邮箱提交，SVN提交，然后具体角色去继承，然后分别实现这些方法，在进行调用。<br> 但是你是不是忽略了一个问题，一个人事部门的前台小姐姐并不会SVN提交方式，你确实给她也拥有这样的方式了，这不是明显的设计漏洞吗？<br> 而且当你使用这样的方式的时候，如果开发部门经理，又提出新的想法添加了Git提交方式，那么你是不是需要修改了很多代码了呢？牵一发而动全身啊<br> 子类的代码重复到你崩溃了，而且很多部门使用的提交方式不同，我们并不需要知道其他部门的提交方式等等。<br> 所以继承很难解决我们现在的问题了。</p><p> 那么我们应该怎么设计呢？<br> 答案就是下文</p><h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><h2 id="什么是策略模式？"><a href="#什么是策略模式？" class="headerlink" title="什么是策略模式？"></a>什么是策略模式？</h2><p>  策略模式是：定义了算法族，分别封装起来，让其相互替换，相互独立，为达到算法动态修改的角色提供了独立。</p><h2 id="为什么需要策略模式？"><a href="#为什么需要策略模式？" class="headerlink" title="为什么需要策略模式？"></a>为什么需要策略模式？</h2><p> 1.从定义可以看出策略模式是定义了行为“算法”族，将其封装起来，给用户使用的，如果算法改变，那么只需添加或者修改算法方式便能解决问题了，而无需修改其他原有的行为“算法”，因为他们是相互独立的。<br> 2.对客户隐藏具体行为“算法”的实现细节，彼此之间相互独立。<br> 3.我们的场景需要完全符合策略模式，封装了不同的提交行为“算法”。</p><h2 id="进入代码分析"><a href="#进入代码分析" class="headerlink" title="进入代码分析"></a>进入代码分析</h2><blockquote><p>我们先来看一下这个UML类图进行分析</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/3012005-b7dcbc207bffa21b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="stategy.png"></p><blockquote><p>具体实现步骤</p></blockquote><p>1.定义一个行为“算法”，该行为“算法”是一个抽象类或者是接口<br>2.各种独立的行为去实现该行为“算法”接口<br>3.定义一个角色，是一个抽象超类或者接口<br>4.超类角色里面有一个封装的行为或者是“算法”的属性<br>5.定义一个方法进行委托该行为或者“算法”<br>6.具体的角色继承超类角色，并实现抽象方法</p><blockquote><p>具体代码分析</p></blockquote><p>SubmissionBehavior 接口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/31.</span><br><span class="line"> * Describe 定义了一个提交的行为称为一簇&quot;算法&quot;</span><br><span class="line"> * 这可以是一个抽象类或者是一个接口</span><br><span class="line"> */</span><br><span class="line">public interface SubmissionBehavior &#123;</span><br><span class="line"></span><br><span class="line">     void commit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>MailCommitBehavior.class</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/31.</span><br><span class="line"> * Describe 邮箱提交行为</span><br><span class="line"> */</span><br><span class="line">public class MailCommitBehavior implements SubmissionBehavior&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void commit() &#123;</span><br><span class="line">        System.out.println(&quot;邮箱提交周报行为&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>SVNCommitBehavior.class</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/31.</span><br><span class="line"> * Describe SVN 提交行为</span><br><span class="line"> */</span><br><span class="line">public class SVNCommitBehavior implements SubmissionBehavior&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void commit() &#123;</span><br><span class="line">        System.out.println(&quot;SVN提交行为&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Character.class 抽象类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/31.</span><br><span class="line"> * Describe 定义一个抽象超类角色</span><br><span class="line"> * 或者这里也可以是接口</span><br><span class="line"> */</span><br><span class="line">public abstract class Character &#123;</span><br><span class="line"></span><br><span class="line">    //一个角色有一个这样的行为</span><br><span class="line">    public SubmissionBehavior submissionBehavior;</span><br><span class="line"></span><br><span class="line">    public abstract void display();</span><br><span class="line"></span><br><span class="line">    //完成提交行为 委托</span><br><span class="line">    public void completeCommit()&#123;</span><br><span class="line">        submissionBehavior.commit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //动态设置行为</span><br><span class="line">    public void setSubmissionBehavior(SubmissionBehavior submissionBehavior) &#123;</span><br><span class="line">        this.submissionBehavior = submissionBehavior;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Coder.class 具体的角色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/31.</span><br><span class="line"> * Describe 开发员</span><br><span class="line"> */</span><br><span class="line">public class Coder extends Character&#123;</span><br><span class="line"></span><br><span class="line">    public Coder() &#123;</span><br><span class="line">        submissionBehavior = new SVNCommitBehavior();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void display() &#123;</span><br><span class="line">        System.out.println(&quot;刚开始使用的周报提交方式是SVN&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>测试</p></blockquote><p>Test.class<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/31.</span><br><span class="line"> * Describe 测试</span><br><span class="line"> */</span><br><span class="line">public class Test &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        //创建一个码农提交方式</span><br><span class="line">        Character character = new Coder();</span><br><span class="line">        character.completeCommit();</span><br><span class="line"></span><br><span class="line">        //创建一个前台小姐姐提交方式</span><br><span class="line">        Character character1 = new ReceptionSister();</span><br><span class="line">        character1.completeCommit();</span><br><span class="line"></span><br><span class="line">        //某天开发部们经理说了以后开发部要统一使用Git方式提交周报了，</span><br><span class="line">        //那么如下看看发生什么情况</span><br><span class="line">        Character character2 = new Coder();</span><br><span class="line">        character2.setSubmissionBehavior(new GitCommitBehavior());//动态设置提交方式</span><br><span class="line">        character2.completeCommit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>输出结果：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Java\jdk1.8.0_161\bin\...</span><br><span class="line">SVN提交行为</span><br><span class="line">邮箱提交周报行为</span><br><span class="line">新增的Git提交周报行为</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><strong><a href="https://github.com/eirunye/StrategyPattern_Design" target="_blank" rel="noopener">策略模式案例代码</a></strong></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>我们学习了策略模式，在生活中是经常运用到的，本例只是一个场景。<br>我们在设计开发的时候一定要“多用组合，少用继承”。<br>针对接口变成，而不针对实现编程。</p><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><p>1.策略模式提供了管理相关的算法族的办法。策略类的等级结构定义了一个算法或行为族。通过使用继承抽象超类可以把公共的代码转移到抽象超类父类里面，从而避免重复的代码。<br>2.通过实现接口的方式定义具体的行为“算法”，从而减少子类继承父类相互混淆的行为。<br>3.使用策略模式可以避免使用多重条件转移语句，动态的改变行为，而各个具体角色行为“算法”相互独立。</p><h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>1.客户端必须知道所有的具体角色，并决定使用哪个算法族，这样在设计开始时是需要花费时间是封装“算法”族的，策略模式只适用于客户端知道所有的算法或行为的情况。<br>2.策略模式造成很多具体的角色，每个具体角色就得创建一个新的类，这样类无法相互联系，所以无法共享。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><p>大家可以到<a href="https://eirunye.github.io/"><strong>我的博客https://eirunye.github.io</strong></a>进行浏览相关文章，大家一起相互探讨技术。</p><p><a href="https://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><strong>设计模式系列</strong></a>大家可以了解相关文章。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;1.学习本篇博文，我们知道在什么场景下使用策略模式。&lt;br&gt;2.策略模式的优缺点。&lt;br&gt;3.策略模式的思想。&lt;/p&gt;
&lt;h1 id=&quot;场景
      
    
    </summary>
    
      <category term="设计模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="策略模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="设计模式" scheme="http://eirunye.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="策略模式" scheme="http://eirunye.github.io/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>观察者模式</title>
    <link href="http://eirunye.github.io/2018/09/01/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>http://eirunye.github.io/2018/09/01/观察者模式/</id>
    <published>2018-08-31T17:24:02.000Z</published>
    <updated>2018-09-26T07:47:48.970Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>1.学习本篇博文，我们知道在什么场景下使用观察者模式。<br>2.观察者模式的优缺点。<br>3.观察者模式给我们在今后开发中什么思想。</p><h1 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h1><p>某家科技公司目前在开发一个项目，设计小组需要上报项目的进度给部门经理，主要有两个模块更新原有的业务模块进度和添加新业务的模块完成进度。<br>那么部门经理需要什么途径能最快的得到进度的信息呢？或者可能是项目总监也想参与，去获取到最新的进展情况呢？我们改如何去考虑这个业务呢？</p><p>很多时候我们就会想到继承去解决这一情况，毕竟OO编写思想时刻影响这一我们，但是如果某天项目经理出差了，他不想看项目进度了，那我们又改怎么办呢？</p><p>我们能不能就是设计一个业务，让能想知道该进度的人，不管什么时候，只要有开发者上报进度的时候就一下他就得到进度的信息，而他无需去关系这个过程。</p><p>你是否能想到合适的解决方案呢？</p><p>答案就在下文中，你准备好了吗？</p><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><h2 id="什么是观察者模式？"><a href="#什么是观察者模式？" class="headerlink" title="什么是观察者模式？"></a>什么是观察者模式？</h2><p>观察者模式定义一系列对象之间的一对多关系，当一个对象改变、更新状态时，依赖它的都会收到通知改变或者更新。</p><h2 id="为什么需要观察者模式"><a href="#为什么需要观察者模式" class="headerlink" title="为什么需要观察者模式?"></a>为什么需要观察者模式?</h2><p>从定义中我们可以知道观察者模式当对象改变时，其他依赖的对象都会收到改变信息的状态。</p><p>从本例分析项目经理想知道进度情况，他只需要绑定进度，他就可以知道进度信息了，而无需关心如何操作，如果再增加一个想知道进度信息老板呢？也很容易，也让老板绑定进度信息数据就好了，不想知道的时候就解除绑定，就不在获取进度信息了。</p><p>所以在本案例场景中，观察者是我们这个场景非常合适的设计。</p><h1 id="如何实现观察者模式？"><a href="#如何实现观察者模式？" class="headerlink" title="如何实现观察者模式？"></a>如何实现观察者模式？</h1><h2 id="自定义观察者模式"><a href="#自定义观察者模式" class="headerlink" title="自定义观察者模式"></a>自定义观察者模式</h2><h3 id="实现如下"><a href="#实现如下" class="headerlink" title="实现如下"></a>实现如下</h3><blockquote><p>我们先来看一下这个UML类图进行分析</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/3012005-ee86c1da81dd578e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="observer.png"></p><blockquote><p>具体实现步骤</p></blockquote><p>1.构造一个主题Subject或者是一个被观察者Observeable，这是一个接口或者是抽象类</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> public interface Subject &#123;</span><br><span class="line">  //注册观察者</span><br><span class="line">  void registerObserver(Observer observe);</span><br><span class="line">  //解除绑定观察者</span><br><span class="line">  void unRegisterObserver(Observer observe);</span><br><span class="line">  //更新数据</span><br><span class="line">  void notifyObservers();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 2.构建一个被观察者实现该主题接口如本例的 DevelopmentProgressData.class，这里是进度信息数据<br>  在registerObserver(Observer o);//方法中将观察者添加到注册列表中<br>  在unRegisterObserve(Observer o);//删除观察者<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public class DevelopmentProgressData implements Subject &#123;</span><br><span class="line"> @Override</span><br><span class="line">   public void registerObserver(Observer observer) &#123;</span><br><span class="line">       //将观察者添加到列表中</span><br><span class="line">       arrayObserve.add(observer);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   @Override</span><br><span class="line">   public void unRegisterObserver(Observer observer) &#123;</span><br><span class="line">       int i = arrayObserve.indexOf(observer);</span><br><span class="line">       if (i &gt;= 0) &#123;</span><br><span class="line">           //将观察者从列表中解除</span><br><span class="line">           arrayObserve.remove(i);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">   //通知所以观察者数据更新了</span><br><span class="line">   @Override</span><br><span class="line">   public void notifyObservers() &#123;</span><br><span class="line"></span><br><span class="line">       for (int i = 0; i &lt; arrayObserve.size(); i++) &#123;</span><br><span class="line">           Observer o = (Observer) arrayObserve.get(i);</span><br><span class="line">           o.update(completeProgress, updateProgress);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3.构建一个观察者接口Observer</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface Observer &#123;</span><br><span class="line">   //更新数据</span><br><span class="line">   void update(int completeProgress, int updateProgress);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.可构建一个展示数据的接口（可忽略）<br> 有展示数据的方法，观察者要实现这个方法 查看本例的 DisplaySchedule<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface DisplaySchedule &#123;</span><br><span class="line">    void display();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>5.定义观察者(模拟该类就是产品经理观察者)，需实现接口Observes、DisplaySchedule(可忽略)，</p><p><1>、将主题Subject设置为观察者的属性，并将其作为观察者的构造函数如 ProductManagerObserver.class<br>调用  developmentProgressSubject.registerObserver(this);将观察者注册到观察列表中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public class ProductManagerObserver implements Observer, DisplaySchedule &#123;</span><br><span class="line"></span><br><span class="line">    private int completeProgress;//完成进度</span><br><span class="line">    private int updateProgress;//更新进度</span><br><span class="line">    //将主题当成观察者的属性</span><br><span class="line">    private Subject developmentProgressSubject;</span><br><span class="line"></span><br><span class="line">    public ProductManagerObserver(Subject developmentProgressSubject) &#123;</span><br><span class="line">        this.developmentProgressSubject = developmentProgressSubject;</span><br><span class="line">        //注册该观察者</span><br><span class="line">        developmentProgressSubject.registerObserver(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void display() &#123;</span><br><span class="line">        System.out.println(&quot;产品经理管理者显示当前数据 完成进度为: &quot; + completeProgress + &quot;更新修改进度为:&quot; + updateProgress);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void update(int completeProgress, int updateProgress) &#123;</span><br><span class="line">        this.completeProgress = completeProgress;</span><br><span class="line">        this.updateProgress = updateProgress;</span><br><span class="line">        display();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></1></p><blockquote><p>测试</p></blockquote><p>RunTest.class<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class RunTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        DevelopmentProgressData developmentProgressData = new DevelopmentProgressData();</span><br><span class="line">        ProductManagerObserver productManagerObserver = new ProductManagerObserver(developmentProgressData);</span><br><span class="line">        ProjectManagerObserver projectManagerObserver = new ProjectManagerObserver(developmentProgressData);</span><br><span class="line">        developmentProgressData.setCurrentData(34, 45);</span><br><span class="line">        //当项目经理出差了，不观察项目进度了就取消订阅了</span><br><span class="line">        developmentProgressData.unRegisterObserver(projectManagerObserver);</span><br><span class="line">        //当前只有产品经理获取到数据</span><br><span class="line">        developmentProgressData.setCurrentData(46, 90);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p>输出结果</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Java\jdk1.8.0_161\bin\...</span><br><span class="line">产品经理管理者显示当前数据 完成进度为: 34更新修改进度为:45</span><br><span class="line">项目管理真显示当前数据完成进度为: 34更新修改进度为:45</span><br><span class="line">产品经理管理者显示当前数据 完成进度为: 46更新修改进度为:90</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure><h2 id="根据java-util-observerable包下的Observerable-class实现观察者模式功能"><a href="#根据java-util-observerable包下的Observerable-class实现观察者模式功能" class="headerlink" title="根据java.util.observerable包下的Observerable.class实现观察者模式功能"></a>根据java.util.observerable包下的Observerable.class实现观察者模式功能</h2><h3 id="实现如下-1"><a href="#实现如下-1" class="headerlink" title="实现如下"></a>实现如下</h3><blockquote><p>具体实现步骤</p></blockquote><p> 1.首先观察者需要实现java.util.Observer,然后将其被观察者=&gt;java.util.Observaerable作为其观察者的构造函数</p><p>   <1>、通过observeable.addObserver(this)添加观察者<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> public class BossMngObserver implements Observer, DisplayIllustrate &#123;</span><br><span class="line"></span><br><span class="line">  private Observable observable;</span><br><span class="line">  private int valuableProductNum; //库存有贵重产品</span><br><span class="line">  private int normalProductNum;   //普通产品</span><br><span class="line"></span><br><span class="line">  public BossMngObserver(Observable observable) &#123;</span><br><span class="line">      this.observable = observable;</span><br><span class="line">      observable.addObserver(this);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void disPlay() &#123;</span><br><span class="line">      System.out.println(&quot;总经理观察数据改变:贵重产品数量: &quot; + valuableProductNum + &quot;普通产品数量： &quot; + normalProductNum);</span><br><span class="line">  &#125;</span><br><span class="line"> //&lt;2&gt;、实现 Observer更新数据方法</span><br><span class="line"> //看本例的包下的observe的三个类</span><br><span class="line">  @Override</span><br><span class="line">  public void update(Observable o, Object arg) &#123;</span><br><span class="line">      if (o instanceof InventoryData) &#123;</span><br><span class="line">          InventoryData inventoryData = (InventoryData) o;</span><br><span class="line">          this.valuableProductNum = inventoryData.getValuableProductNum();</span><br><span class="line">          this.normalProductNum = inventoryData.getNormalProductNum();</span><br><span class="line">          disPlay();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></1></p><p> 2.被观察者需要继承java.util.Observerable,</p><p>   <1>、然后先调用setChanged()方法</1></p><p>   <2>、在进行调用notifyObserves()更新数据</2></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> public class InventoryData extends Observable &#123;</span><br><span class="line"></span><br><span class="line">   private int valuableProductNum; //库存有贵重产品</span><br><span class="line">   private int normalProductNum;   //普通产品</span><br><span class="line"></span><br><span class="line">   public void setCurrentData(int valuableProductNum, int normalProductNum) &#123;</span><br><span class="line">       this.valuableProductNum = valuableProductNum;</span><br><span class="line">       this.normalProductNum = normalProductNum;</span><br><span class="line">       statusChange();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   private void statusChange() &#123;</span><br><span class="line">   //先调用 setChanged();</span><br><span class="line">       setChanged();</span><br><span class="line">       notifyObservers();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>测试<br>3.Test.class<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        InventoryData inventoryData = new InventoryData();</span><br><span class="line"></span><br><span class="line">        ValuableInfoMngObserver io = new ValuableInfoMngObserver(inventoryData);</span><br><span class="line"></span><br><span class="line">        //io.deleteObserve();</span><br><span class="line">        inventoryData.setCurrentData(20, 30);</span><br><span class="line"></span><br><span class="line">        NormalInfoMngObserver no = new NormalInfoMngObserver(inventoryData);</span><br><span class="line"></span><br><span class="line">        //no.deleteObserver();</span><br><span class="line">        inventoryData.setCurrentData(15, 27);</span><br><span class="line"></span><br><span class="line">        BossMngObserver bossMngObserver = new BossMngObserver(inventoryData);</span><br><span class="line"></span><br><span class="line">        inventoryData.setCurrentData(10, 50);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><strong><a href="https://github.com/eirunye/Oberser_Design" target="_blank" rel="noopener">观察者模式案例代码</a></strong></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>观察者模式的让我们知道了在设计开发的时候一定要“多用组合，少用继承”。</p><p>我们设计开发是应该是针对接口变成，而不针对实现编程。</p><p>在java.util.*下的Observer和Observable可以实现观察者，但是Observable是一个类，这样我们是不违背了“多用组合少用继承”的OO编程思想，是的没错在java.util.Observable类违背了该规则。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><p>大家可以到<a href="https://eirunye.github.io/"><strong>我的博客https://eirunye.github.io</strong></a>进行浏览相关文章，大家一起相互探讨技术。</p><p><a href="https://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><strong>设计模式系列</strong></a>大家可以了解相关文章。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;p&gt;1.学习本篇博文，我们知道在什么场景下使用观察者模式。&lt;br&gt;2.观察者模式的优缺点。&lt;br&gt;3.观察者模式给我们在今后开发中什么思想。&lt;/
      
    
    </summary>
    
      <category term="设计模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="观察者模式" scheme="http://eirunye.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="设计模式" scheme="http://eirunye.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="观察者模式" scheme="http://eirunye.github.io/tags/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 项目如何搭建(四)</title>
    <link href="http://eirunye.github.io/2018/08/22/Spring-Boot-%E9%A1%B9%E7%9B%AE%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA-%E5%9B%9B/"/>
    <id>http://eirunye.github.io/2018/08/22/Spring-Boot-项目如何搭建-四/</id>
    <published>2018-08-22T14:13:20.000Z</published>
    <updated>2018-10-03T06:36:08.336Z</updated>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><h2 id="Spring-Boot如何搭建完整项目"><a href="#Spring-Boot如何搭建完整项目" class="headerlink" title="Spring Boot如何搭建完整项目"></a>Spring Boot如何搭建完整项目</h2><p>在项目开发中我们一般情况下提供给APP或者网站应用的接口一般的请求方式是<strong><em>GET、POST、PUT</em></strong>等等，那么接下来我们将通过一个简单的案例来进行分析，带领大家进入Spring Boot项目的开发，创建(层级分明，思路请析)、编码，主要是 <strong>搭建项目</strong> 等，如何搭建一个Spring Boot开发项目呢？。</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-06639c85d05db900.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/330" alt="Spring Boot.png"></p><h1 id="项目结构创建"><a href="#项目结构创建" class="headerlink" title="项目结构创建"></a>项目结构创建</h1><h2 id="项目目录如下-包层级分明"><a href="#项目目录如下-包层级分明" class="headerlink" title="项目目录如下,包层级分明"></a>项目目录如下,包层级分明</h2><p>一般如下图所示:</p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-e971c11aed6ab6dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt="项目包级结构.png"></p><p>在<strong><em>src</em></strong>目录下的<strong><em>main/java</em></strong>里面的创建的包级目录,进行分析如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/----------------------------------</span><br><span class="line">|-- controller：主要是控制器，通过注解@RestController，Spring4之后新加的注解，原来返回json数据格式，通@RequestMapping，设置访问URI。</span><br><span class="line">|-- enums: 主要是封装返回码的提示。</span><br><span class="line">|-- exception: 主要是封装异常打印输出。</span><br><span class="line">|-- handle: 捕捉异常处理</span><br><span class="line">|-- model：实体类</span><br><span class="line">|-- repository：Jpa使用封装，假如使用MyBatis的会进行其封装，后期文章会说明到MyBatis</span><br><span class="line">|-- service：逻辑处理封装，返回数据给Controller类</span><br><span class="line">|-- utils：封装一些工具类</span><br><span class="line">|-- 其他：在开发中还有一些需要创建其他包，根据自己需求。</span><br><span class="line">\------------------------------------</span><br></pre></td></tr></table></figure><h2 id="主要代码分析"><a href="#主要代码分析" class="headerlink" title="主要代码分析"></a>主要代码分析</h2><p>这里主要是写一个简单的事例进行参考包层级之间的调用，各个层次的封装，达到一个完整的开发Spring Boot项目模板。</p><blockquote><p>代码注解如下:</p></blockquote><p><strong><em>1.EirunyeController.class</em></strong>，这里进行一些常用的请求<code>GET</code>、<code>POST</code>、<code>PUT</code>等案例测试,代码没用贴全，请查看<a href="https://github.com/eirunye/SpringBoot_CreateProject/blob/master/src/main/java/com/eirunye/springboot/controller/EirunyeController.java" target="_blank" rel="noopener">EirunyeController.class</a>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/Eirunye&quot;) //设置请求的父级标签URI</span><br><span class="line">public class EirunyeController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired //注:Autowired是按类型进行装配，可获取它所装配类的属性</span><br><span class="line">    EirunyeService eirunyeService;</span><br><span class="line">    /**</span><br><span class="line">     * 访问返回数据</span><br><span class="line">     *</span><br><span class="line">     * @return JSON EiBean</span><br><span class="line">     * @throws Exception 出现异常处理</span><br><span class="line">     */</span><br><span class="line">    @GetMapping(value = &quot;/get/bean&quot;)//url===&gt;http:localhost:8091/Eirunye/get/bean</span><br><span class="line">    public Result&lt;EiBean&gt; getEiBeanData() throws Exception &#123;</span><br><span class="line"></span><br><span class="line">        return eirunyeService.getEiBeanData();</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     *  POST请求</span><br><span class="line">     * @param eiBean</span><br><span class="line">     * @return</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @PostMapping(value = &quot;/save/bean&quot;) //url===&gt;http:localhost:8091/Eirunye/save/bean</span><br><span class="line">    public Result&lt;EiBean&gt; saveEiBeanData(@Valid EiBean eiBean) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">        return eirunyeService.saveEiBeanData(eiBean);</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     *  PUT请求</span><br><span class="line">     * @param eiBean</span><br><span class="line">     * @return</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @RequestMapping(value = &quot;/put/eiBean&quot;, method = RequestMethod.PUT)//url===&gt;http:localhost:8091/Eirunye/put/eiBean</span><br><span class="line">    public Result&lt;EiBean&gt; putEiBeanData(@Valid EiBean eiBean) throws Exception&#123;</span><br><span class="line">        return eirunyeService.putEiBeanData(eiBean);</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * DELETE 请求案例</span><br><span class="line">     * @param id id</span><br><span class="line">     * @return JSON EiBean</span><br><span class="line">     * @throws Exception 异常处理</span><br><span class="line">     */</span><br><span class="line">    @DeleteMapping(value = &quot;/delete/Bean/&#123;id&#125;&quot;)//url===&gt;http:localhost:8091/Eirunye/delete/Bean/1</span><br><span class="line">    public Result&lt;EiBean&gt; deleteEiBeanDataById(@PathVariable(&quot;id&quot;)Integer id) throws Exception&#123;</span><br><span class="line">        return eirunyeService.deleteEiBeanDataById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong><em>2.EirunyeService.class</em></strong></p><blockquote><p>@Service 用于标注业务层组件：将当前类注册为Spring的Bean<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Service // 用于标注业务层组件：将当前类注册为Spring的Bean</span><br><span class="line">public class EirunyeService &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @return Result&lt;EiBean&gt;</span><br><span class="line">     * @throws EirunyeException 异常处理</span><br><span class="line">     */</span><br><span class="line">    public Result&lt;EiBean&gt; getEiBeanData() throws EirunyeException&#123;</span><br><span class="line">        EiBean eiBean = new EiBean();</span><br><span class="line">        eiBean.setName(&quot;Eirunye&quot;);</span><br><span class="line">        eiBean.setAge(19);</span><br><span class="line">        eiBean.setHobby(&quot;Java Spring Boot&quot;);</span><br><span class="line">        return ResultUtil.globalInfo(ResultEnum.SUCCESS,eiBean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><p><strong><em>EiBean.class</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class EiBean &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    private String hobby;</span><br><span class="line">//get/set...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>*ResultUtil.class</strong>表示返回JSON数据封装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/24.</span><br><span class="line"> * Describe ResultUtil 返回结果封装</span><br><span class="line"> */</span><br><span class="line">public class ResultUtil &#123;</span><br><span class="line"></span><br><span class="line">    public static Result globalInfo(ResultEnum resultEnum, Object object) &#123;</span><br><span class="line">        Result result = new Result();</span><br><span class="line">        result.setCode(resultEnum.getCode());</span><br><span class="line">        result.setMsg(resultEnum.getMsg());</span><br><span class="line">        result.setData(object);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">    public static  Result error(Integer code,String msg)&#123;</span><br><span class="line">        Result result = new Result();</span><br><span class="line">        result.setCode(code);</span><br><span class="line">        result.setMsg(msg);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ResultEnum枚举，进行封装符合字符提示</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/24.</span><br><span class="line"> * Describe ResultEnum</span><br><span class="line"> */</span><br><span class="line">public enum ResultEnum &#123;</span><br><span class="line"></span><br><span class="line">    UNKNOWN_ERROR(-1, &quot;UNKNOW ERROR&quot;),//返回失败</span><br><span class="line">    SUCCESS(0, &quot;SUCEESSS&quot;), ///返回成功</span><br><span class="line">    ///这里大家定义自己的返回系列</span><br><span class="line">    ;</span><br><span class="line">    private Integer code; //返回码 0表示成功，1表示失败，-1未知错误</span><br><span class="line">    private String msg;</span><br><span class="line"></span><br><span class="line">    ResultEnum(Integer code, String msg) &#123;</span><br><span class="line">        this.code = code;</span><br><span class="line">        this.msg = msg;</span><br><span class="line">    &#125;</span><br><span class="line">    public Integer getCode() &#123;</span><br><span class="line">        return code;</span><br><span class="line">    &#125;</span><br><span class="line">    public String getMsg() &#123;</span><br><span class="line">        return msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>*EirunyeException.class</strong>这里表示封装的一次处理。添加异常处理，这里只是简单的提示，后期会讲解到Spring Boot如何优雅的封装异常。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Author Eirunye</span><br><span class="line"> * Created by on 2018/8/24.</span><br><span class="line"> * Describe ResultEnum</span><br><span class="line"> */</span><br><span class="line">public class EirunyeException extends RuntimeException &#123;</span><br><span class="line"></span><br><span class="line">    private Integer code;</span><br><span class="line">    public EirunyeException(ResultEnum resultEnum) &#123;</span><br><span class="line">        super(resultEnum.getMsg());</span><br><span class="line">        this.code = resultEnum.getCode();</span><br><span class="line">    &#125;</span><br><span class="line">    public Integer getCode() &#123;</span><br><span class="line">        return code;</span><br><span class="line">    &#125;</span><br><span class="line">    public void setCode(Integer code) &#123;</span><br><span class="line">        this.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>常用的注解 <a href="https://docs.spring.io/spring/docs/4.3.1.RELEASE_to_4.3.2.RELEASE/Spring%20Framework%204.3.2.RELEASE/org/springframework/web/bind/annotation/" target="_blank" rel="noopener">参数注解官方文档</a></li></ul><p>这里主要讲解的是常用的注解方法。需要更多的情况官方文档。</p><table><thead><tr><th>注解</th><th>解释说明</th></tr></thead><tbody><tr><td><code>@RestController</code></td><td>表示的是：<code>@ResponseBody</code> ＋ <code>@Controller</code>，作用于类，返回默认为JSON数据</td></tr><tr><td><code>@Controller</code></td><td>表示视图可以解析jsp、xml等文档，需要在方法中添加<code>@ResponseBody</code>，返回JSON</td></tr><tr><td><code>@ResponseBody</code></td><td>作用于方法中，如果类中有<code>@RestController</code>，就不需要添加<code>@ResponseBody</code></td></tr><tr><td><code>@RequestMapping(&quot;/Eirunye&quot;)</code></td><td>作用于类中是表示设置请求的父级标签URI,每个URI必须带父级标签如：<code>http://localhost:8080/Eirunye/xxxx</code><br>作用于方法是表示默认为<code>GET</code>请求<br><code>@RequestMapping(value = &quot;/put/eiBean&quot;,method = RequestMethod.PUT)</code> 表示<code>PUT</code>请求,如图<code>RequestMethod.png</code> 常用的请求方法</td></tr><tr><td><code>@GetMapping(value = &quot;/bean&quot;)</code></td><td>表示<code>GET</code>请求<br><code>@GetMapping(value = &quot;/get/hello/{id}&quot;)</code>表示参数<code>id</code>,看上面代码引用<code>@PathVariable(&quot;id&quot;)</code></td></tr><tr><td><code>@PathVariable(&quot;xx&quot;)</code></td><td>表示在方法的参数中引用，获取URL中<code>{xx}</code>中的数据，<code>xx</code>表示的字段相同，看以上代码<code>id</code></td></tr><tr><td><code>@RequestParam</code></td><td>表示请求参数，看以上代码<code>(@RequestParam(&quot;name&quot;) String name, @RequestParam(&quot;age&quot;) int age)</code></td></tr><tr><td><code>@PostMapping(value = &quot;/save/bean&quot;)</code></td><td>表示<code>POST</code>请求，<code>@RequestMapping(value = &quot;/save/bean&quot;, method = RequestMethod.POST)</code>简写，参数<code>(@Valid EiBean eiBean)</code>或者<code>params</code>形式等</td></tr><tr><td><code>@DeleteMapping(value = &quot;delete/Bean/{id}&quot;)</code></td><td>表示<code>DELETE</code>请求，<code>@RequestMapping(value = &quot;delete/Bean/{id}&quot;, method = RequestMethod.DELETE)</code></td></tr><tr><td><code>@Service</code></td><td>用于标注业务层组件：将当前类注册为Spring的Bean，操作数据库一般在这里进行</td></tr></tbody></table><p><img src="https://upload-images.jianshu.io/upload_images/3012005-0c24f02f22717b39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="RequestMethod.png"></p><ul><li>注：在后期文章遇到新的注解会说明到。</li></ul><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p><strong><em>在接下来会有一篇博文会详细讲解在开发中我们如何进行测试(#)，这里只进行一些简单测试</em></strong></p><p>在这里我们只需要进行一下访问结果，如下:</p><ul><li>Postman请求如下:<br>Postman请求有全部满足要求的请求，切换请求方法即可。</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-187753fe7538a27d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="Postman_返回.png"></p><ul><li>IDEA请求如下:</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3012005-58c7ec1b75c3069b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="返回成功.png"></p><p><img src="https://upload-images.jianshu.io/upload_images/3012005-db619b9a5da650ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/600" alt="返回数据结果.png"></p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><ul><li><a href="https://gitee.com/springboot_yrgen/SpringBoot_CreateProject" target="_blank" rel="noopener"><strong>本篇案例代码下载-码云</strong></a></li><li><a href="https://github.com/eirunye/SpringBoot_CreateProject" target="_blank" rel="noopener"><strong>本篇案例代码下载-GitHub</strong></a></li><li><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-码云</strong></a></li><li><a href="https://github.com/eirunye/Eirunye_SpringBoot_Notes" target="_blank" rel="noopener"><strong>Spring Boot系列代码-GitHub</strong></a></li></ul><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1.学习本篇，我们知道如何搭建一个好的项目工程,常用的功能架构</p><p>2.我们在搭建项目的时候要尽可能考虑到我们需要的处理逻辑，选型，然后进行封装，这只是一个简单的项目搭建，在正常情况下，假如添加MyBatis或者其他数据库操作时，最好分成处理，这里我们阅读代码非常方便，异常处理非常重要，我们能快速定位错误位置等等。</p><p>3.打家可以通过该案例来进行搭建项目，符合自己的代码编写项目操作。</p><p>4.本案例代码大家完全可以引用到自己的项目中进行封装开发。</p><h1 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h1><ul><li><p>我的博客<br>大家可以到<a href="https://eirunye.github.io"><strong>我的博客https://eirunye.github.io</strong></a>进行浏览相关文章，大家一起相互探讨技术。</p></li><li><p><a href="https://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/">Spring Boot 系列</a><br>如果大家想了解更多的Spring Boot相关博文请进入我的<a href="https://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"><strong>Spring Boot系列博客栈</strong></a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h1&gt;&lt;h2 id=&quot;Spring-Boot如何搭建完整项目&quot;&gt;&lt;a href=&quot;#Spring-Boot如何搭建完整项目&quot; class=&quot;header
      
    
    </summary>
    
      <category term="后台" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/categories/%E5%90%8E%E5%8F%B0/Spring-Boot/"/>
    
    
      <category term="Java" scheme="http://eirunye.github.io/tags/Java/"/>
    
      <category term="Spring Boot" scheme="http://eirunye.github.io/tags/Spring-Boot/"/>
    
  </entry>
  
</feed>
